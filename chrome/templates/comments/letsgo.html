<html>
  <head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="selectionlib.js"></script>
<script src="jquery.timeago.js" type="text/javascript"></script>

<script src="mustache.js"></script>
    <style>
      .content {
        width:330px;
        border:1px solid #ccc;
        padding:0px;
        margin:0px;
        box-sizing: border-box;
        background-color: #FAF9F9;
      }

      * {
        box-sizing: border-box;
      }



ul.kifi_social_tabs {
  margin:0px;
  padding:0px;
}

.kifi_social_tabs li {
  list-style:none;
  display:inline;
  padding:0px;
  margin:0px;
  background-color: #FAF9F9;
}

.kifi_social_tabs span {
  padding:5px 10px;
  display:inline-block;
  border: 1px solid rgb(190, 190, 190);
  text-decoration:none;
  top:1px;
  position:relative;
  border-radius: 5px 5px 0px 0px;
  background-color: #FAF9F9;
}

.kifi_social_tabs .active {
    border-bottom: 1px solid #FAF9F9;
}

.comment_body_view {
  background-color: #FAF9F9;
  min-height: 200px;
  overflow: auto;
  max-height:445px;
  font-size:11px;
  line-height: 14px;
  padding-right:5px;
}

.comment_post_view {
  background-color: #FAF9F9;
  padding-top:5px;
  border-top: 1px solid #ccc;
  padding-bottom:5px;
}

img.comment-avatar {
  width:35px;
  height:35px;
  position:relative;
  float:left;
  margin:5px;
  margin-left:0px;
  border-radius: 2px;
}

.flexcontainer {
  position: relative;
  width:300px;
  margin:0 auto;
  font-family: Calibri, Helvetica, sans-serif;
  background-color: #FAF9F9;
}

.comment {
  background-color: #fff;
  margin:5px 0px 5px 0px;
  clear:both;
  padding:5px;
  border: 1px solid #eee;
  border-radius: 3px;
  box-shadow: 1px 1px 1px rgba(50,50,50,0.2);
  position: relative;
  z-index:2;
}

.meta-links {
  float:right;
}

.timestamp {
  float: left;
  color: #ccc;
}

.comment-meta {
  position: relative;
  height:10px;
  font-size: 10px;
  line-height: 10px;
  color: #aaa;
  clear:both;
}

.meta-links:hover {
  cursor: pointer;
}

.comment-text {
  margin: 3px 0px 0px 0px;
}

.replies:hover, .hearts-thank:hover {
  color: #666;
  text-decoration: underline;
  cursor: pointer;
}

.hearts-thank-hover {
  color: #666;
  text-decoration: underline;
  cursor: pointer;
}

.hearts-glyph-thanked {
  color: #D26464;
}


.comment-text .first-line {
  display: inline;
}

.comment-text p {
  margin: 0px;
  margin-top:5px;
}
.comment_post_view form {
  margin: 0;
}
.comment-box {
  width: 280px;
  margin: 0px;
  height: 55px;
  display: block;
  background-color: #fff;
  font-size: 12px;
  padding: 5px;
  border: 1px solid #EEE;
  border-radius: 3px;
  box-shadow: 1px 1px 1px rgba(50, 50, 50, 0.2);
  outline: none;
  min-height: 45px;
}
.comment-box .main-comment-textarea {
  border:0px;
  margin:0;
  padding:0;
  resize: none;
  background-color: #fff;
  font-size: 11px;
  outline: none;
  width:210px;
  height:100%;
}

.comment_post_view .submit-comment {
  display:none;
  outline: none;
  cursor: pointer;
  vertical-align: baseline;
  text-shadow: rgba(255, 255, 255, 0.4) 0px 1px 0px;
  font-size: 13px;
  text-align: center;
  text-decoration: initial;
  border: 1px solid;

  color: #4F4F4F;
  -webkit-box-shadow: rgba(0, 0, 0, 0.14902) 0px 1px 2px, rgba(255, 255, 255, 0.2) 0px 1px 0px inset;
  box-shadow: rgba(0, 0, 0, 0.14902) 0px 1px 2px, rgba(255, 255, 255, 0.2) 0px 1px 0px inset;
  border-color: #D5D5D5 #CCC #C2C2C2;
  background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(white), to(#EDEDED));
  padding: 2px 10px;
  border-radius: 3px;
  margin:3px;
}

.comment-box .main-comment-textarea:focus::-webkit-input-placeholder { color:transparent; }
.comment-box .main-comment-textarea:focus:-moz-placeholder { color:transparent; }

.comment-box .crosshair {
  display:none;
  position:relative;
  width:18px;
  height:18px;
  left:0px;
  bottom:15px;
  background: url(crosshair-grayed.png) no-repeat;
  background-size: 18px;
  background-position:center;
}
.comment-box .crosshair:hover {
  position:relative;
  width:18px;
  height:18px;
  left:0px;
  bottom:15px;
  background: url(crosshair.png) no-repeat;
  background-size: 18px;
  background-position:center;
  cursor: pointer;
}

.comment-replies {
  border-left:8px solid #e9e9e9;
  border-bottom:8px solid #e9e9e9;
  border-radius: 0px 0px 0px 4px;
  margin-left: 0px;
  margin-right:4px;
  margin-top: -8px;
  display: none;
  position:relative;
  z-index:0;
  padding-top:3px;
  background-color: #e9e9e9;
}
.reply-comment-box {
  margin: 0px;
  display: block;
  background-color: #fff;
  font-size: 12px;
  outline: none;
  min-height: 25px;
}
.reply-comment {
  box-shadow: none;
  background-color: #fff;
  padding-top:1px;
  margin: 1px 0px 0px 0px;
  border-radius: 0px;
  min-height: 40px;
}
.reply .reply-comment-textarea {
  border:0px;
  margin:0;
  padding:0;
  resize: none;
  background-color: #fff;
  font-size: 11px;
  outline: none;
  height: 30px;
  width:210px;
}

.reply form {
  margin: 0;
}

.reply-timestamp {
  float: right;
  color: #ccc;
}

img.reply-avatar {
  width:25px;
  height:25px;
  margin:3px;
  margin-bottom:0px;
}

.reply {
  min-height: 40px;
}

.compose-comment {
  border: 1px solid #888;
  border-radius: 0px 0px 5px 5px;
}



img.user-avatar {
  float:left;
  border-radius: 50px 50px 50px 50px;
}

    </style>
    <script>

$.extend(jQuery.easing,{
  easeQuickSnapBounce:function(x,t,b,c,d) { 
    if (typeof s === 'undefined') s = 1.3;
    return c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b;
  },
  easeCircle: function (x, t, b, c, d) {
    if ((t/=d/2) < 1) return -c/2 * (Math.sqrt(1 - t*t) - 1) + b;
    return c/2 * (Math.sqrt(1 - (t-=2)*t) + 1) + b;
  },
  easeInOutBack: function (x, t, b, c, d, s) {
    if (s == undefined) s = 1.3; 
    if ((t/=d/2) < 1) return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b;
    return c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b;
  }
});

function loadFile(name, callback) {
  var req = new XMLHttpRequest();
  req.open("GET",name, true);
  req.onreadystatechange = function() {
      if (req.readyState == 4 && req.status == 200) {
          callback(req.responseText);
      }
  };
  req.send(null);
}


function getTemplate(name, params, callback, partials) {
  loadFile(name, function(contents) {
    var tb = Mustache.render(
        contents,
        params,
        partials
    );
    callback(tb);
  });
}
loadFile("hearts.html", function(hearts) {
  loadFile("comments_list.html", function(comment_list) {
    var partials = {
      "comment_body_view": comment_list,
      "hearts": hearts
    };

    var params = {
      view: "comments_list",
      user: {
        "firstName": "Andrew",
        "lastName": "Conner",
        "avatar": "https://fbcdn-profile-a.akamaihd.net/hprofile-ak-snc6/275024_71105121_451954280_q.jpg"
      },
      formatComments: function() {
        return function(text, render) {
          text = $.trim(render(text));
          text = "<p class=\"first-line\">" + text + "</p>";
          text = text.replace(/\n\n/g,"\n")
          text = text.replace(/\n/g, "</p><p>");
          return text;
        }
      },
      comments: [
        {
          "firstName": "Andrew",
          "lastName": "Conner",
          "avatar": "https://graph.facebook.com/71105121/picture?type=square",
          "timestamp": "2012-07-17T09:24:17Z",
          "text": "This is a sample comment. It is quite long. But that's okay, because it's a comment. Blah blah blah, this site is on The Internet, which is a place just south of San Fransisco.",
          "replyCount": 3,
          "hearts": 0,
          "replies": [
            {
              "firstName": "Eishay",
              "lastName": "Smith",
              "avatar": "https://graph.facebook.com/646386018/picture?type=square",
              "timestamp": "2012-07-17T09:26:17Z",
              "text": "Sometimes, Andrew, you make no sense."
            },
            {
              "firstName": "Danny",
              "lastName": "Blumenfeld",
              "avatar": "https://graph.facebook.com/636721190/picture?type=square",
              "timestamp": "2012-07-17T09:29:17Z",
              "text": "Guys, this is INSANE."
            },
          ]
        },
        {
          "firstName": "Alexander",
          "lastName": "Schultz",
          "avatar": "https://graph.facebook.com/508538138/picture?type=square",
          "timestamp": "2012-08-17T09:24:17Z",
          "text": "Here's your chance to design our next t-shirt. We've teamed up with Threadless and your challenge is to design the winning shirt inspired by our music. 25\% of the proceeds \nwill go to Partners In Health. Have fun. Can't wait to see what you come up with. For more info or what is it goss: http://beta.thssssreadl Love, AF.",
          "replyCount": 0,
          "hearts": 5
        },
        {
          "firstName": "Alexander",
          "lastName": "Schultz",
          "avatar": "https://graph.facebook.com/508538138/picture?type=square",
          "timestamp": "2012-09-17T09:24:17Z",
          "text": "This is a sample comment okay okay one two sdf",
          "replyCount": 3,
          "hearts": 5
        },
        {
          "firstName": "Alexander",
          "lastName": "Schultz",
          "avatar": "https://graph.facebook.com/508538138/picture?type=square",
          "timestamp": "2012-10-17T09:24:17Z",
          "text": "This is a sample comment",
          "replyCount": 3,
          "hearts": 5
        },
        {
          "firstName": "Alexander",
          "lastName": "Schultz",
          "avatar": "https://graph.facebook.com/508538138/picture?type=square",
          "timestamp": "2012-11-10T09:24:17Z",
          "text": "This is a sample comment",
          "replyCount": 3,
          "hearts": 5
        },
        {
          "firstName": "Alexander",
          "lastName": "Schultz",
          "avatar": "https://graph.facebook.com/508538138/picture?type=square",
          "timestamp": (new Date()).toISOString(),
          "text": "This is a sample comment",
          "replyCount": 3,
          "hearts": 5
        }
      ]
    }


    getTemplate("comments_view.html", params, function(tmpl) {
      $('.content').append(tmpl);

      // Binders
      $("abbr.timeago").timeago();
      $(".comment-box").click(function() {
        $('#main-comment-textarea').focus();
      });
      $(".comment-box .crosshair").click(function() {
        console.log("Hit");
        return false;
      });

      $('#main-comment-textarea').focus(function() {
        $('.crosshair').slideDown(150);
        $('.submit-comment').slideDown(150);
        $('.comment_body_view').animate({
          'max-height': '387'
        },150,'easeQuickSnapBounce');
        $('.comment-box').animate({
          'height': '85'
        },150,'easeQuickSnapBounce');
      });
      $('#main-comment-textarea').blur(function() {
        $('.comment_body_view').animate({
          'max-height': '445'
        },150,'easeQuickSnapBounce');
        $('.comment-box').animate({
          'height': '55'
        },150,'easeQuickSnapBounce');

        $('.crosshair').slideUp(20);
        $('.submit-comment').slideUp(20);
      });

      $('.reply-comment-textarea').focus(function() {
        $(this).animate({
          'height': '+=30'
        },200,'easeQuickSnapBounce');
      });
      $('.reply-comment-textarea').blur(function() {
        $(this).animate({
          'height': '30'
        },100,'easeQuickSnapBounce');
      });

      $('.replies').click(function() {
        var link = $(this);
        var list = link.parents('.comment-wrapper').children('.comment-replies');
        if(list.is(":visible")) {
          $(list).slideUp(200);
          link.children('.reply-arrow').html('');
        }
        else {
          $(list).slideDown(300,'easeQuickSnapBounce');
          link.children('.reply-arrow').html('&uarr;');
        }
      });

      $('.hearts').hover(function() {
        var hearts = $(this);
        var glyph = hearts.find('.hearts-glyph');
        var text = hearts.find('.hearts-thank');
        if($(this).is('.thanked')) {
          // Nothing yet...
        } else {
          glyph.addClass('hearts-glyph-thanked');
          text.addClass('hearts-thank-hover');
        }
      }, function() {
        var hearts = $(this);
        var glyph = hearts.find('.hearts-glyph');
        var text = hearts.find('.hearts-thank');
        if($(this).is('.thanked')) {
          // Nothing yet...
        } else {
          glyph.removeClass('hearts-glyph-thanked');
          text.removeClass('hearts-thank-hover');
        }
      });

      $('.hearts').click(function() {
        if($(this).is('.thanked')) {
          // Nothing to do...
        }
        else {
          var hearts = $(this);
          var glyph = hearts.find('.hearts-glyph');
          var text = hearts.find('.hearts-thank');
          glyph.addClass('hearts-glyph-thanked');
          text.removeClass('hearts-thank hearts-thank-hover');
          hearts.addClass('thanked');
        }
      });

    }, partials);
  });
});


    </script>



  </head>
  <body>
  
  <div class="content">
    
  </div>
  
  </body>
</html>