!function(f){function n(b,a,g,d){var c=+new Date;g.call(b[0],function r(g,e){if(!e&&"object"==typeof g&&!g.nodeType&&!g.jquery)p(g).call(b[0],r);else if(a.mouseoutTimeStamp>a.mouseoverTimeStamp)api.log("[bindHover.configureHover] left before could configure");else if(!a.$h){var k=a.$h=f(g);a.opts=e=e||{};if(e.position){k.css({visibility:"hidden",display:"block"}).appendTo(b);var h=k[0].getBoundingClientRect();k.css({visibility:"",display:""}).detach();e.position.call(k[0],h.width,h.height)}k=d?0:
(e.mustHoverFor||0)-(new Date-c);0<k?a.show=setTimeout(m.bind(b[0]),k):m.call(b[0])}})}function m(){var b=f(this),a=e(b);clearTimeout(a.show);delete a.show;!a.$h||(b.hasClass("kifi-hover-showing")||l(a))||(a.$h.appendTo(b).each(function(){this.offsetHeight}),b.addClass("kifi-hover-showing"),a.showTime=+new Date,a.opts.hideAfter&&(a.hide=setTimeout(h.bind(this),a.opts.hideAfter)))}function h(){var b=f(this),a=e(b);clearTimeout(a.show||a.hide);delete a.show;delete a.hide;a.move&&(document.removeEventListener("mousemove",
a.move,!0),delete a.move);b.hasClass("kifi-hover-showing")?(b.removeClass("kifi-hover-showing"),a.fadeOutStartTime=+new Date,a.$h.on("transitionend",function d(c){c.target===this&&"opacity"===c.originalEvent.propertyName&&(delete a.fadeOutStartTime,a.$h.off("transitionend",d).remove(),delete a.$h,a.mouseoverTimeStamp>a.mouseoutTimeStamp&&this.contains(a.mouseoverEl)&&(api.log("[bindHover.hide:transitionend] faking mouseout"),b.trigger(f.Event("mouseout",{relatedTarget:document}))))})):l(a)||delete a.$h}
function s(b){var a=f(this),a=e(a);q(this,a.$h[0],b.clientX,b.clientY)||(document.removeEventListener("mousemove",a.move,!0),delete a.move,h.call(this))}function l(b){return 500>new Date-(b.fadeOutStartTime||0)}function q(b,a,g,d){b=b.getBoundingClientRect();a=a.getBoundingClientRect();return d>=a.bottom&&d<=b.top&&!((b.left-a.left)*(d-a.bottom)>(b.top-a.bottom)*(g-a.left))&&(b.right-a.right)*(d-a.bottom)>(b.top-a.bottom)*(g-a.right)}function p(b){return function(a){a(f("<div>",{"class":this.dataset.tipClass,
html:this.dataset.tipHtml}),b)}}function e(b){var a=b.data("bindHover");a||b.data("bindHover",a={});return a}f.fn.bindHover=function(b,a){if("destroy"==b)return this.each(function(){var a=f(this).data("hover")||{};clearTimeout(a.show||a.hide);f(a.$h).remove()}).unbind(".bindHover").removeData("hover");a||(a=b,b=null);"function"!=typeof a&&(a=p(a));return this.on("mouseover.bindHover",b,function(b){if(!b.relatedTarget||!this.contains(b.relatedTarget)){var d=f(this),c=e(d);c.mouseoverTimeStamp=b.timeStamp||
+new Date;c.mouseoverEl=b.target;c.$h?c.opts&&c.opts.canLeaveFor&&(clearTimeout(c.hide),delete c.hide,document.removeEventListener("mousemove",c.move,!0),delete c.move):n(d,c,a)}}).on("mouseout.bindHover",b,function(a){if(!a.relatedTarget||!this.contains(a.relatedTarget)){var b=f(this),c=e(b);clearTimeout(c.show);delete c.show;c.mouseoutTimeStamp=a.timeStamp||+new Date;b.hasClass("kifi-hover-showing")?(c.opts&&c.opts.hideAfter&&(clearTimeout(c.hide),delete c.hide),c.opts&&c.opts.canLeaveFor&&q(this,
c.$h[0],a.clientX,a.clientY)?(c.hide=setTimeout(h.bind(this),c.opts.canLeaveFor),c.move=s.bind(this),document.addEventListener("mousemove",c.move,!0)):h.call(this)):l(c)||delete c.$h}}).on("mousedown.bindHover",b,function(b){var d=f(this),c=e(d);!c.opts||(!c.opts.click||c.$h&&c.$h[0].contains(b.target)||l(c))||("hide"==c.opts.click?h.call(this):"toggle"==c.opts.click&&(b.isTrigger||160<new Date-Math.max(c.showTime||0,c.fadeOutStartTime||0))&&(d.hasClass("kifi-hover-showing")?h.call(this):c.$h?m.call(this):
n(d,c,a,!0)))})}}(jQuery);
