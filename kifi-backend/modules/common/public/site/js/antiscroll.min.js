// learnboost.github.io/antiscroll/
(function(c){function g(a,e){this.el=c(a);this.options=e||{};this.x=!1!==this.options.x||this.options.forceHorizontal;this.y=!1!==this.options.y||this.options.forceVertical;this.autoHide=!1!==this.options.autoHide;this.padding=void 0==this.options.padding?2:this.options.padding;var d=h();this.inner=this.el.find(".antiscroll-inner").css({width:this.y&&d?this.options.width?"calc("+d+"px + "+this.options.width+")":"+="+d:null,height:this.x&&d?this.options.height?"calc("+d+"px + "+this.options.height+
")":"+="+d:null});this.refresh()}function b(a){this.pane=a;this.pane.el.append(this.el);this.innerEl=this.pane.inner.get(0);this.shown=this.enter=this.dragging=!1;this.pane.el.mouseenter(c.proxy(this,"mouseenter"));this.pane.el.mouseleave(c.proxy(this,"mouseleave"));this.el.mousedown(c.proxy(this,"mousedown"));this.innerPaneScrollListener=c.proxy(this,"scroll");this.pane.inner.scroll(this.innerPaneScrollListener);this.innerPaneMouseWheelListener=c.proxy(this,"mousewheel");this.pane.inner.bind("mousewheel",
this.innerPaneMouseWheelListener);a=this.pane.options.initialDisplay;!1!==a&&(this.show(),this.pane.autoHide&&(this.hiding=setTimeout(c.proxy(this,"hide"),parseInt(a,10)||3E3)))}function l(a,e){function d(){}d.prototype=e.prototype;a.prototype=new d}function h(){if(void 0===k){var a=c('<div class="antiscroll-inner" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div>');c("body").append(a);var e=c(a).innerWidth(),d=c("div",
a).innerWidth();c(a).remove();k=e-d}return k}c.fn.antiscroll=function(a){return this.each(function(){c(this).data("antiscroll")&&c(this).data("antiscroll").destroy();c(this).data("antiscroll",new c.Antiscroll(this,a))})};c.Antiscroll=g;g.prototype.refresh=function(){var a=this.inner.get(0).scrollWidth>this.el.width()+(this.y?h():0),e=this.inner.get(0).scrollHeight>this.el.height()+(this.x?h():0);this.x&&(!this.horizontal&&a?this.horizontal=new b.Horizontal(this):this.horizontal&&!a?(this.horizontal.destroy(),
this.horizontal=null):this.horizontal&&this.horizontal.update());this.y&&(!this.vertical&&e?this.vertical=new b.Vertical(this):this.vertical&&!e?(this.vertical.destroy(),this.vertical=null):this.vertical&&this.vertical.update())};g.prototype.destroy=function(){this.horizontal&&(this.horizontal.destroy(),this.horizontal=null);this.vertical&&(this.vertical.destroy(),this.vertical=null);return this};g.prototype.rebuild=function(){this.destroy();this.inner.attr("style","");g.call(this,this.el,this.options);
return this};b.prototype.destroy=function(){this.el.remove();this.pane.inner.unbind("scroll",this.innerPaneScrollListener);this.pane.inner.unbind("mousewheel",this.innerPaneMouseWheelListener);return this};b.prototype.mouseenter=function(){this.enter=!0;this.show()};b.prototype.mouseleave=function(){this.enter=!1;this.dragging||this.pane.autoHide&&this.hide()};b.prototype.scroll=function(){this.shown||(this.show(),this.enter||this.dragging||!this.pane.autoHide||(this.hiding=setTimeout(c.proxy(this,
"hide"),1500)));this.update()};b.prototype.mousedown=function(a){a.preventDefault();this.dragging=!0;this.startPageY=a.pageY-parseInt(this.el.css("top"),10);this.startPageX=a.pageX-parseInt(this.el.css("left"),10);this.el[0].ownerDocument.onselectstart=function(){return!1};var e=c.proxy(this,"mousemove"),d=this;c(this.el[0].ownerDocument).mousemove(e).mouseup(function(){d.dragging=!1;this.onselectstart=null;c(this).unbind("mousemove",e);d.enter||d.hide()})};b.prototype.show=function(a){!this.shown&&
this.update()&&(this.el.addClass("antiscroll-scrollbar-shown"),this.hiding&&(clearTimeout(this.hiding),this.hiding=null),this.shown=!0)};b.prototype.hide=function(){!1!==this.pane.autoHide&&this.shown&&(this.el.removeClass("antiscroll-scrollbar-shown"),this.shown=!1)};b.Horizontal=function(a){this.el=c('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">',a.el);b.call(this,a)};l(b.Horizontal,b);b.Horizontal.prototype.update=function(){var a=this.pane.el.width(),e=a-2*this.pane.padding,
d=this.pane.inner.get(0);this.el.css("width",e*a/d.scrollWidth).css("left",e*d.scrollLeft/d.scrollWidth);return a<d.scrollWidth};b.Horizontal.prototype.mousemove=function(a){var e=this.pane.el.width()-2*this.pane.padding,d=a.pageX-this.startPageX;a=this.el.width();var c=this.pane.inner.get(0),d=Math.min(Math.max(d,0),e-a);c.scrollLeft=(c.scrollWidth-this.pane.el.width())*d/(e-a)};b.Horizontal.prototype.mousewheel=function(a,c,d,b){if(0>d&&0==this.pane.inner.get(0).scrollLeft||0<d&&this.innerEl.scrollLeft+
Math.ceil(this.pane.el.width())==this.innerEl.scrollWidth)return a.preventDefault(),!1};b.Vertical=function(a){this.el=c('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">',a.el);b.call(this,a)};l(b.Vertical,b);b.Vertical.prototype.update=function(){var a=this.pane.el.height(),c=a-2*this.pane.padding,d=this.innerEl,b=c*a/d.scrollHeight,b=20>b?20:b,f=c*d.scrollTop/d.scrollHeight;f+b>c&&(f=f-(f+b-c)-3);this.el.css("height",b).css("top",f);return a<d.scrollHeight};b.Vertical.prototype.mousemove=
function(a){var c=this.pane.el.height(),d=c-2*this.pane.padding,b=a.pageY-this.startPageY;a=this.el.height();var f=this.innerEl,b=Math.min(Math.max(b,0),d-a);f.scrollTop=(f.scrollHeight-c)*b/(d-a)};b.Vertical.prototype.mousewheel=function(a,c,d,b){if(0<b&&0==this.innerEl.scrollTop||0>b&&this.innerEl.scrollTop+Math.ceil(this.pane.el.height())==this.innerEl.scrollHeight)return a.preventDefault(),!1};var k})(jQuery);
