searchMinWidth = 660px

.kf-lih
  position: fixed
  top: 0
  width: 100%
  height: appHeaderHeight2
  background-color: pageHeaderColor
  z-index: 500
  user-select: none

  @media (max-height: appHeaderHeight1MaxDim) and (max-width: appHeaderHeight1MaxDim)
    height: appHeaderHeight1

  [kifi-pane-parent] &
    transition: width .25s ease-in

  [kifi-with-pane] &
    width: calc(100% - 322px)

.kf-lih-inner
  display: table
  table-layout: fixed
  width: 100%
  height: 100%
  max-width: appMaxWidth
  box-sizing: border-box
  margin: 0 auto
  padding: 0 appSidePad1

  @media (min-width: appSidePad2MinWidth)
    padding: 0 appSidePad2

btn-diam = 32px
btn-space = 10px
btn-color = alpha(#fff, .1)
btn-color-hover = #6fa5ee
btn-opacity-active = .9

left-logo-width = 76px

.kf-lih-left
  display: table-cell
  vertical-align: middle
  width: left-logo-width + 14px
  font-size: 0
  position: relative // for library menu

.kf-lih-logo
  display: inline-block
  vertical-align: middle
  width: left-logo-width
  height: btn-diam
  background-position: left center
  background-repeat: no-repeat
  background-size: 70px auto
  outline-color: #fff

.kifi-guide-target-1
  position: fixed
  top: -9999px
  left: -9999px
  width: 0
  height: 0

.kf-lih-center
  display: none
  vertical-align: middle

  @media (min-width: searchMinWidth)
    display: table-cell

search-height = 28px
search-on-dur = .12s
search-off-dur = .3s

.kf-lih-search
  display: table
  width: 100%
  height: search-height
  border-radius: 3px
  background-color: tint(pageHeaderColor, 10%)
  position: relative  // to cover suggestions
  z-index: 1

  &:not(.kf-instant)
    transition: background-color search-off-dur

  &.kf-lit
    background-color: #fff
    transition-duration: search-on-dur

search-icon-width = 15px
search-icon-left-pad = 7px

.kf-lih-search-left
  display: table-cell
  vertical-align: middle
  padding: 0 5px 0 search-icon-left-pad
  position: relative  // for kf-lih-search-icon
  white-space: nowrap
  font-size: 0

.kf-lih-search-icon
  position: absolute
  top: 0
  left: search-icon-left-pad
  width: search-icon-width
  height: search-height
  background-size: contain
  background-position: center
  background-repeat: no-repeat

.kf-lih-search-icon-lit
  display: inline-block
  vertical-align: middle
  width: search-icon-width
  height: search-height
  background-size: contain
  background-position: center
  background-repeat: no-repeat
  position: relative  // to cover kf-lih-search-icon

  .kf-lih-search:not(.kf-instant) &
    transition: opacity search-on-dur

  .kf-lih-search:not(.kf-lit) &
    opacity: 0
    transition-duration: search-off-dur

lib-owner-img-radius = 12px

.kf-lih-search-lib-owner-img
  display: inline-block
  vertical-align: middle
  position: relative
  z-index: 1
  width: 2 * lib-owner-img-radius
  height: 2 * lib-owner-img-radius
  margin-left: 3px
  border-radius: 50%
  background-size: contain

.kf-lih-search-lib-name
  display: inline-block
  vertical-align: middle
  margin-left: -(lib-owner-img-radius)
  padding: 0 5px 0 (4px + lib-owner-img-radius)
  line-height: search-height - 4px
  font-size: 13px
  color: #fff
  max-width: 170px
  overflow: hidden
  white-space: nowrap
  text-overflow: ellipsis

.kf-lih-search-lib-x
  display: inline-block
  position: relative
  vertical-align: middle
  border-radius: 0 8px 8px 0
  padding: 0 6px 0 4px
  line-height: search-height - 4px
  font-size: 14px
  color: #fff

  &:hover::before
    content: ''
    position: absolute
    top: 0
    left: 0
    right: 0
    bottom: 0
    border-radius: '%s' % inherit  // github.com/tj/nib/issues/271
    background-color: alpha(#fff, .15)

  &:hover:active::before
    background-color: alpha(#fff, .075)

.kf-lih-search-center
  display: table-cell
  width: 99%

input.kf-lih-search-input
  width: 100%
  line-height: search-height
  background-color: transparent

.kf-lih-search-right
  display: table-cell
  width: 1%
  white-space: nowrap
  vertical-align: middle

.kf-lih-search-clear
  border: none
  background-color: transparent
  padding: 0 8px
  line-height: search-height
  font-weight: 200
  font-size: 16px
  color: blueColor
  cursor: pointer

  &:hover
  &:focus
    font-weight: normal
    box-shadow: inset 0 0 3px currentColor

.kf-lih-search-suggestions
  position: relative
  transform-origin: 30% top

  &.ng-enter
    transition: opacity .12s linear, transform .12s 0s

    &:not(.ng-enter-active)
      opacity: 0
      transform: scale(.96) translate(0, -10px)

  &.ng-leave
    transition: opacity .2s

    &.ng-leave-active
      opacity: 0

.kf-lih-right
  display: table-cell
  width: btn-diam * 4 + btn-space * 4 + 12px
  vertical-align: middle
  text-align: right
  font-size: 0

.kf-lih-add-link
  background-color: transparent
  border: none
  padding: 0
  width: btn-diam !important
  height: btn-diam !important  // our sprite generator sets height to 33px
  cursor: pointer

  &:hover
    sprite2x($add-link-active)

  &:active
    opacity: .9

.kf-lih-dropdown-parent
  display: inline-block
  position: relative
  margin-left: btn-space
  menuGap = 8px

  .kf-dropdown-menu
    dur = .1s
    top: 'calc(100% + %s)' % menuGap
    right: -18px
    transform-origin: 80% top
    transition: visibility 0s, opacity linear dur, transform dur

  &:not(.kf-open)>.kf-dropdown-menu
    dur = .16s
    visibility: hidden
    opacity: 0
    transform: scale(.9)
    transition-duration: 0s, dur, dur
    transition-delay: dur, 0s, 0s

  &.kf-open::before
    content: ''
    position: absolute
    top: 'calc(100% - %s)' % menuGap
    left: -10px
    right: -10px
    height: 20px

.kf-lih-tags
.kf-lih-friends
.kf-lih-profile
  display: inline-block
  width: btn-diam
  height: btn-diam
  vertical-align: middle
  border-radius: 50%

  &:active
    opacity: btn-opacity-active

.kf-lih-tags
.kf-lih-friends
  background-color: btn-color

  &:hover
    background-color: btn-color-hover

.kf-lih-tags
  margin-left: btn-space

  &>.svg-tag-white
    display: inline-block
    width: 100%
    height: 100%
    vertical-align: top
    background-position: 9px 9px
    background-size: auto 14px
    background-repeat: no-repeat

  &:not(:hover)>.svg-tag-white
    opacity: .7

.kf-lih-friends
  position: relative
  z-index: 1  // to cover invisible ::before pseudo-element on :hover parent

  &>.svg-friends-white
    display: inline-block
    width: 100%
    height: 100%
    vertical-align: top
    background-position: 8px 8px
    background-size: auto 15px
    background-repeat: no-repeat

  &:not(:hover)>.svg-friends-white
    opacity: .7

.kf-lih-profile
  background-size: cover
