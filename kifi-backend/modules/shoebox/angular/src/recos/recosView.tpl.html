<div class="recos-view" ng-controller="RecosCtrl">
  <header class="kf-recos-view-header">
    <div class="kf-recos-title">
      <span class="sprite sprite-clover-active kf-recos-clover-icon"></span>
      <h1 class="kf-main-title">Recommendations</h1>
      <div class="kf-subtitle">
        <div class="kf-subtitle-text" ng-show="loading">Loading...</div>
        <div class="kf-subtitle-text" ng-hide="loading">Showing {{recos.length}} recommendations</div>
      </div>
    </div>
    <div kf-reco-recency-slider ng-if="recosState === 'hasRecos'" get-more="getMore(recency)"></div>
  </header>

  <div class="kf-reco kf-reco-info" ng-if="recosState === 'noRecos'" ng-hide="initialCardClosed">
    <span class="kf-reco-icon kf-reco-close-x" ng-click="closeInitialCard()"></span>
    <h4>Turn on Kifi Recommendations</h4>
    <p>Kifi works by recommending things based on what you've kept. We'll cater to your interests over time but we need at least a dozen good articles kept to get started. It's quick to get started if you <a href="javascript:" ng-click="importBookmarks()">import bookmarks</a>, and even better if you <a href="/invite">connect with friends</a>.
    <p>In the meantime, enjoy popular things being kept on Kifi. If you keep some of the ones you like it will help us give you personalized recommendations faster.</p>
    <a href="http://support.kifi.com">Learn more</a>
  </div>

  <div class="kf-reco kf-reco-info" ng-if="recosState === 'noMoreRecos'">
    <h4>No more recommendations for now :)</h4>
    <p>Kifi works by recommending things based on what you've kept. We'll cater to your interests over time and we can recommend more relevant and timely things if you <a href="/invite">connect with more friends</a>. Think about your most inspiring, interesing and knowledgeable friends and invite them to Kifi! Keep on keeping things that matter to you too!</p>
    <p>In the meantime, you can enjoy popular things being kept on Kifi.</p>
    <a href="javascript:" ng-click="showPopular()">See Popular Keeps on Kifi</a>
  </div>

  <img class="kf-keeps-loading" ng-show="loading" src="/img/load.gif">

  <div class="kf-recos" ng-hide="loading">
    <div class="kf-reco" ng-repeat="reco in recos" reco="reco" ng-controller="RecoCtrl">
      <header class="kf-reco-top">
        <span class="kf-reco-icon kf-reco-close-x" ng-click="trash(reco)"></span>
        <div ng-if="reco.recoData.type === 'recommended'" kf-reco-dropdown-menu reco="reco" show-improvement-modal="showImprovementModal()"></div>
        <span>{{reco.recoData.type | titlecase}} {{reco.recoData.kind | titlecase}}</span>
      </header>

      <div ng-if="reco.recoData.kind === 'keep'" kf-keep-content keep="reco.recoKeep" keep-callback="trackRecoKeep(keep)" click-callback="trackRecoClick(keep)"></div>
      <div ng-if="reco.recoData.kind === 'library'" kf-library-card library="reco.recoLib"></div>

      <footer class="kf-reco-bottom" ng-if="hasReason()" ng-class="{ 'kf-reco-multiple-reasons': hasTwoOrMoreReasons() }">
        <span ng-if="hasTwoOrMoreReasons()">
          <span class="kf-reco-icon kf-reco-reasons-right" ng-click="gotoNextReason()"></span>
          <span class="kf-reco-icon kf-reco-reasons-left" ng-click="gotoPrevReason()"></span>
        </span>
        <div class="kf-reco-reason" ng-repeat="reason in reasons" ng-if="$index === reasonIndex">
          <div ng-if="reason.kind === 'keep'">
            Because you kept <a ng-href="{{reason.url}}" target="_blank" ng-attr-title="{{reason.name}}">{{reason.name}}</a>&nbsp;
            <time am-time-ago="reason.when"></time>
          </div>
          <div ng-if="reason.kind === 'topic'">
            <div>Because it's about a topic you're interested in:
            <span class="kf-reco-reason-topic">{{reason.name}}</span></div>
          </div>
          <div ng-if="reason.kind === 'users'">
            Because lots of users kept it
          </div>
          <div ng-if="reason.kind === 'library'">
            Because it's in a Library you follow: <a ng-href="{{reason.url}}" ng-attr-title="{{reason.name}}">{{reason.name}}</a>
          </div>
        </div>
        <div class="kf-reason-bullet-container" ng-if="hasTwoOrMoreReasons()">
          <span ng-repeat="reason in reasons" class="kf-reason-bullet" ng-class="{'kf-dark-reason-bullet': $index === reasonIndex}">&bull;</span>
        </div>
      </footer>

      <div kf-modal show="showRecoImproveModal" class="kf-reco-improve-modal">
        <div kf-basic-modal-content action-text="Submit" action="submitImprovement(reco)">
          <p>Why was the recommendation not great?</p>
          <ul>
            <li>
              <input type="radio" name="improvement" id="r1" value="irrelevant" ng-model="improvement.type">
              <label for="r1">It's not relevant to my interests</label>
            </li>
            <li>
              <input type="radio" name="improvement" id="r2" value="too similar" ng-model="improvement.type">
              <label for="r2">It's too similar to what I'm seeing</label>
            </li>
            <li>
              <input type="radio" name="improvement" id="r3" value="offensive" ng-model="improvement.type">
              <label for="r3">It's offensive</label>
            </li>
          </div>
        </div>
      </div>

    <div class="kf-keep-description-sizer kf-keep-description"></div>
  </div>
</div>
