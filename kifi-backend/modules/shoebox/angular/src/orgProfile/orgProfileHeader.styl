uphSmallMaxDim = 736px // for @media max-height and max-width

.kf-oph
  background: pageHeaderColor
  color: #fff
  padding-bottom: 25px

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    padding-bottom: 12px

.kf-oph-top
  position: relative
  padding-top: 20px
  max-width: appMaxWidth
  margin: 0 auto

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    padding-top: 12px

.kf-oph-connect-banner
  display: inline-block
  margin: 0 auto
  border-radius: 8px
  padding: 0 10px
  overflow: hidden
  background-color: libraryGreen
  line-height: 16px
  font-size: 13px
  color: white

  &.ng-leave
    transition: margin-top .2s, opacity .2s

  &.ng-leave-active
    margin-top: -28px  // TODO: should be actual offsetHeight on small screens too
    opacity: 0

.kf-oph-connect-banner-text
  display: inline-block
  margin: 6px 10px 0

.kf-oph-connect-banner-btns
  display: inline-block
  margin: 6px 10px
  white-space: nowrap

.kf-oph-connect-banner-btn
  display: inline
  padding: 5px 15px
  border: 1px solid white
  border-radius: 4px
  font-size: 11px
  cursor: pointer

  &:not(:first-child)
    margin-left: 10px

  &.kf-accept
    background-color: alpha(#fff, .9)
    color: libraryGreen

    &:hover:not(:active)
      background-color: #fff

  &.kf-decline
    background-color: transparent
    color: #fff

    &:hover:not(:active)
      background-color: alpha(#fff, .1)

.kf-oph-actions
  position: absolute
  top: 10px
  right: appSidePad1

  @media (min-width: appSidePad2MinWidth)
    right: appSidePad2

.kf-oph-connect
  display: inline-block
  cursor: pointer

  button&
    border: none
    background-color: transparent
    padding: 0
    color: inherit

  &.friends
    padding: 0
    text-align: right

  &.request-sent
    cursor: initial

.kf-oph-connect-image
  display: inline-block

  &.add-friend
    sprite2x($add-friend)
    width: 36px

  &.already-friends
    sprite2x($add-friend-active)
    width: 36px

    &.hidden
      opacity: 0

.kf-oph-action-text
  position: relative
  top: 3px
  margin-left: 0px
  vertical-align: top
  font-size: 0.8em
  overflow: hidden

  &.connect
    display: inline-block
    width: 0px
    margin-left: 5px
    transition: 0.1s linear width

    :hover>&
      width: 60px

  &.hidden
    display: inline-block
    width: 0px
    height: 15px
    margin-left: 3px
    opacity: 0

.kf-oph-progress
  position: absolute
  top: 40px
  right: 5px
  width: 100px

.kf-oph-progress-bar
  position: absolute
  height: 2px
  width: 0%
  max-width: 70px
  background-color: white

.kf-oph-progress-check
  position: absolute
  top: -5px
  left: 75px
  sprite2x($white-checkmark)
  width: 14px
  height: 10px
  opacity: 0

.kf-oph-action-menu
  height: 0px
  overflow: hidden
  transition: 0.1s linear height

  &.on
    height: 50px

  .kf-oph-action-menu-item
    padding: 2px 10px 2px 10px
    margin-left: 30px
    margin-right: -8px
    font-size: 0.7em
    line-height: 20px

    &:hover
      background-color: #37414b

.kf-oph-connect-callout
  right: 0
  top: 100%
  width: auto
  margin-top: 14px
  padding: 14px 24px
  white-space: nowrap

  &::before
    left: auto
    right: 25px
    top: -11px
    border-width: 0 5px 11px 16px

actionGapBelow = 3px

.kf-oph-share
  sidePad = 6px
  display: inline-block
  vertical-align: top
  margin: 0 (16px - sidePad) 0 0
  border: 0
  padding: 0 sidePad 0 (sidePad + 22px)
  background-color: transparent
  background-position: sidePad 0
  background-repeat: no-repeat
  line-height: 20px

  &:focus
    outline: thin dotted alpha(#fff, .4)

    &:hover
      outline: none

  &:active
    opacity: .85

.kf-oph-share-url
  position: absolute
  right: 0
  margin-top: actionGapBelow
  line-height: 1.3
  font-size: .8em
  border-radius: 4px
  border: 1px solid rgba(255,255,255,.5)
  background-color: tint(pageHeaderColor, 10%)
  padding: .3em .4em
  white-space: nowrap
  font-smoothing: antialiased

  &.ng-enter
  &.ng-leave
    transition: opacity .12s, transform .12s

  &.ng-enter:not(.ng-enter-active)
  &.ng-leave.ng-leave-active
    opacity: 0
    transform: translate(0, -10%) scale(.9)

  &::-moz-selection
    background: rgba(128,184,255,.59)

.kf-oph-settings-icon
  display: inline-block
  width: 20px
  height: 20px
  cursor: pointer

.kf-oph-action-text
  margin-left: 2px
  color: white
  font-size: 14px
  line-height: 14px
  font-smoothing: antialiased
  cursor: pointer

.kf-oph-dropdown-parent
  display: inline-block
  position: relative

  .kf-dropdown-menu
    dur = .1s
    top: 'calc(100% + %s)' % actionGapBelow
    right: -24px
    transform-origin: 80% top
    transition: visibility 0s, opacity linear dur, transform dur

    .kf-dropdown-menu-item
      font-smoothing: antialiased
      padding: 0px 20px 0px 16px
      width: initial

  &:not(.kf-open)>.kf-dropdown-menu
    dur = .16s
    visibility: hidden
    opacity: 0
    transform: scale(.9)
    transition-duration: 0s, dur, dur
    transition-delay: dur, 0s, 0s

  &.kf-open::before
    content: ''
    position: absolute
    top: 'calc(100% - %s)' % actionGapBelow
    left: -10px
    right: -10px
    height: 20px

.kf-oph-pic-a
  display: inline-block

.kf-oph-pic
  width: 100px
  height: 100px
  border-radius: 50%

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    width: 60px
    height: 60px

.kf-oph-name
  margin-top: 6px
  line-height: 31px
  font-size: 21px
  font-weight: normal
  color: inherit

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    line-height: 20px
    font-size: 14px

.kf-oph-bio-add
  background: none
  outline: none
  border: none
  padding: 0
  color: accentGreen
  line-height: 1.6em
  font-size: 0.9em
  font-smoothing: antialiased

  &:hover
    text-decoration: underline

.kf-oph-bio
  max-width: 400px
  margin: 0 auto 4px
  color: #d8d8d8
  line-height: 1.6em
  font-size: 0.9em
  font-smoothing: antialiased
  word-break: break-word

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    max-width: 88%
    line-height: 16px
    font-size: 10px

  &>a[href]
    color: inherit

    &:hover
      text-decoration: underline

.kf-oph-nav
  margin: 10px auto 0
  display: inline-block

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    margin-top: 2px

  &::before
    content: ''
    display: block
    height: 1px
    background-color: #fff

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    &::before
      transform: scale(1,.5)  // half-pixel border workaround crbug.com/236371

.kf-oph-nav-a
  display: inline-block
  padding: 6px 10px
  color: #9fa3aa

  &[href]:hover
    background-color: alpha(#fff, 5%)

  &:not([href])
    color: accentGreen
    cursor: default

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    padding: 3px 5px

.kf-oph-nav-name
  line-height: 20px
  font-size: 12px
  text-transform: uppercase

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    line-height: 12px
    font-size: 7px

.kf-oph-nav-count
  color: #fff
  line-height: 24px
  font-size: 18px

  @media (max-height: uphSmallMaxDim) and (max-width: uphSmallMaxDim)
    line-height: 15px
    font-size: 11px

  :not([href])>&
    color: inherit
