<div class="kf-keep-card-attribution">
  <a class="kf-keep-card-attribution-keeper-pic" ng-if="::keep.user && !keep.sourceAttribution.slack" ng-href="{{::keep.user|profileUrl}}"
     ng-attr-style="background-image:url({{::keep.user|pic:100}})"></a>
  <a class="kf-keep-card-attribution-keeper-pic" ng-if="::keep.sourceAttribution.slack && keep.sourceAttribution.kifi" ng-href="{{::keep.sourceAttribution.kifi|profileUrl}}"
     ng-style="{ 'background-image' : 'url(' + (keep.sourceAttribution.kifi|pic:100) + ')' }"></a>
  <span class="svg-slack kf-keep-card-attribution-keeper-pic kf-keep-card-attribution-no-border" ng-if="::keep.sourceAttribution.slack && !keep.sourceAttribution.kifi"></span>
  <div class="kf-keep-card-attribution-message">
    <!--This is wrapped in a span to make sure there is a space after the name in safari :(-->
    <span ng-if="::keep.user && !keep.sourceAttribution.slack"><a class="kf-link"
       ng-href="{{::keep.user|profileUrl}}">{{::keep.user|name}}
    </a></span>
    <span ng-if="::keep.sourceAttribution.slack && !showAsDiscussion">
      <a class="kf-link" ng-href="{{keep.sourceAttribution.kifi | profileUrl}}" ng-if="keep.sourceAttribution.kifi"
        ng-bind="keep.sourceAttribution.kifi.firstName + ' ' + keep.sourceAttribution.kifi.lastName"></a>
      <a class="kf-link" ng-href="{{::keep.sourceAttribution.slack.message.permalink}}" ng-if="!keep.sourceAttribution.kifi" ng-bind="'@' + keep.sourceAttribution.slack.message.username"></a>
      added this
    </span>
    <span ng-if="::!keep.sourceAttribution.slack && !showAsDiscussion">kept this</span>
    <span ng-if="::showAsDiscussion">started a discussion</span>
    <span ng-if="::showAsDiscussion && keep.participants.length > 1">with
      <span class="kf-keep-card-attribution-discussion-members-list-item"
            ng-repeat="participant in keep.participants | filter:({id: '!'+keep.user.id}) | limitTo: (keep.participants.length > 4 ? 2 : 3)">
        <a class="kf-link" ng-href="{{::participant|profileUrl}}" ng-bind="participant.firstName"></a>
      </span>
      <span class="kf-keep-card-attribution-discussion-members-list-item"
            ng-if="::keep.participants.length > 4"
            ng-bind="(keep.participants.length - 3)+' others'"></span>
    </span>
    <span ng-if="::showLibraryAttribution && keep.library && keep.library.visibility !== 'discoverable' && keep.library.path.slice(-7) !== '/secret'">
    into
    </span>
    <span ng-if="::showLibraryAttribution && keep.library.visibility === 'secret'"
         data-kf-tooltip="This library is only viewable to those you invite"
         data-kf-tooltip-position="{{ !isFirstItem ? 'top' : 'bottom' }}">
      <svg kf-symbol-sprite
           icon="lock"
           class="kf-privacy-icon"
           ng-class="{'kf-collab': keep.library.numCollaborators}"
           title="A private library"></svg>
    </span>
    <span ng-if="::showLibraryAttribution && keep.library.visibility === 'discoverable'"
          data-kf-tooltip="This library is viewable to others in search results"
          data-kf-tooltip-position="{{ !isFirstItem ? 'top' : 'bottom' }}">
      <svg kf-symbol-sprite
           icon="star"
           class="kf-privacy-icon"
           ng-class="{'kf-collab': lib.numCollaborators}"
           title="A discoverable library"
           ng-show="keep.library.visibility === 'discoverable'"></svg>
    </span>
    <a ng-if="::showLibraryAttribution && keep.library"
       class="kf-feed-tooltip-target kf-link"
       ng-href="{{ keep.library.path }}"
       kf-user-tooltip="::keep.user"
       library="::keep.library"
       ng-bind="keep.library.name"
       ng-click="keepClick(null, $event)"
       click-action="clickedLibrary"></a>

    <span ng-if="::showLibraryAttribution && keep.library.org.name">in</span>
    <a class="kf-keep-card-attribution-message-tooltip-target kf-link"
       ng-href="{{::keep.library.org.handle}}"
       kf-user-tooltip="::keep.library.org"
       ng-bind="::keep.library.org.name"
       ng-click="keepClick(null, $event)"
       ng-if="::showLibraryAttribution && keep.library.org.name"
       click-action="clickedOrganization"></a>

    <span class="kf-keep-card-attribution-slack" ng-if="::keep.sourceAttribution.slack">
      <a class="kf-link" ng-href="{{::keep.sourceAttribution.slack.message.permalink}}" target="_blank" ng-click="trackSlack()">
        <span class="svg-slack kf-keep-card-attribution-slack-icon"></span>#<span ng-bind="keep.sourceAttribution.slack.message.channel.name"></span>
      </a>
    </span>

    <a class="kf-keep-tweet-link"
       ng-if="::keep.sourceAttribution.twitter.screenName"
       href="https://www.twitter.com/{{::keep.sourceAttribution.twitter.screenName}}/status/{{::keep.sourceAttribution.twitter.idString}}"
       target="_blank" ng-click="trackTweet()"><span class="kf-keep-twitter-logo svg-twitter-blue"></span><span ng-bind="'@' + keep.sourceAttribution.twitter.screenName"></span>
    </a>
    <span ng-if="isAdmin && keep.summary.hasContent">·</span>
    <span ng-if="isAdmin && keep.summary.hasContent"><a
      ng-href="https://www.kifi.com/k/cached?id={{keep.id}}" target="_blank">Saved</a></span>
    <span ng-if="::attributionTime">·</span>
    <a class="kf-keep-card-attribution-page-link kf-link" ng-if="showKeepPageLink" ng-href="{{::keep.path}}">
      <time ng-attr-datetime="{{::attributionTime}}" am-time-ago="::attributionTime"
            title="{{attributionTime|localTime}}" ng-if="::attributionTime"></time>
    </a>
    <time ng-attr-datetime="{{::attributionTime}}" am-time-ago="::attributionTime"
           title="{{attributionTime|localTime}}" ng-if="::attributionTime && !showKeepPageLink"></time>
  </div>
</div>
