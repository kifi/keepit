<div class="kf-keep-body" ng-class="::{'kf-boxed': boxed != null, 'kf-side-by-side': image.w, 'kf-text-only': !image && !youtubeId}">
  <div class="kf-keep-header" ng-if="!galleryView">
    <div class="kf-keep-header-l">
      <a class="kf-keep-keeper-pic" ng-if="::keep.user" ng-href="{{::keep.user|profileUrl}}" ng-attr-style="background-image:url({{::keep.user|pic:100}})"></a>
      <a class="kf-keep-keeper-name" ng-if="::keep.user" ng-href="{{::keep.user|profileUrl}}">{{::keep.user|name}}</a>
    </div>
    <div class="kf-keep-header-r">
      <time ng-attr-datetime="{{::keep.createdAt}}" am-time-ago="::keep.createdAt" title="{{::keep.createdAt|localTime}}" ng-if="::keep.createdAt"></time>
      <button ng-attr-class="kf-keep-keep-btn {{howKept ? 'state-kept-' + howKept : 'state-not-kept'}}"
        kf-keep-to-library-widget widget-action-text="Keep" library-click-action="onWidgetLibraryClicked(clickedLibrary)"
        kept-to-library-ids="keptToLibraryIds" lib-select-down-offset="180" lib-select-left-offset="20">
        <span ng-attr-class="{{howKept ? howKept === 'private' ? 'svg-small-lock' : 'svg-hearts-green' : 'svg-hearts-green-empty'}}"></span>
        <span class="kf-hide-compact">{{howKept ? 'Kept' : 'Keep'}}</span>
      </button>
      <button class="kf-keep-share-btn" ng-click="clickCallback({keep: keep, event: $event}); shareAction()" click-action="clickedShareArticle">
        <span class="svg-share-arrow-green"></span>
        <span class="kf-hide-compact">Share</span>
      </button>
    </div>
  </div>
  <div class="kf-keep-video" ng-if="::youtubeId" ng-click="clickCallback({keep: keep, event: $event})">
    <div kf-youtube video-id="youtubeId"></div>
    <div class="kf-youtube-bottom-overlay"></div>
  </div>
  <a class="kf-keep-image" ng-if="::image" ng-class="::{'kf-bottom-clip': image.clipBottom}"
    ng-style="{'background-image': 'url(\'' + image.url + '\')', width: image.w ? image.w + 'px' : '', 'padding-top': image.h ? image.h + 'px' : ''}"
    ng-href="{{::keep.url}}" target="_blank" rel="nofollow" tabindex="-1"
    ng-click="clickCallback({keep: keep, event: $event})" click-action="clickedArticleImage">
  </a>
  <div class="kf-keep-content">
    <div class="kf-keep-meta">
      <span class="kf-keep-source">{{::keepSource}}</span>
      <span class="kf-keep-length" ng-if="::keep.summary.wordCount > 0 && !youtubeId">{{::keep.summary.wordCount|timeToRead}} read</span>
    </div>
    <div class="kf-keep-title">
      <a class="kf-keep-title-link" ng-href="{{::keep.url}}" target="_blank" ng-click="clickCallback({keep: keep, event: $event})" rel="nofollow" click-action="clickedArticleTitle">{{displayTitle}}</a>
    </div>
    <div class="kf-keep-description" ng-hide="!galleryView && keep.note" kf-ellipsis full-text="keep.summary.description" max-num-lines="image.maxDescLines || defaultDescLines"></div>
    <div class="kf-keep-note-icon" ng-if="::keep.note" ng-click="editKeepNote($event, keep)">
      <span class="svg-note-gray"></span>
    </div>
    <div class="kf-keep-note-compact" ng-bind-html="::keep.note|noteHtml" ng-if="::keep.note || keep.user.id === me.id"></div>
  </div>
  <div class="clearfix"></div>

  <div class="kf-keep-footer">
    <div class="kf-keep-actions" ng-if="$root.userLoggedIn">
      <button ng-attr-class="kf-keep-keep-btn {{howKept ? 'state-kept-' + howKept : 'state-not-kept'}}"
        kf-keep-to-library-widget widget-action-text="Keep" library-click-action="onWidgetLibraryClicked(clickedLibrary)"
        kept-to-library-ids="keptToLibraryIds" lib-select-down-offset="180" lib-select-left-offset="20">
        <span ng-attr-class="{{howKept ? howKept === 'private' ? 'svg-small-lock' : 'svg-hearts-green' : 'svg-hearts-green-empty'}}"></span>
        <span class="kf-hide-compact">{{howKept ? 'Kept' : 'Keep'}}</span>
      </button>
      <button class="kf-keep-share-btn" ng-click="clickCallback({keep: keep, event: $event}); shareAction()" click-action="clickedShareArticle">
        <span class="svg-share-arrow-green"></span>
        <span class="kf-hide-compact">Share</span>
      </button>
    </div>
    <div class="kf-keep-who" ng-if="keep.keepersTotal || keep.keepers.length">
      <span class="kf-keep-who-pic-box" ng-repeat="keeper in keep.keepers | limitTo:6" kf-user-tooltip="::keeper" library="::keeper.library" desc="Your Kifi connection">
        <a class="kf-keep-who-pic" ng-attr-style="background-image:url({{::keeper|pic:100}})" ng-href="{{::keeper.library.path || '/' + keeper.username}}" kf-track-origin="{{::currentPageOrigin}}/alsoKeptBy"></a>
      </span>
      <span class="kf-keep-who-num" ng-if="keep.keepersTotal > (keep.keepers.length || 0)">
        {{keep.keepersTotal - (keep.keepers.length || 0) | num}}
      </span>
    </div>
  </div>
</div>
