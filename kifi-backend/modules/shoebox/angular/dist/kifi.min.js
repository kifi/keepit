"use strict";angular.module("kifi",["ngCookies","ngResource","ngRoute","ngSanitize","ngAnimate","ui.bootstrap","util","dom","antiscroll","nodraginput","jun.smartScroll","angularMoment","kifi.home","kifi.search","kifi.tagKeeps","kifi.profile","kifi.friends","kifi.friendService","kifi.friends.friendCard","kifi.friends.friendRequestCard","kifi.social","kifi.social.networksNeedAttention","kifi.socialService","kifi.invite","kifi.invite.connectionCard","kifi.invite.wtiService","kifi.focus","kifi.youtube","kifi.templates","kifi.profileCard","kifi.profileService","kifi.detail","kifi.tags","kifi.keeps","kifi.keep","kifi.layout.leftCol","kifi.layout.main","kifi.layout.nav","kifi.layout.rightCol","kifi.undo","kifi.addKeeps","kifi.installService","jun.facebook","ngDragDrop","ui.slider","angulartics","kifi.mixpanel","kifi.alertBanner"]).run(["$route",angular.noop]).config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,c){b.html5Mode(!0).hashPrefix("!"),a.otherwise({redirectTo:"/"}),c.defaults.withCredentials=!0}]).constant("linkedinConfigSettings",{appKey:"r11loldy9zlg"}).config(["$FBProvider",function(a){var b=window.location.host||window.location.hostname,c=/^dev\.ezkeep\.com|localhost$/.test(b);a.appId(c?"530357056981814":"104629159695560").scope("email").cookie(!0).logging(!1)}]).factory("env",["$location",function(a){var b=a.host(),c=/^dev\.ezkeep\.com|localhost$/.test(b),d=9e3===a.port(),e=d?a.protocol()+"://"+b+":"+a.port():"https://www.kifi.com";return{local:d,dev:c,production:!c,origin:e,xhrBase:e+"/site",xhrBaseEliza:e.replace("www","eliza")+"/eliza/site",xhrBaseSearch:e.replace("www","search"),picBase:(d?"//d1scct5mnc9d9m":"//djty7jcqog9qu")+".cloudfront.net"}}]).factory("injectedState",["$location",function(a){function b(a){return _.forOwn(a,function(a,b){c[b]=a}),c}var c={};return _.size(a.search())>0&&(_.forOwn(a.search(),function(a,b){c[b]=a}),"/find"!==a.path()&&a.search({})),{state:c,pushState:b}}]).controller("AppCtrl",["profileService","$rootScope","$window","friendService","$timeout","env",function(a,b,c,d,e,f){e(function(){a.fetchPrefs().then(function(a){return f.production&&(a.onboarding_seen?c.postMessage("get_bookmark_count_if_should_import","*"):b.$emit("showGettingStarted")),a}),d.getRequests()})}]),angular.module("kifi.alertBanner",[]).directive("kfAlertBanner",[function(){return{scope:{action:"=",actionText:"@"},replace:!0,restrict:"A",transclude:!0,templateUrl:"common/directives/alertBanner/alertBanner.tpl.html",link:function(){}}}]),angular.module("antiscroll",["kifi.scrollbar"]).directive("antiscroll",["$timeout","scrollbar",function(a,b){return{restrict:"A",transclude:!0,link:function(c,d,e){var f;e.antiscroll&&(f=c.$eval(e.antiscroll)),c.scroller=d.antiscroll(f).data("antiscroll"),c.refreshScroll=function(){return a(function(){c.scroller&&c.scroller.refresh()})},c.refreshScroll(),c.width="calc(100% + "+b.getAntiscrollWidth()+"px)",c.$on("refreshScroll",c.refreshScroll)},template:'<div class="antiscroll-inner" ng-attr-style="width: {{width}}" ng-transclude></div>'}}]),angular.module("kifi.focus",[]).directive("focusWhen",["$timeout",function(a){return{restrict:"A",scope:{focusWhen:"="},link:function(b,c){function d(){c.focus(),b.focusWhen=!1}b.$watch("focusWhen",function(b){b&&a(d)})}}}]).directive("kfFocusIf",[function(){return{restrict:"A",scope:{focusCond:"="},link:function(a,b){a.$watch("focusCond",function(a){a&&b.focus()})}}}]),angular.module("kifi.keepWhoPics",["kifi.keepWhoService"]).directive("kfKeepWhoPic",["$window","$timeout","$rootElement","$compile","$templateCache","keepWhoService",function(a,b,c,d,e,f){return{restrict:"A",replace:!0,templateUrl:"common/directives/keepWho/keepWhoPic.tpl.html",scope:{keeper:"="},link:function(g,h){g.tooltipEnabled=!1,g.getPicUrl=f.getPicUrl,g.getName=f.getName;var i=null,j=null;g.cancelTimeout=function(){b.cancel(j)},g.$on("$destroy",function(){g.cancelTimeout(),i&&i.remove()}),g.showTooltip=function(){i||(i=angular.element(e.get("common/directives/keepWho/friendCard.tpl.html")),c.append(i),d(i)(g));var f=42,k=1,l=i.find(".kifi-fr-kcard-tri"),m=h.offset().left+h.width()/2-f,n=h.offset().top-91,o=f-k;a.innerWidth-m-i.width()<3&&(m+=2*f-i.width(),o=i.width()-f-k),i.css({left:m+"px",top:n+"px",width:i.width()+"px",visibility:"hidden"}),l.css({left:o}),j=b(function(){i.css("visibility","visible"),g.tooltipEnabled=!0},500)},g.hideTooltip=function(){g.cancelTimeout(),g.tooltipEnabled=!1}}}}]).directive("kfKeepWhoPics",["keepWhoService",function(a){return{restrict:"A",replace:!0,templateUrl:"common/directives/keepWho/keepWhoPics.tpl.html",scope:{me:"=",keepers:"=",keep:"="},link:function(b){b.getPicUrl=a.getPicUrl,b.getName=a.getName,b.isMyBookmark=b.keep&&b.keep.isMyBookmark}}}]),angular.module("kifi.keepWhoText",["kifi.profileService"]).directive("kfKeepWhoText",["profileService",function(a){return{restrict:"A",replace:!0,templateUrl:"common/directives/keepWho/keepWhoText.tpl.html",scope:{keep:"="},link:function(b){b.me=a.me,b.helprankEnabled=!1,b.$watch(function(){return a.me.seqNum},function(){b.helprankEnabled=a.me&&a.me.experiments&&a.me.experiments.indexOf("helprank")>-1}),b.isPrivate=function(){return b.keep.isPrivate||!1},b.hasKeepers=function(){var a=b.keep;return!(!a.keepers||!a.keepers.length)},b.hasOthers=function(){var a=b.keep;return a.others>0},b.getFriendText=function(){var a,c=b.keep.keepers,d=c&&c.length||0;return 1===d&&(a="1 friend"),a=d+" friends",b.keep.isMyBookmark?"+ "+a:a},b.getOthersText=function(){var a,c=b.keep.others||0;return a=1===c?"1 other":c+" others",(b.keep.isMyBookmark||b.keep.keepers.length>0)&&(a="+ "+a),a},b.isOnlyMine=function(){return!b.hasKeepers()&&!b.keep.others}}}}]),angular.module("nodraginput",[]).directive("kfNoDragInput",[function(){return{restrict:"A",link:function(a,b){function c(a){a.dataTransfer&&(a.dataTransfer.dropEffect="none"),a.stopPropagation(),a.preventDefault()}b.attr("draggable","false"),b.on("dragstart",function(){return!1}),b.on("dragenter",c),b.on("dragover",c),b.on("drop",c)}}}]),angular.module("kifi.youtube",[]).directive("kfYoutube",[function(){function a(a){return"//www.youtube.com/v/"+a+"&rel=0&theme=light&showinfo=0&disablekb=1&modestbranding=1&controls=0&hd=1&autohide=1&color=white&iv_load_policy=3"}function b(a){return'<embed src="'+a+'" type="application/x-shockwave-flash" allowfullscreen="true" style="width:100%; height: 100%;" allowscriptaccess="always"></embed>'}return{restrict:"A",replace:!0,scope:{videoId:"="},template:'<div class="kf-youtube"></div>',link:function(c,d){function e(c){f!==c&&(f=c,c&&d.html(b(a(c))))}var f=null;e(c.videoId),c.$watch("videoId",e)}}}]),angular.module("dom",[]).value("dom",{scrollIntoViewLazy:function(a,b){var c;if(a&&(c=a.offsetParent)){var d=c.scrollTop,e=c.clientHeight,f=d+e,g=a.offsetTop,h=g+a.offsetHeight;h>f?c.scrollTop=h+(b||0)-e:d>g&&(c.scrollTop=g-(b||0))}},absOffsets:function(a){for(var b=0,c=0;a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{x:b,y:c}}}),angular.module("kifi.modal",[]).directive("kfModal",["$document",function(a){return{restrict:"A",replace:!0,scope:{show:"="},templateUrl:"common/modal/modal.tpl.html",transclude:!0,controller:["$scope",function(b){function c(a){27===a.which&&(b.hideModal(a),b.$apply())}var d=null;this.setDefaultHideAction=function(a){d=a},this.hideModal=function(a){b.noUserHide&&b.show||("function"==typeof a?a():d&&d(),b.show=!1)},this.show=b.show||!1,b.hideModal=this.hideModal,b.$watch(function(){return b.show},function(){this.show=b.show||!1,b.show?a.on("keydown",c):a.off("keydown",c)}),b.$on("$destroy",function(){a.off("keydown",c)})}],link:function(a,b,c){a.dialogStyle={},a.backdropStyle={},a.noUserHide=void 0!==c.noUserHide||!1,c.kfWidth&&(a.dialogStyle.width=c.kfWidth),c.kfHeight&&(a.dialogStyle.height=c.kfHeight),a.backdropStyle.opacity=c.kfOpacity||.3,a.backdropStyle.backgroundColor=c.kfBackdropColor||"rgba(0, 40, 90, 1)"}}}]).directive("kfBasicModalContent",["$window",function(a){return{restrict:"A",replace:!0,scope:{action:"&",cancel:"&",title:"@"},templateUrl:"common/modal/basicModalContent.tpl.html",transclude:!0,require:"^kfModal",link:function(b,c,d,e){b.title=d.title||"",b.singleAction=d.singleAction||!0,b.actionText=d.actionText,b.withCancel=void 0!==d.withCancel||!1,b.withWarning=void 0!==d.withWarning||!1,b.cancelText=d.cancelText,b.centered=d.centered,e.setDefaultHideAction(b.cancel),b.hideAndCancel=e.hideModal,b.hideAndAction=function(){e.hideModal(b.action)};var f=c.find(".dialog-body-wrap"),g=_.debounce(function(){var b=a.document.body.clientHeight;f.css({"max-height":b-160+"px","overflow-y":"auto","overflow-x":"hidden"})},100);b.$watch(function(){return e.show},function(b){b?(g(),a.addEventListener("resize",g)):a.removeEventListener("resize",g)}),b.$on("$destroy",function(){a.removeEventListener("resize",g)})}}}]),angular.module("jun.facebook",[]).provider("$FB",function(){function a(a,b){return void 0===b?e[a]:(e[a]=b,d)}function b(a){!a||a.error?this.reject(a&&a.error||!1):this.resolve(a)}function c(a,b){var c=a.promise;return"function"==typeof b&&c.then(b),c}var d=this,e={appId:null,cookie:!1,logging:!0,status:!0,xfbml:!1,authResponse:void 0,frictionlessRequests:!1,hideFlashCallback:null,scope:"",enable_profile_selector:!1,profile_selector_ids:""};angular.forEach(["appId","cookie","logging","status","xfbml","authResponse","frictionlessRequests","hideFlashCallback","scope","enable_profile_selector","profile_selector_ids"],function(b){d[b]=angular.bind(d,a,b)}),this.option=function(b,c){return"object"==typeof b?(angular.extend(e,b),d):a(b,c)};var f,g,h,i,j,k;this.$get=["$window","$timeout","$q",function(a,b,c){return k=c,i=a,j=b,d}],this.loading=!1,this.loaded=!1,this.FB=null,this.load=function(){if(!g){var a=i,b=k.defer();a.fbAsyncInit=function(){f=d.FB=a.FB,d.loading=!1,d.loaded=!0,j(function(){b.resolve(f)})},function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/all.js",e.parentNode.insertBefore(d,e))}(a.document,"script","facebook-jssdk"),d.loading=!0,g=b.promise}return g},this.initialized=!1,this.init=function(a){return h||(h=d.load().then(function(b){if(a=angular.extend({appId:e.appId,cookie:e.cookie,logging:e.logging,status:e.status,xfbml:e.xfbml,authResponse:e.authResponse,frictionlessRequests:e.frictionlessRequests,hideFlashCallback:e.hideFlashCallback},a),!a.appId)throw new Error("$FB: appId is not set!");return b.init(a),d.initialized=!0,b})),h},this.getLoginStatus=function(a){return d.init().then(function(d){var e=k.defer();return d.getLoginStatus(angular.bind(e,b)),c(e,a)})},this.api=function(){var a=arguments;return d.init().then(function(d){var e,f=k.defer(),g=Array.prototype.slice.call(a);return"function"==typeof g[g.length-1]&&(e=g.pop()),g.push(angular.bind(f,b)),d.api.apply(d,g),c(f,e)})},this.ui=function(){var a=arguments;return d.init().then(function(d){var e,f=k.defer(),g=Array.prototype.slice.call(a);return"function"==typeof g[g.length-1]&&(e=g.pop()),g.push(angular.bind(f,b)),d.ui.apply(d,g),c(f,e)})},this.login=function(a,f){return d.init().then(function(d){function g(a){var b=f&&f[a];return void 0===b?e[a]:b}var h=k.defer();return"function"!=typeof a&&(a=null,f=a),d.login(angular.bind(h,b),{scope:g("scope"),enable_profile_selector:g("enable_profile_selector"),profile_selector_ids:g("profile_selector_ids")}),c(h,a)})},this.logout=function(a){return d.getLoginStatus().then(function(d){var e=k.defer();return d.authResponse?f.logout(angular.bind(e,b)):e.reject(d),c(e,a)})},this.disconnect=function(a){return d.init().then(function(d){var e=k.defer();return d.api("/me/permissions","DELETE",angular.bind(e,b)),c(e,a)})}}),angular.module("kifi.clutch",[]).factory("Clutch",["$q","$timeout","util",function(a,b,c){var d=function(){function b(a,b){this._config=_.defaults({},b,g),this._getter=a,this._cache={}}function d(a){return JSON.stringify(Array.prototype.slice.call(a))}function e(a,b){return h()-a>b}function f(b,d){var e=a.defer(),f=this._getter.apply(this,d),g=this._cache[b]||{};g.q=e.promise,g.activeRequest=!0,this._cache[b]=g;var i=this;return f.then(function(a){if(g.time=h(),g.activeRequest=!1,g.value){if(g.value===a)return e.resolve(g.value);if(angular.isArray(a))c.replaceArrayInPlace(g.value,a);else{if(!angular.isObject(a))throw new TypeError("Supplied function must return an array/object");c.replaceObjectInPlace(g.value,a)}}else g.value=a,i._cache[b]=g;e.resolve(g.value)})["catch"](function(a){g.activeRequest=!1,g.value&&"ignore"===i._config.remoteError?e.resolve(g.value):e.reject(a)}),e.promise}var g={remoteError:"ignore",cache:!1,cacheDuration:3e4,returnPreviousOnExpire:!1,defaultValue:!1,somethingAboutOffline:!0},h=Date.now||function(){return(new Date).getTime()};return b.prototype.get=function(){var b=d(arguments),c=this._cache[b];return c?!c.value||c.activeRequest?c.q:e(c.time,this._config.cacheDuration)?this._config.returnPreviousOnExpire?(f.call(this,b,arguments),a.when(c.value)):f.call(this,b,arguments):c.q||a.when(c.value):f.call(this,b,arguments)},b.prototype.contains=function(){return!!this._cache[d(arguments)]},b.prototype.refresh=function(){var a=d(arguments);return f.call(this,a,arguments)},b.prototype.age=function(){var a=d(arguments);return a&&this._cache[a]&&h()-this._cache[a].time},b.prototype.isExpired=function(){var a=d(arguments),b=a&&this._cache[a];return b&&e(b.time,this._config.cacheDuration)},b.prototype.expire=function(){var a=d(arguments),b=this._cache[a];return delete this._cache[a],b},b.prototype.expireAll=function(){this._cache={}},b}();return d}]),angular.module("kifi.installService",[]).factory("installService",["$window","$log","$rootScope","$timeout",function(a,b,c,d){var e=a.chrome&&a.chrome.webstore&&a.chrome.webstore.install,f=!e&&"MozBoxSizing"in a.document.documentElement.style||a.navigator.userAgent.indexOf("Firefox")>-1,g=+(a.navigator.userAgent.match(/(?:Chrome|Firefox)\/(\d+)/)||[null,999])[1],h=e&&g>=26||f&&g>=20;if(e&&h){var i=a.document.createElement("link");i.rel="chrome-webstore-item",i.href="https://chrome.google.com/webstore/detail/fpjooibalklfinmkiodaamcckfbcjhin";var j=a.document.getElementsByTagName("link")[0];j.parentNode.insertBefore(i,j)}var k={triggerInstall:function(g){e&&h?(k.installInProgress=!0,a.chrome.webstore.install("https://chrome.google.com/webstore/detail/fpjooibalklfinmkiodaamcckfbcjhin",function(){k.installed=!0,k.installInProgress=!1,k.error=!1,c.$digest()},function(a){b.log(a),k.installed=!1,k.installInProgress=!1,k.error=!0,g&&g(),c.$digest(),d(function(){k.error=!1,c.$digest()},1e4)})):a.location.href=f&&h?"//www.kifi.com/assets/plugins/kifi-beta.xpi":"//www.kifi.com/unsupported"},canInstall:h,installInProgress:!1,installed:!1,error:!1};return k}]),angular.module("kifi.keepWhoService",[]).factory("keepWhoService",[function(){var a={getPicUrl:function(a){return a&&a.id&&a.pictureName?"//djty7jcqog9qu.cloudfront.net/users/"+a.id+"/pics/100/"+a.pictureName:""},getName:function(a){return a?a.firstName&&a.lastName?a.firstName+" "+a.lastName:a.firstName||a.lastName||"":""}};return a}]),angular.module("kifi.me",[]).service("me",function(){return{replace:!0,restrict:"A",templateUrl:"profileCard/profileCard.tpl.html",link:function(a){a.firstName="Joon Ho",a.lastName="Cho",a.description="Porting to Angular.js"}}}),function(a){var b,c,d;a.module("kifi.mixpanel",["angulartics"]).config(["$analyticsProvider",function(a){function e(a){for(var b in k)if(k[b].test(a))return b;return a}function f(){var a="standard";if(d&&d.me&&d.me.experiments){var b=d.me.experiments;b.indexOf("fake")>-1?a="fake":b.indexOf("admin")>-1&&(a="admin")}return a}function g(a,h,k){if(j){var l=a.get_distinct_id&&a.get_distinct_id();try{k||(k=b.location.origin),a.identify(j),c.log("mixpanelService.pageTrackForUser("+h+"):"+k),a.track("user_viewed_page",{type:e(h),origin:k,siteVersion:2,userStatus:f()})}finally{l||a.identify(l)}}else if(i.push(h),d&&d.me&&d.me.id){j=d.me.id;var m=i.slice();i.length=0,m.forEach(function(b){g(a,b,k)})}}function h(a,b,d){c.log("mixpanelService.pageTrackForVisitor("+b+"):"+d),a.track("visitor_viewed_page",{type:e(b),origin:d,siteVersion:2})}var i=[],j=null,k={yourKeeps:/^\/$/,yourFriends:/^\/friends$/,tagResults:/^\/tag/,searchResults:/^\/find/,addFriends:/^\/friends\/(invite|find)$/,requests:/^\/friends\/requests$/};angulartics.waitForVendorApi("mixpanel",5e3,function(){a.registerPageTrack(function(a){if(d&&b){var c=b.mixpanel,f=e(a),i=b.location.origin;h(c,f,i),g(c,f,i)}})}),angulartics.waitForVendorApi("mixpanel",5e3,function(){a.registerEventTrack(function(a,d){if(b){var e=b.mixpanel;c.log("mixpanelService.eventTrack("+a+")",d),e.track(a,d)}})})}]).run(["profileService","$window","$log",function(a,e,f){b=e,d=a,c=f}])}(angular),angular.module("kifi.routeService",[]).factory("routeService",["$location","env",function(a,b){function c(a){return b.xhrBase+a}function d(a){return b.xhrBaseSearch+a}function e(a,c,d){return b.picBase+"/users/"+a+"/pics/"+(d||200)+"/"+c}return{disconnectNetwork:function(a){return b.origin+"/disconnect/"+a},linkNetwork:function(a){return b.origin+"/link/"+a},uploadBookmarkFile:c("/keeps/file-import"),refreshNetworks:b.origin+"/friends/invite/refresh",importStatus:c("/user/import-status"),prefs:c("/user/prefs"),importGmail:function(){return b.origin+"/contacts/import?redirectUrl="+a.url()},networks:c("/user/networks"),profileUrl:c("/user/me"),logout:"https://www.kifi.com/logout",emailInfoUrl:c("/user/email"),abooksUrl:c("/user/abooks"),resendVerificationUrl:c("/user/resend-verification"),userPasswordUrl:c("/user/password"),formatPicUrl:e,removeSingleKeep:function(a){return b.xhrBase+"/keeps/"+a+"/delete"},removeKeeps:c("/keeps/remove"),tagOrdering:c("/collections/ordering"),whoToInvite:c("/friends/wti"),blockWtiConnection:c("/friends/wti/block"),friends:function(a,b){return c("/user/friends")+"?page="+a+"&pageSize="+b},friendRequest:function(a){return b.xhrBase+"/user/"+a+"/friend"},incomingFriendRequests:c("/user/incomingFriendRequests"),invite:c("/user/invite"),search:d("/site/search"),searchResultClicked:d("/site/search/events/resultClicked"),searchedAnalytics:d("/site/search/events/searched"),searchResultClickedAnalytics:d("/site/search/events/resultClicked"),socialSearch:function(a,b){return b=b||6,c("/user/connections/all/search?query="+a+"&limit="+b+"&pictureUrl=true")}}}]),angular.module("kifi.scrollbar",[]).factory("scrollbar",["$document",function(a){function b(){var b=a[0],c=b.createElement("p");c.style.width="100%",c.style.height="200px";var d=b.createElement("div");d.style.position="absolute",d.style.top="0px",d.style.left="0px",d.style.visibility="hidden",d.style.width="200px",d.style.height="150px",d.style.overflow="hidden",d.appendChild(c),b.body.appendChild(d);var e=c.offsetWidth;d.style.overflow="scroll";var f=c.offsetWidth;return e===f&&(f=d.clientWidth),b.body.removeChild(d),e-f}function c(){var a=f('<div class="antiscroll-inner" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"/></div>');f("body").append(a);var b=f(a).innerWidth(),c=f("div",a).innerWidth();return f(a).remove(),b-c}var d=null,e=null,f=angular.element;return{getWidth:function(){return null==d&&(d=b()),d},getAntiscrollWidth:function(){return null==e&&(e=c()),e}}}]),angular.module("kifi.undo",[]).factory("undoService",["$timeout",function(a){var b=3e4,c={isSet:function(){return!!c.callback},add:function(d,e,f){c.message=d,c.callback=e,c.promise&&a.cancel(c.promise),c.promise=a(function(){c.promise=null,c.clear()},null==f?b:f)},clear:function(){c.promise&&a.cancel(c.promise),c.message=c.callback=c.promise=null},undo:function(){var a=null;return c.callback&&(a=c.callback.call()),c.clear(),a}};return c}]),angular.module("util",[]).factory("util",["$document","$window",function(a,b){return{startsWith:function(a,b){return a===b||0===a.lastIndexOf(b,0)},endsWith:function(a,b){return a===b||-1!==a.indexOf(b,a.length-b.length)},trimInput:function(a){return a?a.trim().replace(/\s+/g," "):""},validateEmail:function(a){var b=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;return b.test(a)},replaceArrayInPlace:function(a,b){a=a||[],a.length=0,a.push.apply(a,b)},replaceObjectInPlace:function(a,b){_.forOwn(a||{},function(b,c){delete a[c]}),_.forOwn(b||{},function(c,d){a[d]=b[d]})},offset:function(c){try{return c.offset()}catch(d){}var e=c[0],f=a.documentElement||a.body,g=b.pageXOffset||f.scrollLeft,h=b.pageYOffset||f.scrollTop,i=e.getBoundingClientRect().left+g,j=e.getBoundingClientRect().top+h;return{left:i,top:j}}}}]).directive("postRepeatDirective",["$timeout","$window",function(a,b){return function(c){c.$first&&b.console&&b.console.time&&b.console.time("postRepeatDirective"),c.$last&&a(function(){b.console&&b.console.time&&(b.console.time("postRepeatDirective"),b.console.timeEnd("postRepeatDirective"))})}}]).constant("keyIndices",{KEY_UP:38,KEY_DOWN:40,KEY_ENTER:13,KEY_ESC:27,KEY_TAB:9,KEY_DEL:46,KEY_F2:113}),angular.module("kifi.detail",["kifi.keepService","kifi.tagService","kifi.keepWhoPics","kifi.keepWhoText","kifi.youtube","kifi.profileService","kifi.focus"]).directive("kfDetail",["keepService","$filter","$sce","$document","profileService","$window",function(a,b,c,d,e,f){return{replace:!0,restrict:"A",templateUrl:"detail/detail.tpl.html",link:function(b){b.isSingleKeep=a.isSingleKeep,b.getLength=a.getSelectedLength,b.isDetailOpen=a.isDetailOpen,b.getPreviewed=a.getPreviewed,b.getSelected=a.getSelected,b.closeDetail=a.clearState,b.me=e.me,b.$watch(b.getPreviewed,function(a){b.keep=a,b.refreshScroll()}),b.getSelectedKeeps=function(){return b.isSingleKeep()?[b.getPreviewed()]:b.getSelected()},b.getPrivateConversationText=function(){return 1===b.keep.conversationCount?"Private Conversation":"Private Conversations"},b.getTitleText=function(){return a.getSelectedLength()+" Keeps selected"},b.howKept=null,b.$watch(function(){if(b.isSingleKeep())return b.keep?b.keep.isPrivate?"private":"public":null;var a=b.getSelected();return _.every(a,"isMyBookmark")?_.every(a,"isPrivate")?"private":"public":null},function(a){b.howKept=a}),b.isPrivate=function(){return"private"===b.howKept&&b.keep&&b.keep.isMyBookmark},b.isPublic=function(){return"public"===b.howKept&&b.keep&&b.keep.isMyBookmark},b.toggleKeep=function(){var c=b.getSelectedKeeps();return a.toggleKeep(c)},b.togglePrivate=function(){var c=b.getSelectedKeeps();return a.togglePrivate(c)},b.refreshScroll=b.refreshScroll||angular.noop;var c=_.throttle(function(){b.refreshScroll()},150);f.addEventListener("resize",c),b.$on("$destroy",function(){f.removeEventListener("resize",c)})}}}]).directive("kfTagList",["keepService","tagService","$filter","$sce","$document",function(a,b,c,d,e){var f=38,g=40,h=13,i=27,j=46,k=113,l=5;return{scope:{keep:"=",getSelectedKeeps:"&"},replace:!0,restrict:"A",templateUrl:"detail/tagList.tpl.html",link:function(a,c){function m(b){return b?a.tagTypeAheadResults.indexOf(b):-1}function n(b){function f(b){return a.keep&&a.allTags&&a.commonTags&&!!_.find(a.commonTags,function(a){return a.id===b})}function g(){return a.allTags.filter(function(a){return!f(a.id)}).slice(0,l)}function h(){var a=c.find(".page-coll-list");return a&&a.offset().top?Math.min(10,Math.max(3,(e.height()-a.offset().top)/24-1)):l}var i=b&&b.split(/[\W]+/);if(l=h(),a.allTags&&b){var j=a.allTags.filter(function(a){return!f(a.id)&&i.every(function(b){return _.find(a.name.split(/[\W]+/),function(a){return 0===a.toLowerCase().indexOf(b.toLowerCase())})})});a.tagTypeAheadResults=j.slice(0,l)}else a.allTags&&!b&&(a.tagTypeAheadResults=g());a.tagTypeAheadResults.length>0&&a.highlightFirst(),a.tagTypeAheadResults.forEach(function(a){var b=a.name.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");a.prettyHtml=d.trustAsHtml(b)})}a.data={},a.data.isClickingInList=!1,a.newTagLabel="NEW",a.tagFilter={name:""},a.tagTypeAheadResults=[],a.shouldGiveFocus=!1,b.fetchAll().then(function(b){a.allTags=b,n(null)}),a.$watch("keep",function(){a.tagFilter.name="",n(null),a.hideAddTagDropdown()}),a.getCommonTags=function(){var b=_.pluck(a.getSelectedKeeps(),"tagList"),c=_.map(b,function(a){return _.pluck(a,"id")}),d=_.union.apply(this,c),e=_.indexBy(_.flatten(b,!0),"id");return _.map(d,function(a){return e[a]})},a.$watch(function(){return _.pluck(a.getSelectedKeeps(),"tagList")},function(){a.commonTags=a.getCommonTags()},!0),a.addTag=function(c){return b.addKeepsToTag(c,a.getSelectedKeeps()),a.tagFilter.name="",a.hideAddTagDropdown()},a.createAndAddTag=function(c){b.create(a.tagFilter.name).then(function(b){a.addTag(b,c)})},a.isTagHighlighted=function(b){return a.highlightedTag===b},a.checkHighlight=function(){_.find(a.tagTypeAheadResults,function(b){return a.highlightedTag===b})||a.highlightTag(null)},a.$watch("tagFilter.name",function(b){n(b),a.checkHighlight()}),a.highlightTag=function(b){return a.highlightedTag=b},a.highlightNext=function(){var b=m(a.highlightedTag);return-1===b?a.highlightFirst():b===a.tagTypeAheadResults.length-1?a.isAddTagShown()?a.highlightNewSuggestion():a.highlightFirst():a.highlightAt(b+1)},a.highlightPrev=function(){var b=m(a.highlightedTag);return-1===b?a.highlightLast():0===b?a.isAddTagShown()?a.highlightNewSuggestion():a.highlightLast():a.highlightAt(b-1)},a.isAddTagShown=function(){return a.tagFilter.name.length>0&&void 0===_.find(a.tagTypeAheadResults,function(b){return b.name===a.tagFilter.name})},a.highlightAt=function(b){if(null==b)return a.highlightNewSuggestion();var c=a.tagTypeAheadResults,d=c.length;if(!d)return a.highlightNewSuggestion();b=(b%d+d)%d;var e=c[b];return a.highlightTag(e),e},a.highlightFirst=function(){a.highlightAt(0)},a.highlightLast=function(){return a.highlightAt(-1)},a.highlightNewSuggestion=function(){return a.isAddTagShown()?a.highlightedTag=null:a.highlightFirst()},a.selectTag=function(){return a.highlightedTag?a.addTag(a.highlightedTag,a.keep):a.createAndAddTag(a.keep)},a.hasTags=function(){return a.commonTags&&a.commonTags.length>0},a.showAddTagDropdown=function(){return a.tagFilter.name="",n(null),a.shouldGiveFocus=!0,a.isAddingTag=!0},a.hideAddTagDropdown=function(){return a.isAddingTag=!1},a.onKeydown=function(b){switch(b.keyCode){case f:a.highlightPrev();break;case g:a.highlightNext();break;case h:a.selectTag();break;case i:a.hideAddTagDropdown();break;case j:a.hideAddTagDropdown();break;case k:}},a.removeTagFromSelectedKeeps=function(c){var d=a.getSelectedKeeps().filter(function(a){var b=_.pluck(a.tagList,"id");return _.contains(b,c.id)});b.removeKeepsFromTag(c.id,_.pluck(d,"id"))},c.on("mousedown",".page-coll-opt",function(){a.data.isClickingInList=!0}).on("mouseup",".page-coll-opt",function(){a.data.isClickingInList=!1}),a.blurTagFilter=function(){a.data.isClickingInList||a.hideAddTagDropdown()},a.addTagLabel=function(){return 1===a.getSelectedKeeps().length?"Add a tag to this keep":"Add a tag to these keeps"},a.highlightTag(null)}}}]).directive("kfTagSuggestions",["$timeout",function(a){return function(b,c){a(function(){var a=c.find(".page-coll-opt-hidden"),d=c.find("input");b.$watch("tagFilter.name",function(e){var f=e;b.isAddTagShown()&&(f+=b.newTagLabel),a.html(f);var g=c.parents(".page-coll-list")[0].offsetWidth-20,h=a[0].offsetWidth+10;h>g&&(h=g),d.css("width",h+"px")})})}}]).directive("kfKeepDetail",[function(){function a(a){return a.indexOf("://www.youtube.com/")>-1||a.indexOf("youtu.be/")>-1}function b(a){var b=a.match(c);return b&&2===b.length?b[1]:null}var c=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)[?=&+%\w.-]*/i;return{replace:!0,restrict:"A",templateUrl:"detail/keepDetail.tpl.html",link:function(c){function d(c){if(c){var d=c&&c.url;if(d&&a(d)){var e=b(d);if(e)return c.videoId=e,void(c.isEmbed=!0)}c.isEmbed=!1}}d(c.keep),c.$watch("keep",d)}}}]),angular.module("kifi.friends.friendCard",[]).directive("kfFriendCard",["$log","friendService",function(a,b){return{scope:{friend:"&"},replace:!0,restrict:"A",templateUrl:"friends/friendCard.tpl.html",link:function(a){var c=a.friend();a.name=c.firstName+" "+c.lastName,a.possesive="s"===c.firstName[c.firstName.length-1]?c.firstName+"'":c.firstName+"s",a.mainImage="//djty7jcqog9qu.cloudfront.net/users/"+c.id+"/pics/200/"+c.pictureName,a.friendCount=c.friendCount,a.unfriended=c.unfriended,a.searchFriend=c.searchFriend,a.unfriend=function(){a.showUnfriendConfirm=!0},a.reallyUnfriend=function(){b.unfriend(c.id)},a.unsearchfriend=function(){b.unSearchFriend(c.id)},a.researchfriend=function(){b.reSearchFriend(c.id)}}}}]),angular.module("kifi.friends.friendRequestCard",[]).directive("kfFriendRequestCard",["$log","friendService",function(a,b){return{scope:{request:"&"},replace:!0,restrict:"A",templateUrl:"friends/friendRequestCard.tpl.html",link:function(a){var c=a.request();a.name=c.firstName+" "+c.lastName,a.mainImage="//djty7jcqog9qu.cloudfront.net/users/"+c.id+"/pics/200/"+c.pictureName,a.accept=function(){b.acceptRequest(c.id)},a.ignore=function(){b.ignoreRequest(c.id)}}}}]),angular.module("kifi.friendService",["angulartics","util"]).factory("friendService",["$http","env","$q","routeService","$analytics","Clutch","util",function(a,b,c,d,e,f,g){var h=[],i=[],j=!1,k=!0,l=20,m=0,n=0,o={cacheDuration:2e4},p=new f(function(b){return a.get(d.friends(b,l)).then(function(a){return 0===b&&(h.length=0),k=a.data.friends.length>=l,h.push.apply(h,_.filter(a.data.friends,function(a){return!a.unfriended})),j=!0,n=a.data.total,h})},o),q=new f(function(){return a.get(d.incomingFriendRequests).then(function(a){return g.replaceArrayInPlace(i,a.data),i})},o),r={connectWithKifiUser:function(a){return a},getMore:function(){return r.getKifiFriends(++m)},getKifiFriends:function(a){return p.get(a||0)},getRequests:function(){return q.get()},friends:h,totalFriends:function(){return n},hasMoreFriends:k,friendsHasRequested:j,requests:i,unSearchFriend:function(c){return a.post(b.xhrBase+"/user/"+c+"/exclude",{}).then(function(){p.expireAll(),r.getKifiFriends(),e.eventTrack("user_clicked_page",{action:"hideFriendInSearch"})})},reSearchFriend:function(c){return a.post(b.xhrBase+"/user/"+c+"/include",{}).then(function(){p.expireAll(),r.getKifiFriends(),e.eventTrack("user_clicked_page",{action:"unHideFriendInSearch"})})},acceptRequest:function(c){return a.post(b.xhrBase+"/user/"+c+"/friend",{}).then(function(){p.expireAll(),q.expireAll(),r.getRequests(),r.getKifiFriends(),e.eventTrack("user_clicked_page",{action:"acceptRequest"})})},ignoreRequest:function(c){return a.post(b.xhrBase+"/user/"+c+"/ignoreRequest",{}).then(function(){p.expireAll(),r.getRequests(),e.eventTrack("user_clicked_page",{action:"ignoreRequest"})})},unfriend:function(c){return a.post(b.xhrBase+"/user/"+c+"/unfriend",{}).then(function(){p.expireAll(),r.getKifiFriends(),e.eventTrack("user_clicked_page",{action:"unFriend"})})}};return r}]),angular.module("kifi.friends",["util","kifi.social","kifi.profileService","kifi.routeService","kifi.invite"]).config(["$routeProvider",function(a){a.when("/friends",{templateUrl:"friends/friends.tpl.html"}).when("/friends/requests",{redirectTo:"/friends"}).when("/friends/requests/:network",{redirectTo:"/friends"})}]).controller("FriendsCtrl",["$scope","$window","friendService","socialService",function(a,b,c,d){b.document.title="Kifi • Your Friends on Kifi",a.$watch(d.checkIfRefreshingSocialGraph,function(b){a.isRefreshingSocialGraph=b}),d.checkIfUpdatingGraphs(1),a.requests=c.requests;var e=!0;a.requestsToShow=2,a.requestsToggleText="See all requests",a.toggleRequestExpansion=function(){e=!e,e?(a.requestsToShow=2,a.requestsToggleText="See all requests"):(a.requestsToShow=a.requests.length,a.requestsToggleText="See fewer requests")},a.totalFriends=c.totalFriends,a.friendsScrollDistance="100%",a.isFriendsScrollDisabled=function(){return!c.hasMoreFriends},a.friendsScrollNext=_.throttle(c.getMore,1e3),a.friends=c.friends,a.friendsHasRequested=c.friendsHasRequested,c.getKifiFriends(),c.getRequests()
}]),angular.module("kifi.home",["util","kifi.keepService","kifi.modal"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"home/home.tpl.html",controller:"HomeCtrl"})}]).controller("HomeCtrl",["$scope","tagService","keepService","$q","$timeout","$window",function(a,b,c,d,e,f){c.reset(),f.document.title="Kifi • Your Keeps",a.keepService=c,a.keeps=c.list,a.toggleSelectAll=c.toggleSelectAll,a.isSelectedAll=c.isSelectedAll,a.isMultiChecked=function(){return c.getSelectedLength()>0&&!c.isSelectedAll()},a.isCheckEnabled=function(){return a.keeps.length},a.hasMore=function(){return!c.isEnd()},a.mouseoverCheckAll=!1,a.onMouseoverCheckAll=function(){a.mouseoverCheckAll=!0},a.onMouseoutCheckAll=function(){a.mouseoverCheckAll=!1},a.getSubtitle=function(){if(a.loading)return"Loading...";var b=c.getSubtitle(a.mouseoverCheckAll);if(b)return b;var d=a.keeps.length;switch(d){case 0:return"You have no Keeps";case 1:return"Showing your only Keep";case 2:return"Showing both of your Keeps";default:return c.isEnd()?"Showing all "+d+" of your Keeps":"Showing your "+d+" latest Keeps"}},a.scrollDisabled=!1,a.getNextKeeps=function(){return a.loading?d.when([]):(a.loading=!0,c.getList().then(function(b){return a.loading=!1,c.isEnd()&&(a.scrollDisabled=!0),b}))},a.getNextKeeps()}]),angular.module("kifi.invite.connectionCard",["angularMoment"]).directive("kfConnectionCard",["$window","$http","routeService","inviteService",function(a,b,c,d){return{scope:{friend:"&",refreshScroll:"=",showGenericInviteError:"=",showLinkedinTokenExpiredModal:"=",showLinkedinHitRateLimitModal:"="},replace:!0,restrict:"A",templateUrl:"invite/connectionCard.tpl.html",link:function(e){var f=e.friend(),g=f.fullSocialId.split("/")[0],h=f.fullSocialId.split("/")[1],i=null!=f.lastInvitedAt;if(e.mainImage=null!=f.pictureUrl?f.pictureUrl:"email"===g?"/img/email-icon.png":"https://www.kifi.com/assets/img/ghost.100.png",e.mainLabel=f.name,e.hidden=!1,e.facebook="facebook"===g,e.linkedin="linkedin"===g,e.email="email"===g,e.action=function(){d.invite(g,h).then(function(){e.invited=!0,e.actionText="Resend";var a="Invited just now";"email"===g?(e.byline=h,e.byline2=a):e.byline=a},function(a){"token_expired"===a?e.showLinkedinTokenExpiredModal=!0:"hit_rate_limit_reached"===a?e.showLinkedinHitRateLimitModal=!0:e.showGenericInviteError=!0})},e.closeAction=function(){e.hidden=!0;var a={fullSocialId:f.fullSocialId};b.post(c.blockWtiConnection,a)},i){e.invited=!0,e.actionText="Resend";var j="Invited "+a.moment(new Date(f.lastInvitedAt)).fromNow();"email"===g?(e.byline=h,e.byline2=j):e.byline=j}else e.invited=!1,e.byline="email"===g?h:g.charAt(0).toUpperCase()+g.slice(1),e.actionText="Invite";e.refreshScroll()}}}]),angular.module("kifi.invite",["util","kifi.profileService","kifi.routeService","jun.facebook","kifi.inviteService","kifi.social","kifi.modal"]).config(["$routeProvider",function(a){a.when("/invite",{templateUrl:"invite/invite.tpl.html"}).when("/friends/invite",{redirectTo:"/invite"})}]).controller("InviteCtrl",["$scope","$http","$rootScope","profileService","routeService","$window","wtiService","socialService",function(a,b,c,d,e,f,g,h){f.document.title="Kifi • Invite your friends",a.$watch(h.checkIfRefreshingSocialGraph,function(b){a.isRefreshingSocialGraph=b}),h.checkIfUpdatingGraphs(2),a.whoToInvite=g.list,a.wtiLoaded=!1,a.$watch(function(){return g.list.length||!g.hasMore()},function(b){b&&(a.wtiLoaded=!0)}),a.wtiScrollDistance="100%",a.isWTIScrollDisabled=function(){return!g.hasMore()},a.wtiScrollNext=g.getMore,a.showAddNetworksModal=function(){c.$emit("showGlobalModal","addNetworks")}}]).directive("kfSocialInviteWell",["socialService","$rootScope",function(a,b){return{scope:{},replace:!0,restrict:"A",templateUrl:"invite/inviteWell.tpl.html",link:function(c){c.networks=a.networks,c.$watch(function(){return a.networks.length},function(a){c.networkText=1===a?"1 network connected":a+" networks connected"}),c.data=c.data||{},c.showAddNetworks=function(){b.$emit("showGlobalModal","addNetworks")},a.refresh()}}}]).directive("kfSocialInviteSearch",["inviteService","$document","$log","socialService","$timeout","$rootScope",function(a,b,c,d,e,f){return{scope:{},replace:!0,restrict:"A",templateUrl:"invite/inviteSearch.tpl.html",link:function(g,h){function i(a){g.search.showDropdown&&!h.find(a.target)[0]&&g.$apply(function(){g.search.name="",g.search.showDropdown=!1})}g.search={},g.search.showDropdown=!1,g.data=g.data||{},g.results=[],g.selected=a.socialSelected,g.change=_.debounce(function(){a.socialSearch(g.search.name).then(function(a){var b=_.clone(a),c=_.filter(a,function(a){return a.network&&-1===a.network.indexOf("fortytwo")}).length;g.search.name.length>2&&(a.length<3||3>c)&&b.push({custom:"cant_find"}),g.results=b,g.search.showDropdown=b&&0!==b.length?!0:!1})},200);var j={};g.invite=function(b,d){if(c.log("this person:",b),!j[b.socialId]){j[b.socialId]=!0;var f=angular.element(d.target);f.text("Sending"),f.parent().removeClass("clickable"),"fortytwo"===b.networkType||"fortytwoNF"===b.networkType?a.friendRequest(b.socialId).then(function(){f.text("Sent!"),e(function(){delete j[b.socialId],f.text("Resend"),f.parent().addClass("clickable")},4e3),a.expireSocialSearch()},function(d){c.log("err:",d,b),delete j[b.socialId],f.text("Error. Retry?"),f.parent().addClass("clickable"),a.expireSocialSearch()}):a.invite(b.networkType,b.socialId).then(function(){f.text("Sent!"),e(function(){delete j[b.socialId],f.text("Resend"),f.parent().addClass("clickable")},4e3),a.expireSocialSearch()},function(d){c.log("err:",d,b),delete j[b.socialId],f.text("Error. Retry?"),f.parent().addClass("clickable"),a.expireSocialSearch()})}},g.$on("$destroy",function(){b.off("click",i)}),b.on("click",i),g.refreshFriends=function(){g.data.showCantFindModal=!1,d.refreshSocialGraph()},g.connectNetworks=function(){g.data.showCantFindModal=!1,f.$emit("showGlobalModal","addNetworks")},g.hasNetworks=function(){return!!d.networks.length}}}}]),angular.module("kifi.inviteService",["util","kifi.clutch","angulartics"]).factory("inviteService",["$http","env","$q","routeService","util","Clutch","$window","$log","$analytics","$FB",function(a,b,c,d,e,f,g,h,i,j){function k(a){a.socialId=a.value.split("/").splice(1).join("");var b=a.label.trim();if(a.label=b?b:a.socialId,a.network="email"===a.networkType?a.socialId:p[a.networkType]||a.networkType,a.iconStyle="kf-"+a.networkType+"-icon-micro",("fortytwo"===a.networkType||"fortytwoNF"===a.networkType)&&(a.image=d.formatPicUrl(a.socialId,a.image)),"invited"===a.status){var c=g.moment(new Date(a.inviteLastSentAt)).fromNow();a.inviteText=c}return a}function l(a,b){if(a.indexOf("@")>0){var c=b[b.length-1];if(c&&c.custom){if(c.label===a)return;b.pop()}var d=_.find(b,function(b){return"email"===b.networkType&&b.value.split("/").splice(1).join("")===a});d||(r.socialId=a,r.label=a,r.network=a,r.value="email/"+a,b.push(k(r)))}}j.getLoginStatus();var m,n,o=[],p={facebook:"Facebook",linkedin:"LinkedIn"},q=new f(function(b){return b&&b.trim()?a.get(d.socialSearch(b)).then(function(a){var b=a.data;return _.forEach(b,k),i.eventTrack("user_clicked_page",{action:"searchContacts"}),b}):c.when([])}),r={custom:"email",iconStyle:"kf-email-icon-micro",networkType:"email",status:""},s={socialSearch:function(a){return n=a,l(a,o),q.get(a).then(function(a){return l(n,a),e.replaceArrayInPlace(o,a),m=0===a.length?null:a[0].value,a})},expireSocialSearch:function(){q.expireAll()},inviteList:o,socialSelected:m,invite:function(b,e){function f(){a.post(d.invite,{id:b+"/"+e}).then(function(a){i.eventTrack("user_clicked_page",{action:"inviteFriend",platform:b}),a.data.url&&"facebook"===b?(j.ui({method:"send",link:g.unescape(a.data.url),to:e}),k.resolve("")):a.data.error?(h.log(a.data.error),k.reject("linkedin_error_{401}"===a.data.error.code?"token_expired":"linkedin_error_{403}"===a.data.error.code?"hit_rate_limit_reached":"generic_error")):k.resolve("")},function(a){throw h.log(a),a})}q.expireAll();var k=c.defer();return"facebook"===b?j.FB.getAuthResponse()?f():j.FB.login(function(a){a.authResponse&&f()}):("fortytwoNF"===b&&(b="fortytwo"),f()),k.promise},friendRequest:function(b){return a.post(d.friendRequest(b)).then(function(a){return a.data})}};return s}]),angular.module("kifi.invite.wtiService",["kifi.clutch"]).factory("wtiService",["$http","routeService","Clutch","$q",function(a,b,c,d){var e=[],f=!0,g=0,h=new c(function(c){return a.get(b.whoToInvite+"?page="+c).then(function(a){return 0===a.data.length?f=!1:(g++,e.push.apply(e,a.data)),a.data})}),i={getMore:function(){return h.get(g)},hasMore:function(){return f},loadInitial:function(){e.length=0,g=0,f=!0,h.expireAll();var a=i.getMore();return a.then(function(){return i.getMore()}),e.length>0?d.when(e):a},list:e};return i}]),angular.module("kifi.addKeeps",["kifi.profileService"]).directive("kfAddKeepsModal",[function(){return{replace:!0,restrict:"A",templateUrl:"keep/addKeepsModal.tpl.html",scope:{data:"="},link:function(){}}}]),angular.module("kifi.keep",["kifi.keepWhoPics","kifi.keepWhoText","kifi.tagService"]).controller("KeepCtrl",["$scope",function(a){function b(b){if(b&&b.length)for(var c=0,d=b.length;d>c;c++)if(a.isExampleTag(b[c]))return!0;return!1}a.isMyBookmark=function(a){return a.isMyBookmark||!1},a.isPrivate=function(a){return a.isPrivate||!1},a.isExampleTag=function(a){return"example keep"===(a&&a.name&&a.name.toLowerCase())},a.isExample=function(c){return null==c.isExample&&(c.isExample=b(a.getTags())),c.isExample}}]).directive("kfKeep",["$document","$rootElement","tagService","util",function(a,b,c,d){return{restrict:"A",scope:{keep:"=",me:"=",toggleSelect:"&",isPreviewed:"&",isSelected:"&",clickAction:"&",dragKeeps:"&",stopDraggingKeeps:"&"},controller:"KeepCtrl",replace:!0,templateUrl:"keep/keep.tpl.html",link:function(b,e){function f(a,b){m.href=a;var c=m.hostname,d=a.indexOf(c),e=c.match(n);e&&(d+=e.index,c=e[0]);var f=m.pathname,h=a.indexOf(f,d+c.length),i=f.match(o);i&&(h+=i.index,f=i[0]),f=f.replace(p," ").trimRight();for(var j=b&&b.length;j--;){var k=b[j],l=k[0],q=k[1];l>=h&&l<h+f.length?f=g(f,l-h,q):l>=d&&l<d+c.length&&(c=g(c,l-d,q))}return f=f.trimLeft(),c+(f?" · "+f:"")}function g(a,b,c){return a.substr(0,b)+"<b>"+a.substr(b,c)+"</b>"+a.substr(b+c)}function h(a){return a.title||f(a.url)}function i(a,b){var c=(a.match(q)||[""])[0].length;a=a.substr(c).replace(r,"$1");for(var d=b&&b.length;d--;)b[d][0]-=c;return j(a,b)}function j(a,b){for(var c=b&&b.length;c--;){var d=b[c],e=d[0];e>=0&&(a=g(a,e,d[1]))}return a}function k(){b.keep.titleHtml=h(b.keep)}function l(){b.keep.descHtml=i(b.keep.url)}b.getTags=function(){return b.keep.tagList};var m=a[0].createElement("a"),n=/[^.\/]+(?:\.[^.\/]{1,3})?\.[^.\/]+$/,o=/[^\/]+?(?=(?:\.[a-zA-Z0-9]{1,6}|\/|)$)/,p=/[\/._-]/g,q=/^https?:\/\//,r=/^([^\/]*)\/$/;k(),l(),b.$watchCollection(function(){return{mine:b.isMyBookmark(b.keep),example:b.isExample(b.keep),"private":b.isPrivate(b.keep),detailed:b.isPreviewed({keep:b.keep}),selected:!!b.isSelected({keep:b.keep})}},function(a){_.forOwn(a,function(a,b){a&&!e.hasClass(b)?e.addClass(b):!a&&e.hasClass(b)&&e.removeClass(b)})}),b.$watch("keep.title",function(){k()}),b.$watch("keep.url",function(){k(),l()}),b.getTitle=function(){var a=b.keep;return a.title||a.url},b.getName=function(a){return[a.firstName,a.firstName].filter(function(a){return!!a}).join(" ")},b.hasKeepers=function(){var a=b.keep;return!(!a.keepers||!a.keepers.length)},b.showOthers=function(){return!b.hasKeepers()&&!!b.keep.others},b.onCheck=function(a){return a.stopPropagation(),b.toggleSelect()};var s=e.find(".kf-drag-mask");b.isDragTarget=!1,b.onTagDrop=function(a){c.addKeepToTag(a,b.keep),b.isDragTarget=!1},s.on("dragenter",function(){b.$apply(function(){b.isDragTarget=!0})}),s.on("dragleave",function(){b.$apply(function(){b.isDragTarget=!1})}),b.isDragging=!1;var t,u;e.on("mousemove",function(a){t=a.pageX-d.offset(e).left,u=a.pageY-d.offset(e).top}),e.on("dragstart",function(a){b.$apply(function(){e.addClass("kf-dragged"),b.dragKeeps({keep:b.keep,event:a,mouseX:t,mouseY:u}),b.isDragging=!0})}),e.on("dragend",function(){b.$apply(function(){e.removeClass("kf-dragged"),b.stopDraggingKeeps(),b.isDragging=!1})})}}}]),angular.module("kifi.keepService",["kifi.undo","kifi.clutch","angulartics"]).factory("keepService",["$http","env","$q","$timeout","$document","$rootScope","undoService","$log","Clutch","$analytics","routeService","$location",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){return Math.random().toString(16).slice(2)}function n(a){a&&a.length&&J.fetchScreenshotUrls(a).then(function(b){_.forEach(a,function(a){a.screenshot=b[a.url]})})}function o(e){if(e&&e.length){var f=b.xhrBase+"/keeps/screenshot",g={urls:_.pluck(e,"url")};return h.log("keepService.lookupScreenshotUrls()",g),a.post(f,g).then(function(a){return d(function(){J.prefetchImages(a.data.urls)}),a.data.urls})}return c.when(e||[])}function p(a){_.extend(a,a.bookmark),a.keepers=a.users,a.others=a.count-a.users.length-(a.isMyBookmark&&!a.isPrivate?1:0)}function q(a){if(!a)return-1;for(var b=a.id,c=0,d=u.length;d>c;c++){if(b&&u[c].id===b)return c;if(!b&&u[c]===a)return c}return-1}function r(a){if(!a.conversationUpdatedAt)return!0;var b=(new Date).getTime()-a.conversationUpdatedAt.getTime();return b/1e3>15}function s(a){var b=c.defer();if(a){var d=new XMLHttpRequest;d.withCredentials=!0,d.upload.addEventListener("progress",function(a){b.notify({name:"progress",event:a})}),d.addEventListener("load",function(){b.resolve(JSON.parse(d.responseText))}),d.addEventListener("loadend",function(a){b.notify({name:"loadend",event:a})}),d.open("POST",k.uploadBookmarkFile,!0),d.send(a)}else b.reject({error:"no file"});return b.promise}var t,u=[],v=null,w=m(),x=-1,y={},z=null,A=!1,B=null,C=30,D=!1,E=!1,F={},G=e[0],H=!1;f.$on("tags.remove",function(a){_.forEach(u,function(b){b.tagList&&(b.tagList=b.tagList.filter(function(c){return c.id===a?(b.removedTagList||(b.removedTagList=[]),b.removedTagList.push(c),!1):!0}))})}),f.$on("tags.unremove",function(a){_.forEach(u,function(b){b.removedTagList&&b.removedTagList.filter(function(c){return c.id===a?(b.tagList||(b.tagList=[]),b.tagList.push(c),!1):!0})})}),f.$on("tags.removeFromKeep",function(a,b){var c=b.tagId,d=b.keepId;_.forEach(u,function(a){a.id===d&&a.tagList&&(a.tagList=a.tagList.filter(function(a){return a.id!==c}))})}),f.$on("tags.addToKeep",function(a,b){var c=b.tag,d=b.keep.id;_.forEach(u,function(a){if(a.isMyBookmark=!0,a.id===d&&a.tagList){var b=_.find(a.tagList,function(a){return a.id===c.id});b||a.tagList.push(c)}})});var I=new i(function(b,c){return h.log("keepService.getList()",c&&c.params),a.get(b,c).then(function(a){var b=a.data,c=b.keeps||[];return _.forEach(c,function(a){a.isMyBookmark=!0}),n(c),{keeps:c,before:b.before}})}),J={list:u,totalKeepCount:0,lastSearchContext:function(){return v},isDetailOpen:function(){return D},isSingleKeep:function(){return E},getPreviewed:function(){return B||null},isPreviewed:function(a){return!!B&&B===a},getHighlighted:function(){return u[t]},preview:function(a){null==a?J.clearState():(E=!0,D=!0);var b=q(a);return t=b>=0?b:t||0,B=a,J.getChatter(B),j.eventTrack("user_clicked_page",{action:"preview",selectedIdx:t}),a},togglePreview:function(a){return J.isPreviewed(a)&&_.size(y)>1?(B=null,D=!0,E=!1,null):J.isPreviewed(a)?J.clearState():J.preview(a)},previewNext:_.throttle(function(){t=t||0;var a;u.length-1>t?(a=u[t+1],t++):(a=u[0],t=0),J.togglePreview(a)},150),previewPrev:_.throttle(function(){t=t||0;var a;t>0?(a=u[t-1],t--):(a=u[0],t=0),J.isPreviewed(a)||J.togglePreview(a)},150),isSelected:function(a){return a&&a.id&&!!y[a.id]},select:function(a){var b=a.id;return b?(D=!0,y[b]=a,1===_.size(y)?J.preview(a):(B=null,E=!1),t=q(a),!0):!1},unselect:function(a){var b=a.id;if(b){delete y[b];var c=_.size(y);if(0===c&&D===!0)J.preview(a),t=q(a);else if(1===c&&D===!0){var d=J.getFirstSelected();t=q(d),J.preview(d)}else B=null,E=!1;return!0}return!1},toggleSelect:function(a){if(void 0===a){if(B)return J.toggleSelect(B);if(t>=0)return J.toggleSelect(u[t])}else{if(J.isSelected(a))return J.unselect(a);if(a)return J.select(a)}},getFirstSelected:function(){return _.values(y)[0]},getSelectedLength:function(){return _.keys(y).length},getSelected:function(){return u.filter(function(a){return a.id in y})},selectAll:function(){y=_.reduce(u,function(a,b){return a[b.id]=!0,a},{}),0===u.length?J.clearState():1===u.length?J.preview(u[0]):(B=null,D=!0,E=!1)},unselectAll:function(){y={},J.clearState()},clearState:function(){D=!1,d(function(){D===!1&&(B=null,E=!1)},400)},isSelectedAll:function(){return u.length&&u.length===J.getSelectedLength()},toggleSelectAll:function(){return J.isSelectedAll()?J.unselectAll():J.selectAll()},reset:function(){h.log("keepService.reset()"),w=m(),v=null,x=-1,z=null,A=!1,u.length=0,y={},J.unselectAll()},getList:function(a){if(A)return c.when([]);var d=b.xhrBase+"/keeps/all";a=a||{},a.count=a.count||C,a.before=z||void 0;var e={params:a};return I.get(d,e).then(function(b){var c=b.keeps,d=b.before;return(!c.length||c.length<a.count-1)&&(A=!0),d||(u.length=0),u.push.apply(u,c),z=u.length?u[u.length-1].id:null,c})},joinTags:function(a,b){var c=_.reduce(b,function(a,b){return b&&b.id&&(a[b.id]=b),a},{});_.forEach(a,function(a){a.tagList=_.map(a.collections||a.tags,function(a){return c[a]||null}).filter(function(a){return null!=a})})},getChatter:function(d){if(d&&d.url&&r(d)){var e=b.xhrBaseEliza+"/chatter",f={url:d.url};return h.log("keepService.getChatter()",f),a.post(e,f).then(function(a){var b=a.data;return d.conversationCount=b.threads,d.conversationUpdatedAt=new Date,b})}return c.when({threads:0})},fetchScreenshotUrls:function(a){var b=H&&d.cancel(H);return b?(H=d(angular.noop,1e3),H.then(function(){return o(a)})):(H=d(angular.noop,1e3),o(a))},prefetchImages:function(a){_.forEach(a,function(a,b){b in F||!a||(F[b]=a,G.createElement("img").src=a)})},keep:function(d,e){if(!d||!d.length)return c.when(d||[]);var f=null==e;e=!!e;var g=b.xhrBase+"/keeps/add",i={keeps:d.map(function(a){return{title:a.title,url:a.url,isPrivate:f?!!a.isPrivate:e}})};return h.log("keepService.keep()",i),a.post(g,i).then(function(){return _.forEach(d,function(a){a.isMyBookmark=!0,a.isPrivate=f?!!a.isPrivate:e,a.unkept=!1}),j.eventTrack("user_clicked_page",{action:"keep"}),d})},unkeep:function(b){if(!b||!b.length)return c.when(b||[]);var d,e;return 1===b.length&&b[0].id?(d=k.removeSingleKeep(b[0].id),e={}):(d=k.removeKeeps,e=_.map(b,function(a){return{url:a.url}})),h.log("keepService.unkeep()",d,e),a.post(d,e).then(function(){_.forEach(b,function(a){a.unkept=!0,a.isMyBookmark=!1,B===a&&J.togglePreview(a),J.isSelected(a)&&J.unselect(a)});var a=b.length>1?b.length+" Keeps deleted.":"Keep deleted.";return g.add(a,function(){J.keep(b)}),j.eventTrack("user_clicked_page",{action:"unkeep"}),b})},toggleKeep:function(a,b){var c=_.every(a,"isMyBookmark");return b=null==b?_.some(a,"isPrivate"):!!b,c?J.unkeep(a):J.keep(a,b)},togglePrivate:function(a){return J.keep(a,!_.every(a,"isPrivate"))},isEnd:function(){return!!A},getSubtitle:function(a){var b=J.getSelectedLength(),c=u.length;if(a)return b===c?"Deselect all "+c+" Keeps below":"Select all "+c+" Keeps below";switch(b){case 0:return null;case 1:return b+" Keep selected";default:return b+" Keeps selected"}},uploadBookmarkFile:s,find:function(b,d,e){if(A)return c.when([]);var f=k.search,g={params:{q:b||void 0,f:d||"m",maxHits:30,context:e||void 0}};return h.log("keepService.find() req",g),a.get(f,g).then(function(a){var b=a.data,c=b.hits||[];return h.log("keepService.find() res",b),b.mayHaveMore||(A=!0),j.eventTrack("user_clicked_page",{action:"searchKifi",hits:c.size,mayHaveMore:b.mayHaveMore}),_.forEach(c,p),u.push.apply(u,c),n(c),x++,v={origin:l.origin,uuid:a.data.uuid,experimentId:a.data.experimentId,query:g.params.q,filter:g.params.f,maxResults:g.params.maxHits,kifiTime:null,kifiShownTime:null,kifiResultsClicked:null,refinements:x,pageSession:w},b})},getKeepsByTagId:function(a,b){return b=b||{},b.collection=a,J.getList(b)}};return J}]),angular.module("kifi.keeps",["kifi.profileService","kifi.keepService"]).controller("KeepsCtrl",["$scope","profileService","keepService","tagService",function(a,b,c,d){a.me=b.me,a.data={draggedKeeps:null},a.$watch(function(){return(a.keeps&&a.keeps.length||0)+","+d.allTags.length},function(){a.refreshScroll(),a.keeps&&a.keeps.length&&d.allTags.length&&c.joinTags(a.keeps,d.allTags)}),a.dragKeeps=function(b,d,e,f){var g=c.getSelected();0===g.length&&(g=[b]),a.data.draggedKeeps=g;var h=a.getDraggedKeepsElement(),i=angular.toJson(a.data.draggedKeeps);d.dataTransfer.setData("Text",i),d.dataTransfer.setDragImage(h[0],e,f)},a.stopDraggingKeeps=function(){a.data.draggedKeeps=null}}]).directive("kfKeeps",["keepService","$document","$log",function(a,b,c){return{restrict:"A",scope:{keeps:"=",keepsLoading:"=",keepsHasMore:"=",keepClick:"=",scrollDistance:"=",scrollDisabled:"=",scrollNext:"&"},controller:"KeepsCtrl",templateUrl:"keeps/keeps.tpl.html",link:function(d,e){function f(){var a=e.find(".detailed"),b=a.offset();b&&b.top&&b.top-300<0&&i.scrollTop(i.scrollTop()+(b.top-300))}function g(){var a=e.find(".detailed"),b=a.offset();if(b&&b.top){var c=j.height();b.top+100>c&&i.scrollTop(i.scrollTop()+(b.top+100-c))}}function h(b){var e=b&&(b.shiftKey||b.altKey||b.ctrlKey||b.metaKey);if(b&&!e&&b.currentTarget&&b.currentTarget.activeElement&&"BODY"===b.currentTarget.activeElement.tagName){var h=!1;switch(b.which){case 13:var i=a.getHighlighted();a.togglePreview(i),h=!0;break;case 27:a.isDetailOpen()&&(a.clearState(),h=!0);break;case 38:case 75:a.previewPrev(),f(),h=!0;break;case 40:case 74:a.previewNext(),g(),h=!0;break;case 32:a.toggleSelect(),h=!0}h?(d.$apply(),b.preventDefault()):c.log("key",String.fromCharCode(b.which),b.which)}}d.select=a.select,d.unselect=a.unselect,d.toggleSelect=a.toggleSelect,d.isSelected=a.isSelected,d.preview=a.preview,d.togglePreview=a.togglePreview,d.isPreviewed=a.isPreviewed;var i=e.find(".antiscroll-inner"),j=e.find(".keeps-wrapper");b.on("keydown",h),d.$on("$destroy",function(){a.clearState(),b.off("keydown",h)}),d.isShowMore=function(){return!d.keepsLoading&&d.keepsHasMore},d.onClickKeep=function(a,b){"A"!==b.target.tagName?b.ctrlKey||b.metaKey?d.isSelected(a)?d.unselect(a):d.select(a):d.togglePreview(a):d.keepClick&&d.keepClick(a,b)},d.isScrollDisabled=function(){return d.scrollDisabled},null==d.scrollDistance&&(d.scrollDistance="100%"),d.getDraggedKeepsElement=function(){var a=e.find(".kf-shadow-keep-ellipsis"),b=e.find(".kf-shadow-keep-ellipsis-counter"),c=e.find(".kf-shadow-keep-ellipsis-counter-hidden"),f=e.find(".kf-shadow-keep-second"),g=e.find(".kf-shadow-keep-last"),h=35,i=28;return 2===d.data.draggedKeeps.length?g.css({top:h+"px"}):3===d.data.draggedKeeps.length?(f.css({top:h+"px"}),g.css({top:2*h+"px"})):d.data.draggedKeeps.length>=4&&(a.css({top:h+"px",height:i+"px"}),b.css({left:(parseInt(a.width(),10)-parseInt(c.width(),10))/2}),g.css({top:h+i+"px"})),e.find(".kf-shadow-dragged-keeps")};var k=e.find(".kf-shadow-dragged-keeps");k.css({top:0,width:e.find(".kf-my-keeps")[0].offsetWidth+"px"})}}}]),angular.module("kifi.layout.leftCol",[]).controller("LeftColCtrl",["$scope","$element","$window","$timeout",function(a,b,c,d){var e=_.throttle(function(){b.css("height",c.innerHeight+"px")},100);angular.element(c).resize(e),d(e)}]),angular.module("kifi.layout.main",["kifi.undo","angulartics"]).controller("MainCtrl",["$scope","$element","$window","$location","$timeout","$rootElement","undoService","keyIndices","injectedState","$rootScope","$analytics","keepService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){var b=a.search.text||"";b=_.str.trim(b),b?d.path("/find").search("q",b):d.path("/").search(""),e(function(){a.$apply()})}function n(b){if(b)if(b.m&&"1"===b.m)a.data.showEmailModal=!0,a.modal="email";else if(b.m){var c=r[b.m];a.tooltipMessage=c,e(function(){delete a.tooltipMessage},5e3)}}function o(b,c){a.modal="import_bookmarks",a.data.showImportModal=!0,a.msgEvent=c&&c.origin&&c.source&&c||!1}function p(){a.modal="import_bookmark_file",a.data.showBookmarkFileModal1=!0}a.search={},a.data=a.data||{},a.isEmpty=function(){return!a.search.text},a.onKeydown=function(b){b.keyCode===h.KEY_ESC?a.clear():b.keyCode===h.KEY_ENTER&&m()},a.onFocus=function(){a.focus=!0},a.onBlur=function(){a.focus=!1},a.clear=function(){a.search.text="",m()},a.onChange=_.debounce(m,350),a.$on("$routeChangeSuccess",function(b,c,d){d&&c&&"SearchCtrl"===d.controller&&"SearchCtrl"!==c.controller&&(a.search.text="")}),a.undo=g;var q=_.throttle(function(){b.css("height",c.innerHeight+"px")},100);angular.element(c).resize(q),e(q);var r={0:"Welcome back!",2:"Bookmark import in progress. Reload the page to update."};n(i.state),j.$on("showGlobalModal",function(b,c){switch(c){case"addNetworks":a.modal="add_networks",a.data.showAddNetworks=!0;break;case"importBookmarks":o.apply(null,Array.prototype.slice(arguments,2));break;case"importBookmarkFile":p();break;case"addKeeps":a.modal="add_keeps",a.data.showAddKeeps=!0}}),a.importBookmarks=function(){a.data.showImportModal=!1;var b=c.document.getElementsByTagName("html")[0].getAttribute("data-kifi-ext");if(!b)return a.modal="import_bookmarks_error",void(a.data.showImportError=!0);k.eventTrack("user_clicked_page",{action:"bookmarkImport"});var d=a.msgEvent&&a.msgEvent.origin&&a.msgEvent.source&&a.msgEvent;d?d.source.postMessage("import_bookmarks",a.msgEvent.origin):c.postMessage("import_bookmarks","*"),a.modal="import_bookmarks2",a.data.showImportModal2=!0},a.cancelImport=function(){c.postMessage("import_bookmarks_declined","*"),a.data.showImportModal=!1},a.disableBookmarkImport=!0,a.allowUpload=function(b){var c=b&&b.files&&b.files[0];c&&-1!==c.name.indexOf(".html",c.name.length-5)?(a.importFilename=c.name,a.disableBookmarkImport=!1,a.importFileStatus=""):(a.importFilename="",a.disableBookmarkImport=!0,a.importFileStatus="Invalid bookmark file (*.html). Try picking it again.")},a.openExportPopup=function(a){var b=angular.element(a.target)[0].href;return c.open(b,"","menubar=no,location=yes,resizable=yes,scrollbars=yes,status=no,width=1000,height=500"),a.preventDefault(),!1},a.uploadBookmarkFile=function(b){if(!a.disableBookmarkImport){var c=angular.element(b.target).parent().parent().find("input:file"),d=c&&c[0]&&c[0].files&&c[0].files[0];if(d){a.disableBookmarkImport=!0;var f=e(function(){a.disableBookmarkImport=!1,a.importFileStatus="Looks like we were too slow uploading your bookmarks. Try again?"},5e4);a.importFileStatus="Uploading! May take a bit, especially if you have a lot links.",a.importFilename="",l.uploadBookmarkFile(d).then(function(b){e.cancel(f),a.importFileStatus="",b.error?(a.modal="import_bookmarks_error",a.data.showBookmarkFileModal1=!1,a.data.showBookmarkFileError=!0,a.modal="import_bookmark_error"):(a.data.showBookmarkFileModal1=!1,a.data.showBookmarkFileModal2=!0,a.modal="import_bookmark_file2")})}else a.importFileStatus="Hm, couldn't upload your file. Try picking it again."}},a.cancelBookmarkUpload=function(){a.disableBookmarkImport=!0,a.modal="",a.importFilename="",a.importFileStatus=""},a.openBookmarkFileSelector=function(a){var b=angular.element(a.target).parent().parent().find("input:file");e(function(){b.click()})},/^Mac/.test(c.navigator.platform)&&f.find("body").addClass("mac")}]),angular.module("kifi.layout.nav",["util"]).directive("kfNav",["$location","util","keepService","friendService",function(a,b,c,d){return{restrict:"A",templateUrl:"layout/nav/nav.tpl.html",link:function(e){e.counts={keepCount:c.totalKeepCount,friendsCount:d.totalFriends(),friendsNotifCount:d.requests.length},e.$watch(function(){return d.requests.length},function(a){e.counts.friendsNotifCount=a}),e.$watch(d.totalFriends,function(a){e.counts.friendsCount=a}),e.$watch(function(){return c.totalKeepCount},function(a){e.counts.keepCount=a}),e.isActive=function(c){var d=a.path();return d===c||b.startsWith(d,c+"/")}}}}]),angular.module("kifi.layout.rightCol",["kifi.modal"]).controller("RightColCtrl",["$scope","$element","$window","profileService","$q","$http","env","$timeout","installService","$rootScope",function(a,b,c,d,e,f,g,h,i,j){a.data=a.data||{},a.installInProgress=function(){return i.installInProgress},a.installed=function(){return i.installed},a.installError=function(){return i.error},a.triggerInstall=function(){i.triggerInstall(function(){a.data.showInstallErrorModal=!0})},c.getMe=function(){return(d.me?e.when(d.me):d.getMe()).then(function(a){return a.pic200=a.picUrl,a})},c.exitOnboarding=function(){a.data.showGettingStarted=!1,f.post(g.xhrBase+"/user/prefs",{onboarding_seen:"true"}),d.prefs.onboarding_seen||a.importBookmarks(),a.$apply()},j.$on("showGettingStarted",function(){a.data.showGettingStarted=!0}),a.importBookmarks=function(){var a=c.document.getElementsByTagName("html")[0].getAttribute("data-kifi-ext");a&&j.$emit("showGlobalModal","importBookmarks")},a.importBookmarkFile=function(){j.$emit("showGlobalModal","importBookmarkFile")},c.addEventListener("message",function(a){a.data&&a.data.bookmarkCount>0&&j.$emit("showGlobalModal","importBookmarks",a.data.bookmarkCount,a)}),a.logout=function(){d.logout()};var k=_.throttle(function(){b.css("height",c.innerHeight+"px")},100);angular.element(c).resize(k),h(k)}]),angular.module("kifi.profile",["util","kifi.profileService","kifi.profileInput","kifi.routeService","kifi.profileEmailAddresses","kifi.profileChangePassword","kifi.profileImage","jun.facebook","angulartics"]).config(["$routeProvider",function(a){a.when("/profile",{templateUrl:"profile/profile.tpl.html",controller:"ProfileCtrl"})}]).controller("ProfileCtrl",["$scope","$http","profileService","routeService","$window","socialService",function(a,b,c,d,e,f){function g(b){a.emailForVerification=b,a.showResendVerificationEmailDialog.value=!0}function h(a){return b({url:d.emailInfoUrl,method:"GET",params:{email:a}})}function i(b,d){return d.isPrimary||d.isPendingPrimary?void c.fetchMe():d.isVerified?c.setNewPrimaryEmail(a.me,d.address):(k=b,a.showEmailChangeDialog.value=!0,c.successInputActionResult())}function j(a,b){return"available"!==b.status?c.failureInputActionResult("This email address is already added","Please use another email address."):(c.addEmailAccount(a),void g(a))}e.document.title="Kifi • Your Profile",f.refresh(),a.showEmailChangeDialog={value:!1},a.showResendVerificationEmailDialog={value:!1},c.getMe().then(function(b){a.me=b}),a.descInput={},a.$watch("me.description",function(b){a.descInput.value=b||""}),a.emailInput={},a.$watch("me.primaryEmail.address",function(b){a.emailInput.value=b||""}),a.addEmailInput={},a.saveDescription=function(a){c.postMe({description:a})},a.validateEmail=function(a){return c.validateEmailFormat(a)},a.saveEmail=function(b){return a.me&&a.me.primaryEmail.address===b?c.successInputActionResult():h(b).then(function(a){return i(b,a.data)},function(a){return c.getEmailValidationError(a.status)})},a.addEmail=function(a){return h(a).then(function(b){return j(a,b.data)},function(a){return c.getEmailValidationError(a.status)})},a.isUnverified=function(a){return a.value&&!a.value.isPendingPrimary&&a.value.isPrimary&&!a.value.isVerified},a.resendVerificationEmail=function(b){!b&&a.me&&a.me.primaryEmail&&(b=a.me.primaryEmail.address),g(b),c.resendVerificationEmail(b)},a.cancelPendingPrimary=function(){c.cancelPendingPrimary()};var k;a.cancelSaveEmail=function(){a.emailInput.value=a.me.primaryEmail.address},a.confirmSaveEmail=function(){c.setNewPrimaryEmail(k)}}]).directive("kfLinkedinConnectButton",["socialService",function(a){return{restrict:"A",link:function(b){b.isLinkedInConnected=a.linkedin&&!!a.linkedin.profileUrl,b.linkedin=a.linkedin,b.$watch(function(){return a.linkedin&&a.linkedin.profileUrl},function(){var c=a.linkedin;c&&c.profileUrl?(b.isLinkedInConnected=!0,b.liProfileUrl=c.profileUrl):(b.isLinkedInConnected=!1,b.liProfileUrl="")}),b.connectLinkedIn=a.connectLinkedIn,b.disconnectLinkedIn=a.disconnectLinkedIn}}}]).directive("kfFacebookConnectButton",["socialService",function(a){return{restrict:"A",link:function(b){b.isFacebookConnected=a.facebook&&!!a.facebook.profileUrl,b.facebook=a.facebook,b.$watch(function(){return a.facebook&&a.facebook.profileUrl
},function(){var c=a.facebook;c&&c.profileUrl?(b.isFacebookConnected=!0,b.fbProfileUrl=c.profileUrl):(b.isFacebookConnected=!1,b.fbProfileUrl="")}),b.connectFacebook=a.connectFacebook,b.disconnectFacebook=a.disconnectFacebook}}}]).directive("kfEmailImport",["profileService","$window","env","socialService",function(a,b,c,d){return{restrict:"A",replace:!0,scope:{},templateUrl:"profile/emailImport.tpl.html",link:function(a){a.addressBookImportText="Import a Gmail account",d.refresh().then(function(){a.addressBooks=d.addressBooks,d.addressBooks&&d.addressBooks.length>0&&(a.addressBookImportText="Import another Gmail account")}),a.importGmailContacts=function(){b.location=d.importGmail()}}}}]),angular.module("kifi.profileChangePassword",["util","kifi.profileService"]).directive("kfProfileChangePassword",["profileService","keyIndices",function(a,b){return{restrict:"A",scope:{},templateUrl:"profile/profileChangePassword.tpl.html",link:function(c,d){c.isOpen=!1,c.inputs={oldPassword:"",newPassword1:"",newPassword2:""},c.toggle=function(){c.isOpen=!c.isOpen,c.isOpen&&(c.successMessage="")},d.find("input").on("keydown",function(a){switch(a.which){case b.KEY_ESC:this.blur();break;case b.KEY_ENTER:c.$apply(c.updatePassword)}}),c.updatePassword=function(){c.successMessage="",c.inputs.oldPassword.length<7?c.errorMessage="Your current password is not correct.":c.inputs.newPassword1!==c.inputs.newPassword2?c.errorMessage="Your new passwords do not match.":c.inputs.newPassword1.length<7?c.errorMessage="Your password needs to be longer than 7 characters.":c.inputs.oldPassword===c.inputs.newPassword1?c.errorMessage="Your new password needs to be different from your current one.":(c.errorMessage="",a.sendChangePassword(c.inputs.oldPassword,c.inputs.newPassword1).then(function(){c.successMessage="Password updated!",c.inputs={},c.toggle()},function(a){c.errorMessage="bad_old_password"===a.data.error?"Your current password is not correct.":"bad_new_password"===a.data.error?"Your password needs to be longer than 7 characters.":"An error occured. Try again?"}))}}}}]),angular.module("kifi.profileEmailAddresses",["util","kifi.profileService"]).directive("kfProfileEmailAddresses",["$document","keyIndices","profileService",function(a,b,c){return{restrict:"A",scope:{state:"=inputState",emailList:"=",validateEmailAction:"&",addEmailAction:"&",resendVerificationEmailAction:"&"},templateUrl:"profile/profileEmailAddresses.tpl.html",link:function(d,e){function f(){d.$apply(function(){d.emailWithActiveDropdown=null}),a.unbind("click",f)}d.isOpen=!1,d.emailWithActiveDropdown=null,d.showEmailDeleteDialog={},d.emailToBeDeleted=null,d.toggle=function(){d.isOpen=!d.isOpen},d.enableAddEmail=function(){d.state.editing=!0},d.validateEmail=function(a){return d.validateEmailAction({value:a})},d.addEmail=function(a){return d.addEmailAction({value:a})},d.resendVerificationEmail=function(a){return d.resendVerificationEmailAction({value:a})},d.openDropdownForEmail=function(b,c){d.emailWithActiveDropdown!==c&&(d.emailWithActiveDropdown=c,b.stopPropagation(),a.bind("click",f))},d.deleteEmail=function(a){d.emailToBeDeleted=a,d.showEmailDeleteDialog.value=!0},d.confirmDeleteEmail=function(){c.deleteEmailAccount(d.emailToBeDeleted)},d.makePrimary=function(a){c.makePrimary(a)},e.find("input").on("keydown",function(a){switch(a.which){case b.KEY_ESC:d.$apply(d.cancelAddEmail);break;case b.KEY_ENTER:d.$apply(d.addEmail)}})}}}]),angular.module("kifi.profileImage",["angulartics"]).directive("kfProfileImage",["$document","$timeout","$compile","$templateCache","$window","$q","$http","env","profileService","$analytics",function(a,b,c,d,e,f,g,h,i,j){return{restrict:"A",replace:!0,scope:{picUrl:"="},templateUrl:"profile/profileImage.tpl.html",link:function(c,d){function k(){if(D){var a=Math.pow(c.zoomSlider.value/c.zoomSlider.max,2);B.currentWidth=B.minimumWidth+a*(B.maximumWidth-B.minimumWidth),B.currentHeight=B.minimumHeight+a*(B.maximumHeight-B.minimumHeight),G.css({backgroundSize:B.currentWidth+"px "+B.currentHeight+"px"}),o(),m()}}function l(a,b,c){return a>b?b:c>a?c:a}function m(){G.css({backgroundPosition:B.currentLeft+"px "+B.currentTop+"px"})}function n(a,b){B.currentLeft=l(a,A,G.width()-A-B.currentWidth),B.currentTop=l(b,A,G.height()-A-B.currentHeight)}function o(){var a=G.width()/2-B.currentWidth*B.centerXRatio,b=G.height()/2-B.currentHeight*B.centerYRatio;n(a,b)}function p(){B.centerXRatio=(G.width()/2-B.currentLeft)/B.currentWidth,B.centerYRatio=(G.height()/2-B.currentTop)/B.currentHeight}function q(b){C.initialMouseX=b.pageX,C.initialMouseY=b.pageY,C.initialLeft=B.currentLeft,C.initialTop=B.currentTop,a.on("mousemove",r),a.on("mouseup",s)}function r(a){var b=C.initialLeft+a.pageX-C.initialMouseX,c=C.initialTop+a.pageY-C.initialMouseY;n(b,c),m()}function s(){a.off("mousemove",r),a.off("mousemove",s),p()}function t(){H.on("mousedown",q)}function u(a){var b=Array.prototype.filter.call(a,v)[0];if(b){z&&z.abort();var c=new e.XMLHttpRequest;z=c;var d=f.defer();return c.withCredentials=!0,c.upload.addEventListener("progress",function(a){a.lengthComputable&&d.notify(a.loaded/a.total)}),c.addEventListener("load",function(){d.resolve(JSON.parse(c.responseText))}),c.addEventListener("loadend",function(){z===c&&(z=null)}),c.open("POST",E,!0),c.send(b),{file:b,promise:d.promise}}}function v(a){return 0===a.type.search(/^image\/(?:bmp|jpg|jpeg|png|gif)$/)}function w(a){c.$apply(function(){G.css({background:"url("+a+") no-repeat"}),y=G.width()-2*A;var b=new Image;b.onload=function(){var a=this;c.$apply(function(){B.imageWidth=a.width||1,B.imageHeight=a.height||1;var b=B.imageWidth/B.imageHeight,d=1.5;1>b?(B.minimumWidth=y,B.minimumHeight=B.minimumWidth/b,B.maximumWidth=d*Math.max(B.imageWidth,y),B.maximumHeight=B.maximumWidth/b):(B.minimumHeight=y,B.minimumWidth=B.minimumHeight*b,B.maximumHeight=d*Math.max(B.imageHeight,y),B.maximumWidth=B.maximumHeight*b),c.zoomSlider.value=50,B.centerXRatio=.5,B.centerYRatio=.5,c.showImageEditDialog.value=!0,D=!0,k()})},b.src=a})}function x(){c.showImageUploadingModal.value=!1,c.showImageUploadFailedDialog.value=!0,c.resetChooseImage()}c.showImageEditDialog={value:!1},c.showImageUploadingModal={value:!1},c.showImageUploadFailedDialog={value:!1};var y,z,A=40,B={},C={},D=!1,E=h.xhrBase+"/user/pic/upload",F=h.xhrBase+"/user/pic";c.zoomSlider={orientation:"horizontal",min:0,max:100,range:"min",change:k,slide:k};var G,H,I=d.find(".profile-image-file");b(function(){G=d.find(".kf-profile-image-dialog-image"),H=d.find(".kf-profile-image-dialog-mask"),t()}),c.selectFile=function(){I.click()},c.fileChosen=function(a){c.$apply(function(){if(D=!1,c.files=a,0!==c.files.length){var b=new FileReader;b.onload=function(a){w(a.target.result)},b.readAsDataURL(c.files[0])}})},c.resetChooseImage=function(){I.val(null)},c.uploadImage=function(){c.showImageUploadingModal.value=!0;var a=u(c.files);a?a.promise.then(function(a){var b=B.imageWidth/B.currentWidth,d={picToken:a&&a.token,picWidth:B.imageWidth,picHeight:B.imageHeight,cropX:Math.floor(b*(A-B.currentLeft)),cropY:Math.floor(b*(A-B.currentTop)),cropSize:Math.floor(Math.min(b*y,b*y))};g.post(F,d).then(function(){i.fetchMe(),c.showImageUploadingModal.value=!1,c.resetChooseImage(),j.eventTrack("user_clicked_page",{action:"uploadImage"})},x)},x):x()}}}}]),angular.module("kifi.profileInput",["util","kifi.profileService"]).directive("kfProfileInput",["$timeout","$q","keyIndices","util",function(a,b,c,d){return{restrict:"A",scope:{state:"=inputState",validateAction:"&inputValidateAction",saveAction:"&inputSaveAction",explicitEnabling:"=",actionLabel:"@"},transclude:!0,templateUrl:"profile/profileInput.tpl.html",link:function(e,f){function g(){k&&(a.cancel(k),k=null)}function h(a){e.state.value=e.state.currentValue=a}function i(a){e.state.invalid=!0,e.errorHeader=a.header||"",e.errorBody=a.body||""}function j(){g(),e.state.editing=!0,e.state.invalid=!1}e.state.editing=e.state.invalid=!1;var k;f.find("input").on("keydown",function(a){switch(a.which){case c.KEY_ESC:e.$apply(e.cancel);break;case c.KEY_ENTER:e.$apply(e.save)}}).on("blur",function(){k=a(e.cancel,100)}).on("focus",function(){a(function(){j()})}),e.edit=function(){e.state.currentValue=e.state.value,j()},e.cancel=function(){e.state.value=e.state.currentValue,e.state.editing=!1},e.save=function(){var a=d.trimInput(e.state.value),c=e.validateAction({value:a});return c&&!c.isSuccess&&c.error?void i(c.error):(e.state.prevValue=e.state.currentValue,h(a),e.state.editing=!1,void b.when(e.saveAction({value:a})).then(function(a){a&&!a.isSuccess&&(a.error&&i(a.error),h(e.state.prevValue))}))}}}}]),angular.module("kifi.profileCard",["kifi.profileService"]).directive("kfProfileCard",["profileService","$analytics",function(a,b){return{replace:!0,restrict:"A",templateUrl:"profileCard/profileCard.tpl.html",link:function(c){c.me=a.me,a.getMe(),c.data=c.data||{},c.openHelpRankHelp=function(){c.data.showHelpRankHelp=!0,b.eventTrack("user_viewed_page",{type:"HelpRankHelp"})},c.yesLikeHelpRank=function(){c.data.showHelpRankHelp=!1,b.eventTrack("user_clicked_page",{action:"yesLikeHelpRank"})},c.noLikeHelpRank=function(){c.data.showHelpRankHelp=!1,b.eventTrack("user_clicked_page",{action:"noLikeHelpRank"})}}}}]),angular.module("kifi.profileService",["kifi.routeService","angulartics","kifi.clutch"]).factory("profileService",["$http","env","$q","util","routeService","socialService","$analytics","$window","$rootScope","Clutch",function(a,b,c,d,e,f,g,h,i,j){function k(a){return angular.forEach(a,function(a,b){G[b]=a}),G.picUrl=e.formatPicUrl(G.id,G.pictureName),G.primaryEmail=o(G.emails),G.seqNum++,f.setExpiredTokens(G.notAuthed),G}function l(){return I.expireAll(),I.get()}function m(){return I.get()}function n(b){return a.post(e.profileUrl,b).then(function(a){return g.eventTrack("user_clicked_page",{action:"updateProfile"}),k(a.data)})}function o(a){var b=_.find(a,"isPrimary");if(b)return b;var c=_.find(a,"isVerified")||a[0]||null;return c&&_.map(a,function(a){a===c&&(a.isPlaceholderPrimary=!0)}),c}function p(a,b){a=a||G.emails;for(var c=a.length-1;c>=0;c--)a[c].address===b&&a.splice(c,1)}function q(a){var b=o(a);b&&(b.isPrimary=!1)}function r(a){return{emails:_.clone(a.emails,!0)}}function s(a){m().then(function(b){var c=r(b);return p(c.emails,a),q(c.emails),c.emails.unshift({address:a,isPrimary:!0}),n(c)})}function t(a){var b=r(G);return q(b.emails),_.find(b.emails,function(b){b.address===a&&(b.isPrimary=!0)}),n(b)}function u(b){return a({url:e.resendVerificationUrl,method:"POST",params:{email:b}})}function v(){m().then(function(a){return a.primaryEmail&&a.primaryEmail.isPendingPrimary?x(a.primaryEmail.address):void 0})}function w(a){var b=r(G);return b.emails.push({address:a,isPrimary:!1}),n(b)}function x(a){var b=r(G);return p(b.emails,a),n(b)}function y(a){return a?d.validateEmail(a)?A():C():z("This field is required")}function z(a,b){return{isSuccess:!1,error:{header:a,body:b}}}function A(){return{isSuccess:!0}}function B(a){switch(a){case 400:return C();case 403:return z("This email address is already taken","This email address belongs to another user.<br>Please enter another email address.")}}function C(){return z("Invalid email address","Please enter a valid email address")}function D(b,c){return a.post(e.userPasswordUrl,{oldPassword:b,newPassword:c}).then(function(){g.eventTrack("user_clicked_page",{action:"changePassword"})})}function E(){return a.get(e.prefs).then(function(a){return d.replaceObjectInPlace(H,a.data),a.data})}function F(){h.location=e.logout}var G={seqNum:0},H={};i.$on("social.updated",function(){l()});var I=new j(function(){return a.get(e.profileUrl).then(function(a){return k(a.data)})},{cacheDuration:5e3});return{me:G,fetchMe:l,getMe:m,postMe:n,logout:F,fetchPrefs:E,prefs:H,setNewPrimaryEmail:s,makePrimary:t,resendVerificationEmail:u,cancelPendingPrimary:v,addEmailAccount:w,deleteEmailAccount:x,validateEmailFormat:y,failureInputActionResult:z,successInputActionResult:A,getEmailValidationError:B,sendChangePassword:D}}]),angular.module("kifi.search",["util","kifi.keepService"]).config(["$routeProvider",function(a){a.when("/find",{templateUrl:"search/search.tpl.html",controller:"SearchCtrl"})}]).controller("SearchCtrl",["$http","$scope","keepService","$routeParams","$location","$window","routeService","$log",function(a,b,c,d,e,f,g,h){function i(a){switch(a){case"m":return b.results.myTotal;case"f":return b.results.friendsTotal;case"a":return b.results.othersTotal}}c.reset(),b.search&&(b.search.text=d.q);var j=function(){k("unload")},k=function(b){var d=g.searchedAnalytics,f=c.lastSearchContext();if(f&&f.query){var i=e.$$protocol+"://"+e.$$host;e.$$port&&(i=i+":"+e.$$port);var j={origin:i,uuid:f.uuid,experimentId:f.experimentId,query:f.query,filter:f.filter,maxResults:f.maxResults,kifiExpanded:!0,kifiResults:c.list.length,kifiTime:f.kifiTime,kifiShownTime:f.kifiShownTime,kifiResultsClicked:f.clicks,refinements:c.refinements,pageSession:f.pageSession,endedWith:b};a.post(d,j)["catch"](function(a){h.log("res: ",a)})}else h.log("no search context to log")},l=function(b){var d=g.searchResultClicked,f=c.lastSearchContext();if(f&&f.query){var i=e.$$protocol+"://"+e.$$host;e.$$port&&(i=i+":"+e.$$port);var j=c.list,k=j.indexOf(b),l=b.bookmark.matches||(b.bookmark.matches={}),m={isMyBookmark:b.isMyBookmark,isPrivate:b.isPrivate,count:j.length,keepers:b.keepers,tags:b.tags,title:b.bookmark.title,titleMatches:(l.title||[]).length,urlMatches:(l.url||[]).length},n={origin:i,uuid:f.uuid,experimentId:f.experimentId,query:f.query,filter:f.filter,maxResults:f.maxResults,kifiExpanded:!0,kifiResults:j.length,kifiTime:f.kifiTime,kifiShownTime:f.kifiShownTime,kifiResultsClicked:f.clicks,refinements:c.refinements,pageSession:f.pageSession,resultPosition:k,resultUrl:b.url,hit:m};a.post(d,n)["catch"](function(a){h.log("res: ",a)})}else h.log("no search context to log")};b.$on("$destroy",function(){j(),f.removeEventListener("beforeunload",j)}),f.addEventListener("beforeunload",j),d.q||e.path("/");var m=d.q||"",n=d.f||"m",o=null;f.document.title=""===m?"Kifi • Search":"Kifi • "+m,b.keepService=c,b.keeps=c.list,b.results={myTotal:0,friendsTotal:0,othersTotal:0},b.isFilterSelected=function(a){return n===a},b.isEnabled=function(a){return b.isFilterSelected(a)?!1:!!i(a)},b.getFilterUrl=function(a){if(b.isEnabled(a)){var c=i(a);if(c)return"/find?q="+m+"&f="+a}return""},b.toggleSelectAll=c.toggleSelectAll,b.isSelectedAll=c.isSelectedAll,b.isMultiChecked=function(){return c.getSelectedLength()>0&&!c.isSelectedAll()},b.isCheckEnabled=function(){return b.keeps.length},b.hasMore=function(){return!c.isEnd()},b.mouseoverCheckAll=!1,b.onMouseoverCheckAll=function(){b.mouseoverCheckAll=!0},b.onMouseoutCheckAll=function(){b.mouseoverCheckAll=!1},b.getSubtitle=function(){if(b.loading)return"Searching…";var a=c.getSubtitle(b.mouseoverCheckAll);if(a)return a;var d=b.keeps.length;switch(d){case 0:return"Sorry, no results found for “"+m+"”";case 1:return"1 result found";default:return"Top "+d+" results"}},b.scrollDistance="100%",b.scrollDisabled=!1,b.analyticsTrack=function(a,b){return l(a),[a,b]},b.getNextKeeps=function(){b.loading||(k("refinement"),b.loading=!0,c.find(m,n,o&&o.context).then(function(a){b.loading=!1,b.results.myTotal=b.results.myTotal||a.myTotal,b.results.friendsTotal=b.results.friendsTotal||a.friendsTotal,b.results.othersTotal=b.results.othersTotal||a.othersTotal,c.isEnd()&&(b.scrollDisabled=!0),o=a}))},b.getNextKeeps()}]),angular.module("kifi.social.networksNeedAttention",[]).directive("kfNetworksNeedAttention",["socialService","$rootScope",function(a,b){return{replace:!0,restrict:"A",templateUrl:"social/networksNeedAttention.tpl.html",link:function(c){c.networksNeedAttention=function(){return Object.keys(a.expiredTokens).length>0},c.data={},c.doShow=function(){b.$emit("showGlobalModal","addNetworks")}}}}]),angular.module("kifi.social",["kifi.socialService"]).directive("kfSocialConnectNetworks",["socialService",function(a){return{scope:{},replace:!0,restrict:"A",templateUrl:"social/connectNetworks.tpl.html",link:function(b){b.data=b.data||{},b.data.show=!0,b.facebook=a.facebook,b.linkedin=a.linkedin,b.gmail=a.gmail,b.expiredTokens=a.expiredTokens,b.connectFacebook=a.connectFacebook,b.connectLinkedIn=a.connectLinkedIn,b.importGmail=a.importGmail,b.isRefreshingSocialGraph=a.isRefreshingSocialGraph,b.refreshingGraphs=a.refreshingGraphs,b.facebookStatus=function(){return b.refreshingGraphs.network.facebook?"refreshing":b.expiredTokens.facebook?"expired":"good"},b.linkedinStatus=function(){return b.refreshingGraphs.network.linkedin?"refreshing":b.expiredTokens.linkedin?"expired":"good"},a.refresh()}}}]),angular.module("kifi.socialService",["angulartics"]).factory("socialService",["routeService","$http","util","$rootScope","Clutch","$window","$q","$analytics","$timeout",function(a,b,c,d,e,f,g,h,i){var j=[],k={},l={},m=[],n=[],o={},p=!1,q=!1,r={network:{},abook:{}},s=!1,t={cacheDuration:5e3},u=function(e){return s?void 0:(s=!0,e=void 0===e?10:e,0>e?(q=!1,c.replaceObjectInPlace(r,{network:{},abook:{}}),void(s=!1)):void b.get(a.importStatus).then(function(a){return c.replaceObjectInPlace(r,a.data),_.size(a.data.network)>0||_.size(a.data.abook)>0?(p=!0,q||(q=!0,e=20),void i(function(){s=!1,u(--e)},2e3)):q?(p=q=!1,s=!1,void d.$emit("social.updated")):void i(function(){s=!1,u(--e)},3e3)}))},v=new e(function(){return b.get(a.networks).then(function(a){return _.remove(a.data,function(a){return"fortytwo"===a.network}),c.replaceArrayInPlace(j,a.data),c.replaceObjectInPlace(k,_.find(j,function(a){return"facebook"===a.network})),c.replaceObjectInPlace(l,_.find(j,function(a){return"linkedin"===a.network})),a.data})},t),w=new e(function(){return b.get(a.abooksUrl).then(function(a){return c.replaceArrayInPlace(n,a.data),c.replaceArrayInPlace(m,_.filter(n,function(a){return"gmail"===a.origin})),a.data})},t),x={networks:j,addressBooks:n,refresh:function(){return u(1),g.all([w.get(),v.get()])},facebook:k,linkedin:l,gmail:m,refreshSocialGraph:function(){return p=!0,u(),b.post(a.refreshNetworks)},checkIfUpdatingGraphs:u,checkIfRefreshingSocialGraph:function(){return p},refreshingGraphs:r,connectFacebook:function(){h.eventTrack("user_clicked_page",{action:"connectFacebook"}),f.location.href=a.linkNetwork("facebook")},connectLinkedIn:function(){h.eventTrack("user_clicked_page",{action:"connectLinkedIn"}),f.location.href=a.linkNetwork("linkedin")},importGmail:function(){h.eventTrack("user_clicked_page",{action:"importGmail"}),f.location.href=a.importGmail()},disconnectFacebook:function(){return b.post(a.disconnectNetwork("facebook")).then(function(a){return c.replaceObjectInPlace(k,{}),h.eventTrack("user_clicked_page",{action:"disconnectFacebook"}),a})},disconnectLinkedIn:function(){return b.post(a.disconnectNetwork("linkedin")).then(function(a){return c.replaceObjectInPlace(l,{}),h.eventTrack("user_clicked_page",{action:"disconnectLinkedin"}),a})},setExpiredTokens:function(a){var b={};a.forEach(function(a){b[a]=!0}),c.replaceObjectInPlace(o,b)},expiredTokens:o};return x}]),angular.module("kifi.tagKeeps",["util","kifi.keepService"]).config(["$routeProvider",function(a){a.when("/tag/:tagId",{templateUrl:"tagKeeps/tagKeeps.tpl.html",controller:"TagKeepsCtrl"})}]).controller("TagKeepsCtrl",["$scope","keepService","tagService","$routeParams","$window",function(a,b,c,d,e){b.reset(),a.keepService=b,a.keeps=b.list;var f=d.tagId||"";a.toggleSelectAll=b.toggleSelectAll,a.isSelectedAll=b.isSelectedAll,a.isMultiChecked=function(){return b.getSelectedLength()>0&&!b.isSelectedAll()},a.isCheckEnabled=function(){return a.keeps.length},a.hasMore=function(){return!b.isEnd()},a.mouseoverCheckAll=!1,a.onMouseoverCheckAll=function(){a.mouseoverCheckAll=!0},a.onMouseoutCheckAll=function(){a.mouseoverCheckAll=!1},a.getSubtitle=function(){if(a.loading)return"Loading...";var c=b.getSubtitle(a.mouseoverCheckAll);if(c)return c;var d=a.keeps.length;switch(d){case 0:return"No Keeps in this tag";case 1:return"Showing the only Keep in this tag";case 2:return"Showing both Keeps in this tag"}return b.isEnd()?"Showing all "+d+" Keeps in this tag":"Showing the "+d+" latest Keeps in this tag"},a.scrollDistance="100%",a.scrollDisabled=!1,a.getNextKeeps=function(){return a.loading?void 0:(a.loading=!0,b.getKeepsByTagId(f).then(function(c){return a.loading=!1,b.isEnd()&&(a.scrollDisabled=!0),c}))},a.getNextKeeps(),c.promiseById(f).then(function(b){e.document.title="Kifi • "+b.name,a.tag=b||null})}]),angular.module("kifi.tagItem",["kifi.tagService"]).directive("kfTagItem",["$timeout","$document","tagService","keyIndices","util",function(a,b,c,d,e){return{restrict:"A",scope:{tag:"=",takeFocus:"&",releaseFocus:"&",watchTagReorder:"&",reorderTag:"&",hasNewLocation:"&",viewTag:"&",removeTag:"&"},replace:!0,templateUrl:"tags/tagItem.tpl.html",link:function(f,g){function h(){f.isDropdownOpen=!1,b.unbind("click",i)}function i(){f.$apply(h)}function j(){p=!0,r=null}function k(){p=!1,o.css({borderTopStyle:"none",borderBottomStyle:"none",margin:0})}f.isRenaming=!1,f.isWaiting=!1,f.isDropdownOpen=!1,f.renameTag={},f.isHovering=!1;var l,m=g.find("input");f.onKeepDrop=function(b){l=a(function(){f.isWaiting=!0},500),f.isDragTarget=!1,c.addKeepsToTag(f.tag,b).then(function(){a.cancel(l),f.isWaiting=!1})},f.navigateToTag=function(a){f.isRenaming?a.stopPropagation():f.viewTag({tagId:f.tag.id})},f.setRenaming=function(){h(),f.takeFocus(),f.isRenaming=!0,f.renameTag.value=f.tag.name,a(function(){m.focus(),m.select()})},f.remove=function(){h(),f.removeTag({tag:f.tag})},f.onRenameKeydown=function(a){switch(a.keyCode){case d.KEY_ENTER:f.submitRename();break;case d.KEY_ESC:f.cancelRename()}},f.submitRename=function(){var a=f.renameTag.value;return a&&a!==f.tag.name?c.rename(f.tag.id,a).then(function(){f.cancelRename()}):void f.cancelRename()},f.cancelRename=function(){f.isRenaming=!1,f.releaseFocus()},f.toggleDropdown=function(){f.isDropdownOpen?h():(f.isDropdownOpen=!0,b.bind("click",i))},m.on("blur",function(){f.$apply(function(){f.cancelRename()})});var n=g.find(".kf-drag-mask");f.isDragTarget=!1,n.on("dragenter",function(){f.$apply(function(){f.isDragTarget=!0})}),n.on("dragleave",function(){f.$apply(function(){f.isDragTarget=!1})});var o=g.find(".kf-tag-drag-mask"),p=!1,q=parseInt(g.css("height"),10)/2,r=null;o.on("dragenter",j),o.on("dragover",function(a){if(p&&f.watchTagReorder()){var b=a.originalEvent.clientY-e.offset(g).top;b>q?(r=!1,o.css({borderTopStyle:"none",borderBottomStyle:"dotted",marginTop:"1px"})):(r=!0,o.css({borderTopStyle:"dotted",borderBottomStyle:"none",marginTop:0}))}}),o.on("dragleave",k),f.onTagDrop=function(a){k(),null!==r&&f.watchTagReorder()&&(g.find(".kf-nav-link").triggerHandler("dragend"),f.reorderTag({isTop:r,srcTag:a,dstTag:f.tag}))},f.isDragging=!1;var s,t,u;g.bind("mousemove",function(a){t=a.pageX-e.offset(g).left,u=a.pageY-e.offset(g).top}),g.bind("dragstart",function(a){g.addClass("kf-dragged"),s=g.clone().css({position:"absolute",left:0,top:0,width:g.css("width"),height:g.css("height"),zIndex:-1}),g.parent().after(s),a.dataTransfer.setDragImage(s[0],t,u),f.$apply(function(){f.isDragging=!0})}),g.bind("dragend",function(){g.removeClass("kf-dragged"),s.remove(),f.$apply(function(){f.isDragging=!1})});var v=g.find(".kf-nav-link"),w=g.find(".kf-tag-info"),x=g.find(".kf-tag-name");a(function(){x.css({maxWidth:0}),x.css({maxWidth:parseInt(v.css("width"),10)-parseInt(w.css("width"),10)+"px"})});var y=g.find(".kf-tag-new-location-mask");f.$watch(f.hasNewLocation,function(b){b&&(y.removeClass("hidden"),a(function(){y.addClass("hidden")}))}),f.enableHover=function(){f.isHovering=!0},f.disableHover=function(){f.isHovering=!1}}}}]),angular.module("kifi.tagService",["kifi.undo","kifi.keepService","kifi.routeService","angulartics"]).factory("tagService",["$http","env","$q","$rootScope","undoService","keepService","routeService","$analytics","util",function(a,b,c,d,e,f,g,h,i){function j(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c].id===b)return c;return-1}function k(a,b){var c=j(o,a);if(-1!==c){var d=o[c];return d.keeps=(d.keeps||0)+b,d}return null}function l(c,e){var f=b.xhrBase+"/keeps/add",g={collectionId:c.id,keeps:e};return a.post(f,g).then(function(a){return h.eventTrack("user_clicked_page",{action:"addKeepsToTag"}),a.data&&a.data.addedToCollection&&(k(c.id,a.data.addedToCollection),e.forEach(function(a){d.$emit("tags.addToKeep",{tag:c,keep:a})})),a})}function m(){a.post(g.tagOrdering,_.pluck(o,"id")).then(function(){}),u.fetchAll()}function n(a,b,c){var d=_.findIndex(o,function(a){return a.id===c.id}),e=_.clone(b),f=b.id;e.id=-1,a||(d+=1),o.splice(d,0,e),_.remove(o,function(a){return a.id===f});for(var g=0;g<o.length;g++)-1===o[g].id&&(o[g].id=f);m(),h.eventTrack("user_clicked_page",{action:"reorderTag"})}var o=[],p=[],q={},r="",s=null,t=70,u={allTags:o,list:p,getById:function(a){return q[a]||null},promiseById:function(a){return u.fetchAll().then(function(){return u.getById(a)})},filterList:function(a){for(var b=a.toLowerCase(),c=0===a.indexOf(r)&&r.length>0&&p.length<t?p:o,d=[],e=0,f=0,g=c.length;g>e&&t>f;e++){var h=c[e];-1!==h.lowerName.indexOf(b)&&(d.push(h),f++)}return r=a,i.replaceArrayInPlace(p,d),p},fetchAll:function(c){if(!c&&s)return s.then(function(){return p});var d=b.xhrBase+"/collections/all",e={params:{sort:"user",_:Date.now().toString(36)}};return s=a.get(d,e).then(function(a){var b=a.data&&a.data.collections||[];return o.length=0,o.push.apply(o,b),p.length=0,p.push.apply(p,o.slice(0,t)),o.forEach(function(a){a.lowerName=a.name.toLowerCase(),q[a.id]=a}),f.totalKeepCount=a.data.keeps,o}),s.then(function(){return p})},create:function(c){var d=b.xhrBase+"/collections/create";return a.post(d,{name:c}).then(function(a){var b=a.data;return b.keeps=b.keeps||0,b.lowerName=b.name.toLowerCase(),q[b.id]=b,o.unshift(b),u.filterList(""),h.eventTrack("user_clicked_page",{action:"createTag"}),b})},remove:function(c){var f=b.xhrBase+"/collections/"+c.id+"/delete";return a.post(f).then(function(){var a=j(o,c.id);if(-1!==a){o.splice(a,1);var b=j(p,c.id);-1!==b&&p.splice(b,1)}return d.$emit("tags.remove",c.id),h.eventTrack("user_clicked_page",{action:"removeTag"}),e.add("Tag deleted.",function(){u.unremove(c,a)}),c})},unremove:function(c,e){var f=b.xhrBase+"/collections/"+c.id+"/undelete";return a.post(f).then(function(){return-1!==e&&o.splice(e,0,c),d.$emit("tags.unremove",c.id),h.eventTrack("user_clicked_page",{action:"unremoveTag"}),m(),c})},rename:function(c,d){function e(a,b){var c=j(o,a);if(-1!==c){var d=o[c];return d.name=b,d}return null}var f=b.xhrBase+"/collections/"+c+"/update";return a.post(f,{name:d}).then(function(a){var b=a.data;return h.eventTrack("user_clicked_page",{action:"renameTag"}),e(b.id,b.name)})},removeKeepsFromTag:function(c,e){var f=b.xhrBase+"/collections/"+c+"/removeKeeps";a.post(f,e).then(function(a){return k(c,-e.length),e.forEach(function(a){d.$emit("tags.removeFromKeep",{tagId:c,keepId:a})}),h.eventTrack("user_clicked_page",{action:"removeKeepsFromTag"}),a})},addKeepsToTag:l,addKeepToTag:function(a,b){return l(a,[b])},reorderTag:n};return u}]),angular.module("kifi.tags",["util","dom","kifi.tagService","kifi.tagItem","jun.smartScroll"]).controller("TagsCtrl",["$scope","$timeout","tagService",function(a,b,c){a.create=function(d){return d?c.create(d).then(function(c){return c.isNew=!0,a.clearFilter(),b(function(){delete c.isNew},3e3),c}):void 0}}]).directive("kfTags",["$timeout","$window","$rootScope","$location","util","dom","tagService","profileService",function(a,b,c,d,e,f,g,h){var i=38,j=40,k=13,l=27,m=46,n=113;return{restrict:"A",templateUrl:"tags/tags.tpl.html",scope:{},controller:"TagsCtrl",link:function(c,o){function p(){return c.filter&&c.filter.name||""}function q(a){return a?c.getShownTags().indexOf(a):-1}function r(){s.css({position:"absolute",top:t.position().top,bottom:0})}c.tags=g.list,c.newLocationTagId=null,c.viewedTagId=null,c.clearFilter=function(a){c.filter.name="",a&&(c.focusFilter=!0)},c.unfocus=function(){c.lastHighlight=c.highlight},c.refocus=function(){c.lastHighlight&&!c.highlight&&(c.highlight=c.lastHighlight),c.lastHighlight=null,c.focusFilter=!0},c.showAddTag=function(){var a=p(),b=!1;return a&&(a=a.toLowerCase(),b=!c.tags.some(function(b){return b.name.toLowerCase()===a})),c.isAddTagShown=b,b},c.isActiveTag=function(a){return e.startsWith(d.path(),"/tag/"+a.id)},c.getShownTags=function(){return c.tags||[]},c.viewTag=function(a){return a?(c.viewedTagId=a,d.path("/tag/"+a)):void 0},c.select=function(){return c.highlight?c.viewTag(c.highlight.id):c.create(p()).then(function(a){c.viewTag(a.id)})},c.onKeydown=function(a){switch(a.keyCode){case i:c.highlightPrev();break;case j:c.highlightNext();break;case k:c.select();break;case l:c.highlight?c.dehighlight():c.clearFilter();break;case m:c.remove(c.highlight);break;case n:c.rename(c.highlight)}},c.onFilterChange=function(){g.filterList(c.filter.name)},c.refreshHighlight=function(){var a=c.getShownTags(),b=c.highlight;if(b){var d=a.indexOf(b);if(-1!==d)return c.highlightAt(d)}return p()&&a.length?c.highlightFirst():c.dehighlight()},c.isHighlight=function(a){return c.highlight===a},c.isHighlightNew=function(){return!c.highlight&&!!p()},c.dehighlight=function(){return c.highlight=null,c.isAddTagShown&&f.scrollIntoViewLazy(o.find(".kf-tag-new")[0]),null},c.highlightAt=function(a){if(null==a)return c.dehighlight();var b=c.getShownTags(),d=b.length;if(!d)return c.dehighlight();a=(a%d+d)%d;var e=b[a];return c.highlight=e,f.scrollIntoViewLazy(o.find(".kf-tag")[a]),e},c.highlightFirst=function(){return c.highlightAt(0)},c.highlightLast=function(){return c.highlightAt(-1)},c.highlightNext=function(){if(c.isHighlightNew())return c.highlightFirst();var a=q(c.highlight);return-1===a?c.highlightFirst():a===c.getShownTags().length-1?c.isAddTagShown?c.dehighlight():c.highlightFirst():c.highlightAt(a+1)},c.highlightPrev=function(){if(c.isHighlightNew())return c.highlightLast();var a=q(c.highlight);return-1===a?c.highlightLast():0===a?c.isAddTagShown?c.dehighlight():c.highlightLast():c.highlightAt(a-1)};var s=o.find(".kf-tag-list"),t=o.find(".kf-tag-list-hidden");a(r),c.$watch(function(){return h.me.seqNum},function(){r(),a(r)}),angular.element(b).resize(_.throttle(function(){r(),c.refreshScroll()},150)),c.$watch("filter.name",function(){a(c.refreshHighlight),c.refreshScroll()}),c.$watch("tags.length",function(){c.refreshScroll()}),g.fetchAll(),c.watchTagReorder=function(){return!p()},c.reorderTag=function(a,b,d){g.reorderTag(a,b,d),c.newLocationTagId=b.id},c.removeTag=function(a){return g.remove(a).then(function(){c.viewedTagId===a.id&&(c.viewedTagId=null,d.path("/"))})}}}}]),angular.module("kifi.templates",["common/directives/alertBanner/alertBanner.tpl.html","common/directives/keepWho/friendCard.tpl.html","common/directives/keepWho/keepWhoPic.tpl.html","common/directives/keepWho/keepWhoPics.tpl.html","common/directives/keepWho/keepWhoText.tpl.html","common/modal/basicModalContent.tpl.html","common/modal/modal.tpl.html","detail/detail.tpl.html","detail/keepDetail.tpl.html","detail/tagList.tpl.html","friends/friendCard.tpl.html","friends/friendRequestCard.tpl.html","friends/friends.tpl.html","home/emailModal.tpl.html","home/home.tpl.html","invite/connectionCard.tpl.html","invite/invite.tpl.html","invite/inviteSearch.tpl.html","invite/inviteWell.tpl.html","keep/addKeepsModal.tpl.html","keep/bookmarkFileModal.tpl.html","keep/importModal.tpl.html","keep/keep.tpl.html","keeps/keeps.tpl.html","layout/footer/footer.tpl.html","layout/leftCol/leftCol.tpl.html","layout/main/main.tpl.html","layout/nav/nav.tpl.html","layout/rightCol/rightCol.tpl.html","profile/emailImport.tpl.html","profile/profile.tpl.html","profile/profileChangePassword.tpl.html","profile/profileEmailAddresses.tpl.html","profile/profileImage.tpl.html","profile/profileInput.tpl.html","profileCard/profileCard.tpl.html","search/search.tpl.html","social/addNetworksModal.tpl.html","social/connectNetworks.tpl.html","social/networksNeedAttention.tpl.html","tagKeeps/tagKeeps.tpl.html","tags/tagItem.tpl.html","tags/tags.tpl.html"]),angular.module("common/directives/alertBanner/alertBanner.tpl.html",[]).run(["$templateCache",function(a){a.put("common/directives/alertBanner/alertBanner.tpl.html",'<div class="kf-alert-banner"><span class="kf-alert-banner-body"><span class="kf-alert-banner-head">Important -</span> <span ng-transclude=""></span></span> <span class="kf-alert-banner-button" ng-if="actionText" ng-click="action()">{{actionText}}</span></div>')
}]),angular.module("common/directives/keepWho/friendCard.tpl.html",[]).run(["$templateCache",function(a){a.put("common/directives/keepWho/friendCard.tpl.html",'<div class="kifi-fr-kcard tooltip-show-hide" ng-show="tooltipEnabled"><div class="kifi-fr-kcard-top"><img class="kifi-fr-kcard-pic" ng-src="{{getPicUrl(keeper)}}"><div class="kifi-fr-kcard-info"><div class="kifi-fr-kcard-name">{{getName(keeper)}}</div><div class="kifi-fr-kcard-desc">Your kifi friend</div></div></div><div class="kifi-fr-kcard-tri"></div></div>')}]),angular.module("common/directives/keepWho/keepWhoPic.tpl.html",[]).run(["$templateCache",function(a){a.put("common/directives/keepWho/keepWhoPic.tpl.html",'<a class="kf-keep-who-pic" href="javascript:" ng-attr-style="background-image: url({{getPicUrl(keeper)}})" ng-mouseenter="showTooltip()" ng-mouseleave="hideTooltip()" ng-click="hideTooltip()"></a>')}]),angular.module("common/directives/keepWho/keepWhoPics.tpl.html",[]).run(["$templateCache",function(a){a.put("common/directives/keepWho/keepWhoPics.tpl.html",'<span class="kf-keep-who-pics"><a class="kf-keep-who-pic me" title="You! You look great!" ng-attr-style="background-image: url({{getPicUrl(me)}})" ng-if="keep.isMyBookmark"></a><a kf-keep-who-pic="" keeper="keeper" ng-repeat="keeper in keepers | limitTo: 9"></a></span>')}]),angular.module("common/directives/keepWho/keepWhoText.tpl.html",[]).run(["$templateCache",function(a){a.put("common/directives/keepWho/keepWhoText.tpl.html",'<span class="kf-keep-who-text"><span class="kf-keep-you" ng-if="keep.isMyBookmark">You <span class="kf-keep-private" ng-class="{ on: isPrivate() }" ng-show="hasKeepers() || hasOthers()">Private</span></span> <span class="kf-keep-friends" ng-show="hasKeepers()">{{getFriendText()}}</span> <span></span> <span class="kf-keep-others" ng-show="hasOthers()">{{getOthersText()}}</span> <span class="kf-keep-kept-this">kept this</span> <span class="kf-keep-private" ng-class="{ on: isPrivate() }" ng-if="!hasKeepers() && !hasOthers()">Private</span><div class="kf-help-rank" ng-if="helprankEnabled && keep.clickCount"><div><span class="kf-heart">♥</span> Your keep helped friends {{keep.clickCount}} times!</div></div></span>')}]),angular.module("common/modal/basicModalContent.tpl.html",[]).run(["$templateCache",function(a){a.put("common/modal/basicModalContent.tpl.html",'<div class="dialog-content"><div class="dialog-title">Kifi</div><a class="dialog-x" ng-click="hideAndCancel()">✕</a><div class="dialog-body-wrap"><div class="dialog-header" ng-if="title.length" ng-bind-html="title"></div><div class="dialog-body" ng-transclude="" ng-class="{\'dialog-centered\': centered}"></div></div><div class="dialog-buttons" ng-if="singleAction"><button class="dialog-cancel" ng-click="hideAndCancel()" ng-if="withCancel">{{cancelText || \'Cancel\'}}</button> <button ng-class="{\'dialog-warn\': withWarning}" ng-click="hideAndAction()">{{actionText || \'Ok\'}}</button></div></div>')}]),angular.module("common/modal/modal.tpl.html",[]).run(["$templateCache",function(a){a.put("common/modal/modal.tpl.html",'<div ng-show="show"><div class="modal-backdrop fade in" ng-click="hideModal()" ng-style="backdropStyle"></div><div tabindex="-1" index="0" class="modal-dialog" ng-style="dialogStyle"><div class="modal-content" ng-transclude=""></div></div></div>')}]),angular.module("detail/detail.tpl.html",[]).run(["$templateCache",function(a){a.put("detail/detail.tpl.html",'<div class="kf-detail-pane" ng-show="isDetailOpen()"><div class="kf-detail-scroll" antiscroll="{ autoHide: false }"><div class="kf-detail-inner" ng-class="{ single: isSingleKeep(), multiple: !isSingleKeep(), private: isPrivate(), public: isPublic() }"><a class="kf-detail-x" href="javascript:" ng-click="closeDetail()"></a><div class="kf-page-meta" data-n="{{getLength()}}"><div kf-keep-detail="" ng-if="isSingleKeep()"></div><h2 class="kf-detail-header page-title" ng-hide="isSingleKeep()" ng-bind="getTitleText()"></h2><a class="kf-page-keep" href="javascript:" ng-click="toggleKeep()"></a> <a class="kf-page-priv" href="javascript:" ng-click="togglePrivate()"></a></div><div ng-if="isSingleKeep()"><div class="kf-page-who"><h2 class="kf-detail-header">Who kept this:</h2><div class="kf-page-who-pics"><span kf-keep-who-pics="" me="me" keepers="keep.keepers" keep="keep"></span></div><div class="kf-page-who-text" kf-keep-who-text="" keep="keep"></div></div><div class="kf-page-chatter"><h2 class="kf-detail-header">Talking about this Keep:</h2><a class="kf-page-chatter-messages" href="{{url}}" target="_blank" data-locator="/messages"><span class="chatter-count">{{keep.conversationCount || 0}}</span>{{getPrivateConversationText()}}</a></div></div><span kf-tag-list="" keep="keep" get-selected-keeps="getSelectedKeeps()"></span></div></div></div>')}]),angular.module("detail/keepDetail.tpl.html",[]).run(["$templateCache",function(a){a.put("detail/keepDetail.tpl.html",'<div class="kf-keep-detail"><h2 class="kf-detail-header page-title" ng-bind="keep.title"></h2><a class="kf-keep-detail-url long-text" ng-href="{{keep.url}}" target="_blank">{{keep.url}}</a><div class="kf-page-pic-wrap"><div class="kf-page-pic-special" ng-class="{ \'kf-page-pic-special-cell\': keep.isEmbed }" ng-if="keep.isEmbed"><div kf-youtube="" video-id="keep.videoId"></div></div><a class="kf-page-pic" ng-if="!keep.isEmbed" ng-href="{{keep.url}}" target="_blank" ng-attr-style="background-image: url({{keep.screenshot}})"><div class="kf-page-pic-1"><div class="kf-page-pic-2"><div class="kf-page-pic-3"><div class="kf-page-pic-soon">Preview of this page<br>not yet available</div><span class="kf-page-pic-tip">Visit page</span></div></div></div></a><div class="kf-page-how"><div class="kf-page-how-0"><div class="kf-page-how-pub"><div class="kf-page-how-1"><div class="kf-page-how-2"><div class="kf-page-how-3">Public</div></div></div></div><div class="kf-page-how-pri"><div class="kf-page-how-1"><div class="kf-page-how-2"><div class="kf-page-how-3">Private</div></div></div></div></div></div></div></div>')}]),angular.module("detail/tagList.tpl.html",[]).run(["$templateCache",function(a){a.put("detail/tagList.tpl.html",'<div class="page-colls"><h2 class="kf-detail-header" ng-show="commonTags.length > 0">Tags:</h2><ul class="page-coll-list"><li class="page-coll" data-id="{{tag.id}}" ng-repeat="tag in commonTags"><a class="page-coll-a" href="/tag/{{tag.id}}">{{tag.name}}</a> <a class="page-coll-x" href="javascript:" ng-click="removeTagFromSelectedKeeps(tag)">×</a></li><li class="page-coll-new"><span ng-show="!isAddingTag"><a class="page-coll-add-circle" href="javascript:" ng-show="hasTags()" ng-click="showAddTagDropdown()">+</a> <a class="page-coll-add" href="javascript:" ng-show="!hasTags()" ng-click="showAddTagDropdown()"><span class="page-coll-add-circle">+</span> {{addTagLabel()}}</a></span> <span ng-show="isAddingTag" kf-tag-suggestions=""><input focus-when="shouldGiveFocus" class="page-coll-input" type="text" placeholder="tag name" ng-model="tagFilter.name" ng-keydown="onKeydown($event)" ng-blur="hideAddTagDropdown()"><ul class="page-coll-opts"><li class="page-coll-opt" ng-repeat="tag in tagTypeAheadResults" ng-class="{ current: isTagHighlighted(tag) }" ng-mousedown="addTag(tag, keep)" ng-bind-html="tag.prettyHtml" ng-mouseover="highlightTag(tag)"></li><li class="page-coll-opt" ng-if="isAddTagShown()" ng-mousedown="createAndAddTag(keep)" ng-class="{ current: isTagHighlighted(null) }" ng-mouseover="highlightTag(null)">{{tagFilter.name}}<span class="new-label">{{newTagLabel}}</span></li></ul><span class="page-coll-opt-hidden"></span></span></li></ul></div>')}]),angular.module("friends/friendCard.tpl.html",[]).run(["$templateCache",function(a){a.put("friends/friendCard.tpl.html",'<div class="kf-friend-card"><img class="kf-friend-card-image" onerror="this.src=\'https://www.kifi.com/assets/img/ghost.100.png\'" ng-src="{{mainImage}}"><span class="kf-friend-card-who"><div class="kf-friend-card-name" title="{{name}}">{{name}}</div><div class="kf-friend-card-count" title="{{friendCount}}">{{friendCount}} friends on Kifi</div></span> <span class="kf-friend-card-button">Friends</span><ul class="kf-dropdown-menu kf-friend-card-menu"><li ng-show="searchFriend"><a href="javascript:" ng-click="unsearchfriend()">Hide {{possesive}} keeps in my search results</a></li><li ng-show="!searchFriend"><a href="javascript:" ng-click="researchfriend()">Show {{possesive}} keeps in my search results</a></li><li><a href="javascript:" ng-click="unfriend()">Unfriend</a></li></ul><div kf-modal="" show="showUnfriendConfirm" class="kf-unfriend-confirm-modal"><div kf-basic-modal-content="" with-cancel="true" title="Unfriend {{name}}?" with-warning="" action="reallyUnfriend()">Are you sure you want to unfriend this user?<ul><li>You will not see each other\'s results</li><li>You will not be able to send messages to each other</li></ul></div></div></div>')}]),angular.module("friends/friendRequestCard.tpl.html",[]).run(["$templateCache",function(a){a.put("friends/friendRequestCard.tpl.html",'<div class="kf-friend-card kf-friend-request-card"><img class="kf-friend-card-image" onerror="this.src=\'https://www.kifi.com/assets/img/ghost.100.png\'" ng-src="{{mainImage}}"><span class="kf-friend-card-who"><div class="kf-friend-card-name" title="{{name}}">{{name}}</div><div>Accept as your Kifi friend?</div></span> <span class="kf-friend-request-card-buttons"><span class="kf-accept" ng-click="accept()">Accept</span> <span class="kf-ignore" ng-click="ignore()">Ignore<span></span></span></span></div>')}]),angular.module("friends/friends.tpl.html",[]).run(["$templateCache",function(a){a.put("friends/friends.tpl.html",'<div ng-controller="FriendsCtrl"><div class="friends-wrapper" antiscroll="{ autoHide: false }"><div class="friends"><h2>Kifi Friends <span ng-show="totalFriends() > 0">({{totalFriends()}})</span></h2><p>Search your friends list by name or email address.</p><div class="import-wrapper" ng-if="isRefreshingSocialGraph"><div class="bouncy-ball"><div class="pace pace-active"><div class="pace-progress"></div><div class="pace-activity"></div></div></div>Importing your contacts</div><div kf-social-invite-well=""></div><div kf-networks-need-attention=""></div><div class="friend-requests" ng-show="requests.length > 0" ng-class="\'unfold\'"><div class="friends-list-header"><span class="friend-requests-badge">{{requests.length || 0}}</span> Pending Friend <span ng-pluralize="" count="requests.length" when="{\'one\': \'Request\', \'other\': \'Requests\'}"></span> <span ng-show="requests.length>2">| <a href="javascript:" ng-click="toggleRequestExpansion()">{{requestsToggleText}}</a></span></div><div kf-friend-request-card="" ng-repeat="request in requests | limitTo: requestsToShow" request="request"></div></div><div class="friends-list" ng-show="friends.length > 0" smart-scroll="" scroll-distance="friendsScrollDistance" scroll-disabled="isFriendsScrollDisabled()" scroll-next="friendsScrollNext()"><div class="friends-list-header">You have {{totalFriends()}} Kifi friends | <a href="/invite">Invite more friends</a></div><div kf-friend-card="" ng-repeat="friend in friends" friend="friend"></div><span ng-click="friendsScrollNext()" ng-hide="isFriendsScrollDisabled()" class="kf-show-more">Show more</span></div><div ng-if="friends.length <= 10 && friendsHasRequested" class="social-connect-friends"><div kf-social-connect-networks=""></div></div></div></div></div>')}]),angular.module("home/emailModal.tpl.html",[]).run(["$templateCache",function(a){a.put("home/emailModal.tpl.html",'<div kf-modal="" show="data.showEmailModal"><div kf-basic-modal-content="" centered="true" title="Email verified" action-text="Continue">Thanks for verifying your email address.</div></div>')}]),angular.module("home/home.tpl.html",[]).run(["$templateCache",function(a){a.put("home/home.tpl.html",'<div><div ng-if="modal"><div ng-if="data.showEmailModal" ng-include="\'home/emailModal.tpl.html\'"></div></div><div class="kf-main-head"><h1 class="kf-main-title">Browse your Keeps</h1><div class="kf-subtitle"><span class="kf-check-all" ng-class="{ enabled: isCheckEnabled(), checked: isSelectedAll(),  \'multi-checked\': isMultiChecked() }" ng-click="toggleSelectAll()" ng-mouseover="onMouseoverCheckAll()" ng-mouseout="onMouseoutCheckAll()"></span> <span class="kf-subtitle-text">{{getSubtitle()}}</span></div></div><div kf-keeps="" keeps="keeps" keeps-loading="loading" keeps-has-more="hasMore()" scroll-distance="scrollDistance" scroll-disabled="scrollDisabled" scroll-next="getNextKeeps()"></div></div>')}]),angular.module("invite/connectionCard.tpl.html",[]).run(["$templateCache",function(a){a.put("invite/connectionCard.tpl.html",'<div class="kf-connection-card" ng-class="{\'kf-connection-invited\': invited}" ng-hide="hidden"><img class="kf-connection-card-image" onerror="this.src=\'https://www.kifi.com/assets/img/ghost.100.png\'" ng-src="{{mainImage}}" ng-class="{\'kf-connection-card-email-image\': email}"><span class="kf-connection-card-who"><span class="kf-main-label" title="{{mainLabel}}">{{mainLabel}}</span> <span class="kf-byline-icon kf-icon-micro" ng-hide="email" ng-class="{\'kf-facebook-icon-micro\': facebook, \'kf-linkedin-icon-micro\': linkedin}"></span> <span class="kf-byline" title="{{byline}}">{{byline}}</span> <span class="kf-byline">{{byline2}}</span></span> <span class="kf-connection-card-action" ng-class="{\'kf-connection-invited\': invited}" ng-click="action()">{{actionText}}</span> <span class="kf-connection-card-close" ng-click="closeAction()">✕</span></div>')}]),angular.module("invite/invite.tpl.html",[]).run(["$templateCache",function(a){a.put("invite/invite.tpl.html",'<div ng-controller="InviteCtrl"><div class="invite-wrapper" antiscroll="{ autoHide: false }"><div class="invite"><h2>Find people to invite to Kifi</h2><p>Search by name or email address</p><div class="import-wrapper" ng-if="isRefreshingSocialGraph"><div class="bouncy-ball"><div class="pace pace-active"><div class="pace-progress"></div><div class="pace-activity"></div></div></div>Importing your contacts</div><div kf-social-invite-well=""></div><div kf-networks-need-attention=""></div><h3>People you may want to add to Kifi</h3><div class="kf-connection-card-container" smart-scroll="" scroll-distance="wtiScrollDistance" scroll-disabled="isWTIScrollDisabled()" scroll-next="wtiScrollNext()"><div kf-connection-card="" ng-repeat="friend in whoToInvite" friend="friend" refresh-scroll="refreshScroll" show-generic-invite-error="data.showGenericInviteError" show-linkedin-token-expired-modal="data.showLinkedinTokenExpiredModal" show-linkedin-hit-rate-limit-modal="data.showLinkedinHitRateLimitModal"></div><span ng-click="wtiScrollNext()" ng-hide="isWTIScrollDisabled()" class="kf-show-more">Show more</span></div><div ng-if="whoToInvite.length < 6 && wtiLoaded" class="social-connect-friends"><div kf-social-connect-networks=""></div></div><div kf-modal="" show="data.showGenericInviteError"><div kf-basic-modal-content="" action-text="Ok" title="Sorry, an error occurred, please try again later."></div></div><div kf-modal="" show="data.showLinkedinHitRateLimitModal"><div kf-basic-modal-content="" action-text="Ok"><h3>LinkedIn limits the number of messages users can send through Kifi each day.</h3><h3>Please retry inviting this connection again, tomorrow.</h3></div></div><div kf-modal="" show="data.showLinkedinTokenExpiredModal"><div kf-basic-modal-content="" with-cancel="" action-text="Ok" action="showAddNetworksModal()" title="Your session has expired, you need to reconnect to LinkedIn."></div></div></div></div></div>')}]),angular.module("invite/inviteSearch.tpl.html",[]).run(["$templateCache",function(a){a.put("invite/inviteSearch.tpl.html",'<div class="social-invite-search"><input type="text" ng-model="search.name" placeholder="Find friends to add to Kifi" ng-change="change($event)"><ul class="social-invite-dropdown" ng-show="search.showDropdown"><li class="social-invite-element" ng-repeat="result in results" ng-class="\'social-invite-{{result.status === \'joined\' && result.network === \'fortytwoNF\' ? \'\' : result.status}}\'"><div ng-if="!result.custom"><div ng-if="result.networkType !== \'email\'"><img ng-src="{{result.image || \'https://www.kifi.com/assets/img/ghost.200.png\'}}" class="social-invite-image"></div><div ng-if="!result.status"><div class="social-invite-summary"><div class="social-invite-name">{{result.label}}</div><div class="social-invite-network"><span class="social-network-icon kf-icon-micro" ng-class="result.iconStyle"></span>{{result.network}}</div></div><div class="social-invite-action clickable"><div class="social-invite-button" ng-click="invite(result, $event)">Invite</div></div></div><div ng-if="result.status === \'joined\' && result.networkType === \'fortytwo\'"><div class="social-invite-summary"><div class="social-invite-name">{{result.label}}</div><div class="social-invite-network">Your friend on Kifi</div></div></div><div ng-if="result.status === \'requested\' && result.networkType === \'fortytwoNF\'"><div class="social-invite-summary"><div class="social-invite-name">{{result.label}}</div><div class="social-invite-network">Kifi user — request sent</div></div></div><div ng-if="result.status === \'joined\' && result.networkType === \'fortytwoNF\'"><div class="social-invite-summary"><div class="social-invite-name">{{result.label}}</div><div class="social-invite-network">Kifi user</div></div><div class="social-invite-action clickable"><div class="social-invite-button" ng-click="invite(result, $event)">Add</div></div></div><div ng-if="result.status === \'invited\'"><div class="social-invite-summary"><div class="social-invite-name-long">{{result.label}}</div><div class="social-invite-network"><span class="social-network-icon kf-icon-micro" ng-class="result.iconStyle"></span>{{result.inviteText}}</div></div><div class="social-invite-action clickable"><div class="social-invite-button" ng-click="invite(result, $event)">Resend</div></div></div></div><div ng-if="result.custom === \'email\'"><img src="/img/email-icon.png" class="social-invite-image cant-find"><div class="social-invite-summary"><div class="social-invite-name">Email to</div><div class="social-invite-network">{{result.label}}</div></div><div class="social-invite-action clickable"><div class="social-invite-button" ng-click="invite(result, $event)">Invite</div></div></div><div ng-if="result.custom === \'cant_find\'" class="fill-parent clickable" ng-click="data.showCantFindModal = true"><img src="/img/friend-missing@2x.png" class="social-invite-image cant-find"><div class="social-invite-summary"><div class="social-invite-name social-invite-custom-email">Can\'t find your friend?</div></div></div><div class="clearfix"></div></li></ul><div kf-modal="" show="data.showCantFindModal" kf-width="670px"><div kf-basic-modal-content="" single-action="false"><div class="friend-not-found-modal"><div class="friend-not-found-heading">We couldn\'t find any friends matching</div><div class="friend-not-found-name">\'{{search.name}}\'</div><div class="friend-not-found-sub-heading">How to fix it</div><ul><li ng-if="!hasNetworks()" class="friend-not-found-suggestion">You don\'t have any networks connected to Kifi yet. <a class="friend-not-found-link" href="javascript:" ng-click="connectNetworks()">Get started by connecting.</a></li><li ng-if="hasNetworks()" class="friend-not-found-suggestion">Your friends list might not be up to date. <a class="friend-not-found-link" href="javascript:" ng-click="refreshFriends()">Try refreshing it.</a></li><li ng-if="hasNetworks()" class="friend-not-found-suggestion">Some of your friends may have privacy settings that prevent us from showing them.<br>Tell them to go to kifi.com and sign up.</li><li class="friend-not-found-suggestion">Or just <a class="friend-not-found-link" href="http://support.kifi.com/customer/portal/emails/new">contact us.</a></li></ul><div class="dialog-buttons"><button class="friend-not-found-modal-done" ng-click="data.showCantFindModal = false">Done</button></div></div></div></div></div>')}]),angular.module("invite/inviteWell.tpl.html",[]).run(["$templateCache",function(a){a.put("invite/inviteWell.tpl.html",'<div class="social-invite-well"><span kf-social-invite-search=""></span> <span class="social-network-display-wrapper"><span class="social-networks-display"><span class="social-networks-summary">{{networkText}}</span> <span class="social-networks-add" ng-click="showAddNetworks()">Add new</span></span></span><div class="clearfix"></div></div>')}]),angular.module("keep/addKeepsModal.tpl.html",[]).run(["$templateCache",function(a){a.put("keep/addKeepsModal.tpl.html",'<div kf-modal="" ng-if="data.showAddKeeps" show="data.showAddKeeps" kf-width="450px"><div kf-basic-modal-content="" centered="true" action-text="Done"><div contenteditable="" class="add-keep-paste-bin">Paste URLs to keep here <span class="add-keep-isolated">http://www.kifi.com</span></div></div></div>')}]),angular.module("keep/bookmarkFileModal.tpl.html",[]).run(["$templateCache",function(a){a.put("keep/bookmarkFileModal.tpl.html",'<div ng-if="modal == \'import_bookmark_file\'" kf-modal="" show="data.showBookmarkFileModal1" kf-width="590px" class="import-file-modal"><div kf-basic-modal-content="" title="Keep your links privately on Kifi" single-action="false" cancel="cancelBookmarkUpload()"><div class="file-import-inner"><img src="/img/bookmark-to-kifi@2x.png" class="import-kippt-to-kifi"><h3 class="pitch">Benefits of Kifi</h3><ul><li class="import-benefit">Search the full content within the pages you kept (forever free)</li><li class="import-benefit">Find your content directly when searching on Google</li><li class="import-benefit">Send and discuss on any page</li></ul><div class="file-import-well"><p class="import-how-to">How to import your content into Kifi:</p><div class="import-inset"><p>Step 1: Export your links from <a href="https://getpocket.com/export" ng-click="openExportPopup($event)">Pocket</a>, <a href="http://export.delicious.com/settings/bookmarks/export" ng-click="openExportPopup($event)">Delicious</a> or <a href="https://kippt.com/export/" ng-click="openExportPopup($event)">Kippt</a>.</p><p ng-click="openBookmarkFileSelector($event)" class="import-file-link">Step 2: <a href="javascript:">Click here to select the file you downloaded</a>.<input class="bookmark-file-upload" type="file" name="bookmark-file" accept=".html,text/html" onchange="angular.element(this).scope().allowUpload(this)"></p><div class="dialog-buttons"><button ng-click="uploadBookmarkFile($event)" ng-class="{\'disabled\': disableBookmarkImport }" ng-show="importFilename">Step 3: Upload your bookmarks</button></div><div ng-click="openBookmarkFileSelector($event)" class="import-file-status"><div ng-if="importFilename"><i>{{importFilename}}</i> selected.</div><div ng-if="!importFilename && !importFileStatus">Please select a file to get started.</div><div ng-if="importFileStatus">{{importFileStatus}}</div></div></div></div></div></div></div><div kf-modal="" show="data.showBookmarkFileModal2" kf-width="590px" class="import-file-modal"><div kf-basic-modal-content="" centered="true" title="Importing your bookmarks to Kifi" action-text="Awesome"><img src="/img/bookmark-to-kifi@2x.png" class="import-kippt-to-kifi"><p>This might take a few minutes (especially if you have a lot of bookmarks). Feel free to browse around — we’re syncing in the background.</p></div></div><div kf-modal="" show="data.showBookmarkFileError" kf-width="590px" class="import-file-modal"><div kf-basic-modal-content="" title="Whoops! We\'re having a problem." action-text="Done"><p>We\'re having trouble importing your bookmark upload. It could be that we\'re overloaded, or that the file is invalid.</p><p>If you think this is an error, <a href="http://support.kifi.com/customer/portal/emails/new">contact support</a> and we\'ll sort things out. Thanks!</p></div></div>')}]),angular.module("keep/importModal.tpl.html",[]).run(["$templateCache",function(a){a.put("keep/importModal.tpl.html",'<div kf-modal="" show="data.showImportModal" kf-width="540px" class="import-modal"><div kf-basic-modal-content="" centered="true" title="Privately add your bookmarks to Kifi?" single-action="false" cancel="cancelImport()"><img src="/img/bookmark-to-kifi@2x.png" class="import-star-to-kifi"><p>Your bookmarks will be securely kept as private keeps and will never appear in your friends’ search results.</p><p>You also can find, organize, and remove them anytime at Kifi.com.</p><div class="dialog-buttons"><a class="dialog-cancel" ng-click="cancelImport()" href="javascript:">Cancel</a> <button ng-click="importBookmarks()">Import bookmarks</button></div></div></div><div kf-modal="" show="data.showImportModal2" kf-width="540px" class="import-modal"><div kf-basic-modal-content="" centered="true" title="Importing your bookmarks to Kifi" action-text="Awesome"><img src="/img/bookmark-to-kifi@2x.png" class="import-star-to-kifi"><p>This might take a few minutes (especially if you have a lot of bookmarks). Feel free to browse around — we’re syncing in the background.</p></div></div><div kf-modal="" show="data.showImportError" kf-width="540px" class="import-modal"><div kf-basic-modal-content="" title="Whoops! We\'re having a problem." action-text="Done"><p>We\'re having trouble importing your bookmarks because it seems that you aren\'t running an up-to-date Kifi extension.</p><p>If you think this is an error, <a href="http://support.kifi.com/customer/portal/emails/new">contact support</a> and we\'ll sort things out. Thanks!</p></div></div>')}]),angular.module("keep/keep.tpl.html",[]).run(["$templateCache",function(a){a.put("keep/keep.tpl.html",'<li class="kf-keep" ng-click="clickAction({keep: keep, event: $event})" ng-hide="keep.unkept" ui-draggable="true" drag-channel="keepDragChannel" ui-on-drop="onTagDrop($data)" drop-channel="tagDragChannel" drag-enter-class="kf-candidate-drag-target" ng-class="{ \'kf-dragged\': isDragging, \'kf-drag-target\': isDragTarget }"><time class="kf-keep-time" ng-attr-datetime="{{keep.createdAt}}" ng-show="keep.createdAt" am-time-ago="keep.createdAt"></time><div class="kf-keep-handle"><div class="kf-keep-checkbox" ng-click="onCheck($event)"></div></div><div class="kf-keep-title"><span class="kf-example-tag">Example keep</span> <a class="kf-keep-title-link" ng-href="{{keep.url}}" target="_blank" ng-attr-title="{{getTitle()}}" ng-bind-html="keep.titleHtml"></a></div><div class="kf-keep-url" ng-attr-title="{{keep.url}}" ng-bind-html="keep.descHtml"></div><div class="kf-keep-tags"><span class="kf-keep-tag" ng-class="{ example: isExampleTag(tag) }" ng-repeat="tag in getTags()"><a class="kf-keep-tag-link" ng-href="/tag/{{tag.id}}">{{tag.name}}</a></span></div><div class="kf-keep-who"><span kf-keep-who-pics="" me="me" keepers="keep.keepers" keep="keep"></span> <span class="kf-keep-who-others" ng-if="showOthers()"></span> <span kf-keep-who-text="" keep="keep"></span></div><div class="kf-keep-arrow-1"><div class="kf-keep-arrow-2"><div class="kf-keep-arrow-3"><div class="kf-keep-arrow-4"></div></div></div></div><div class="kf-keep-hover-button-wrapper"><div class="kf-keep-hover-button-table"><div class="kf-keep-hover-button-cell"><div class="kf-keep-hover-button"><span class="kf-keep-button-preview">Preview</span> <span class="kf-keep-button-close">Close</span></div></div></div></div><div class="kf-drag-mask"></div></li>')}]),angular.module("keeps/keeps.tpl.html",[]).run(["$templateCache",function(a){a.put("keeps/keeps.tpl.html",'<div class="kf-main-keeps keeps-wrapper" antiscroll="{ autoHide: false }"><div smart-scroll="" scroll-distance="scrollDistance" scroll-disabled="isScrollDisabled()" scroll-next="scrollNext()" class="keeps-list"><ol class="kf-my-keeps"><div ng-repeat="keep in keeps"><div kf-keep="" is-previewed="isPreviewed(keep)" is-selected="!!isSelected(keep)" keep="keep" me="me" toggle-select="toggleSelect(keep)" click-action="onClickKeep(keep, event)" drag-keeps="dragKeeps(keep, event, mouseX, mouseY)" stop-dragging-keeps="stopDraggingKeeps()"></div></div></ol><ol class="kf-shadow-dragged-keeps"><span class="kf-shadow-keep-first"><li ng-if="data.draggedKeeps.length >= 1" class="kf-dragged-keep" kf-keep="" kf-shadow-keep-first="" keep="data.draggedKeeps[0]" is-previewed="isPreviewed(keep)" is-selected="!!isSelected(keep)"></li><li></li></span> <span class="kf-shadow-keep-second"><li ng-if="data.draggedKeeps.length === 3" class="kf-dragged-keep" kf-keep="" kf-shadow-keep-first="" keep="data.draggedKeeps[1]" is-previewed="isPreviewed(keep)" is-selected="!!isSelected(keep)"></li><li></li></span> <span class="kf-shadow-keep-ellipsis" ng-class="{\'active\': data.draggedKeeps.length >= 4}"><div class="kf-shadow-keep-ellipsis-line"></div><div class="kf-shadow-keep-ellipsis-counter">{{data.draggedKeeps.length - 2}} other keeps selected</div></span><div class="kf-shadow-keep-ellipsis-counter-hidden">{{data.draggedKeeps.length - 2}} other keeps selected</div><span class="kf-shadow-keep-last"><li ng-if="data.draggedKeeps.length >= 2" class="kf-dragged-keep" kf-keep="" kf-shadow-keep-last="" keep="data.draggedKeeps[data.draggedKeeps.length-1]" is-previewed="isPreviewed(keep)" is-selected="!!isSelected(keep)"></li></span></ol><div class="kf-keep-group-title-fixed"></div><img class="kf-keeps-loading" ng-show="keepsLoading" src="/img/wait.gif"> <a class="kf-keeps-load-more" ng-show="isShowMore()" href="javascript:" ng-click="scrollNext()">Show more</a></div></div>')}]),angular.module("layout/footer/footer.tpl.html",[]).run(["$templateCache",function(a){a.put("layout/footer/footer.tpl.html",'<div class="kf-footer" antiscroll="{ autoHide: false }"><h2 class="kf-footer-header">Getting Started with Kifi</h2><ul class="kf-footer-list about-kifi"><li><a class="kf-footer-item-link kifi-tutorial" href="#" ng-click="data.showGettingStarted = true"><span class="kf-footer-item-icon kf-footer-item-icon-tutorial"></span> Quick guide to get started</a><div ng-if="data.showGettingStarted"><iframe class="kifi-onboarding-iframe" ng-src="https://www.kifi.com/assets/onboarding.html" frameborder="0"></iframe></div></li><li class="install-kifi"><a class="kf-footer-item-link" href="javascript:" ng-click="triggerInstall()"><span class="kf-footer-item-icon kf-footer-item-icon-install"></span> <span ng-show="!installInProgress()">Install the extension</span> <span ng-show="installInProgress()">Installing...</span> <span ng-show="installed()">Installed!</span></a></li><li class="import-bookmarks"><a class="kf-footer-item-link" href="javascript:" ng-click="importBookmarks()"><span class="kf-footer-item-icon kf-footer-item-icon-install"></span> Import your bookmarks</a></li><li class="import-bookmark-file"><a class="kf-footer-item-link" href="javascript:" ng-click="importBookmarkFile()"><span class="kf-footer-item-icon kf-footer-item-icon-file-import"></span> Import Delicious / Kippt / Pocket</a></li><li><a class="kf-footer-item-link" href="/invite"><span class="kf-footer-item-icon kf-footer-item-icon-friends"></span> Find friends</a></li></ul><div kf-modal="" show="data.showInstallErrorModal"><div kf-basic-modal-content=""><div>Something seems to have gone wrong installing the browser extension.</div><div>Please try again later, or <a href="http://support.kifi.com/customer/portal/emails/new">contact us</a>.</div></div></div><h2 class="kf-footer-header">Kifi Support and Updates</h2><ul class="kf-footer-list about-us"><li><a class="kf-footer-item-link support-center" href="http://support.kifi.com"><span class="kf-footer-item-icon kf-footer-item-icon-support"></span> Support center</a></li><li><a class="kf-footer-item-link contact-us" href="http://support.kifi.com/customer/portal/emails/new"><span class="kf-footer-item-icon kf-footer-item-icon-contact"></span> Contact us</a></li><li><a class="kf-footer-item-link updates-features" href="http://blog.kifi.com"><span class="kf-footer-item-icon kf-footer-item-icon-blog"></span> Kifi blog</a></li></ul><div class="kf-footer-more"><a href="https://www.kifi.com/privacy" target="_self">Privacy</a> <span class="kf-footer-sep">|</span> <a href="https://www.kifi.com/terms" target="_self">Terms</a> <span class="kf-footer-sep">|</span> <a href="https://www.kifi.com/about" target="_self">About Kifi</a> <span class="kf-footer-sep">|</span> <a href="http://www.42go.com">About FortyTwo</a></div></div>')
}]),angular.module("layout/leftCol/leftCol.tpl.html",[]).run(["$templateCache",function(a){a.put("layout/leftCol/leftCol.tpl.html",'<div class="kf-col-inner kf-col-inner-left" ng-controller="LeftColCtrl"><div class="kf-header-left"><a class="kf-header-logo" href="/"></a> <span class="kf-header-callout-wrap"><a class="kf-header-callout" href="http://www.42go.com/join_us.html">we\'re hiring!</a></span></div><div kf-profile-card=""></div><div kf-nav=""></div><div kf-tags=""></div></div>')}]),angular.module("layout/main/main.tpl.html",[]).run(["$templateCache",function(a){a.put("layout/main/main.tpl.html",'<div class="kf-col-inner" ng-controller="MainCtrl"><div class="kf-query-wrap" ng-class="{ empty: isEmpty(), focus: focus }"><input kf-no-drag-input="" class="kf-query" type="text" placeholder="Find anything..." ng-model="search.text" ng-keydown="onKeydown($event)" ng-focus="onFocus()" ng-blur="onBlur()" ng-change="onChange()"><span class="kf-query-icon"><b class="kf-query-mag"></b> <a class="kf-query-x" href="javascript:" ng-click="clear()"></a></span><div class="kf-small-tooltip" ng-if="undo.isSet() || tooltipMessage"><span class="kf-small-tooltip-box"><span class="kf-small-tooltip-message">{{undo.message || tooltipMessage}}</span> <a class="kf-small-tooltip-link" href="javascript:" ng-click="undo.undo()" ng-if="undo.isSet()">Undo</a> <span></span></span></div></div><div ng-view=""></div><div ng-if="modal"><div ng-include="\'keep/importModal.tpl.html\'"></div><div ng-include="\'keep/bookmarkFileModal.tpl.html\'"></div><div ng-include="\'social/addNetworksModal.tpl.html\'"></div><div kf-add-keeps-modal=""></div></div></div>')}]),angular.module("layout/nav/nav.tpl.html",[]).run(["$templateCache",function(a){a.put("layout/nav/nav.tpl.html",'<div class="kf-nav-group-name">You</div><ul class="kf-nav-group"><li class="kf-nav-item kf-nav-keeps" ng-class="{ active: isActive(\'/\') }"><a class="kf-nav-link" href="/"><span class="kf-nav-name">Your Keeps</span> <span class="kf-nav-count" ng-class="{ empty: !counts.keepCount }">{{counts.keepCount}}</span></a></li><li class="kf-nav-item kf-nav-friends" ng-class="{ active: isActive(\'/friends\') }"><a class="kf-nav-link" href="/friends"><span class="kf-nav-badge" ng-class="{ empty: !counts.friendsNotifCount }">{{counts.friendsNotifCount}}</span> <span class="kf-nav-name">Your Kifi Friends</span> <span class="kf-nav-count" ng-class="{ empty: !counts.friendsCount }">{{counts.friendsCount}}</span></a></li><li class="kf-nav-item kf-nav-invite" ng-class="{ active: isActive(\'/invite\') }"><a class="kf-nav-link-btn" href="/invite"><span class="kf-nav-name">Find Friends</span></a></li></ul>')}]),angular.module("layout/rightCol/rightCol.tpl.html",[]).run(["$templateCache",function(a){a.put("layout/rightCol/rightCol.tpl.html",'<div class="kf-col-inner" ng-controller="RightColCtrl"><nav class="kf-top-right-nav"><a href="javascript:" ng-click="logout()">Log out</a></nav><div ng-include="\'layout/footer/footer.tpl.html\'"></div><div kf-detail=""></div></div>')}]),angular.module("profile/emailImport.tpl.html",[]).run(["$templateCache",function(a){a.put("profile/emailImport.tpl.html",'<div><h3>Import your email contacts to Kifi</h3><h5>Message your email contact directly from Kifi</h5><a class="profile-nw nw-email import-gmail" href="javascript:" ng-click="importGmailContacts()" ng-bind="addressBookImportText"></a><div ng-if="addressBooks"><div class="profile-email-accounts-title"><span>Your imported accounts:</span> </div><table class="profile-email-accounts"><tbody><tr ng-repeat="addressBook in addressBooks" class="profile-email-account {{addressBook.state}}" data-id="{{addressBook.id}}"><td class="profile-email-status"></td><td class="profile-email-address">{{addressBook.ownerEmail}}</td><td class="profile-email-separator">|</td><td class="profile-email-contact-count">{{addressBook.numProcessed}} out of {{addressBook.numContacts}} contacts imported</td></tr></tbody></table></div></div>')}]),angular.module("profile/profile.tpl.html",[]).run(["$templateCache",function(a){a.put("profile/profile.tpl.html",'<div ng-controller="ProfileCtrl"><div class="profile-wrapper" antiscroll="{ autoHide: false }"><div class="profile"><h2>Settings</h2><div class="profile-container"><div kf-profile-image="" pic-url="me.picUrl"></div><div class="profile-input-wrapper"><div class="profile-input-title">Name</div><div class="profile-input-box profile-input-box-name"><span class="profile-input-placeholder"><span class="profile-placeholder-first-name">{{me.firstName}}</span> <span class="profile-placeholder-last-name">{{me.lastName}}</span></span><input class="profile-input-input profile-first-name" disabled type="text" name="firstName" placeholder="First name" value="{{me.firstName}}" novalidate><input class="profile-input-input profile-last-name" disabled type="text" name="lastName" placeholder="Last name" value="{{me.lastName}}" novalidate></div></div><div class="profile-input-wrapper"><div class="profile-input-title">Description tagline <span class="profile-input-remaining-chars"></span></div><div kf-profile-input="" input-state="descInput" input-save-action="saveDescription(value)" explicit-enabling="true"><input class="profile-input-input profile-description-input" ng-disabled="!descInput.editing" kf-focus-if="" focus-cond="descInput.editing" ng-model="descInput.value" type="text" name="description" placeholder="Enter your description tagline" maxlength="50"></div></div><div class="profile-input-wrapper profile-email"><div class="profile-input-title">Contact email</div><div kf-profile-input="" input-state="emailInput" input-validate-action="validateEmail(value)" input-save-action="saveEmail(value)" explicit-enabling="true"><input class="profile-input-input profile-email-input" ng-disabled="!emailInput.editing" kf-focus-if="" focus-cond="emailInput.editing" ng-model="emailInput.value" type="text" name="email" placeholder="Enter your email address" novalidate></div><div kf-modal="" show="showEmailChangeDialog.value"><div kf-basic-modal-content="" with-cancel="" action-text="Continue" action="confirmSaveEmail()" cancel="cancelSaveEmail()"><p>You are about to change your primary email to <span class="email-address">{{me.primaryEmail.address}}</span>.</p><p>We will send a verification email to this email address to prove that you own it. To verify, please click on a verification link on the email.</p></div></div></div><div class="profile-email-address-unverified" ng-if="isUnverified({value: me.primaryEmail})">Your email is pending your verification (<a class="profile-email-pending-resend" href="javascript:" ng-click="resendVerificationEmail()">Resend verification</a>).</div><div class="profile-email-address-pending" ng-if="me.primaryEmail.isPendingPrimary">Your new primary email, <span class="profile-email-address-pending-email">{{me.primaryEmail.address}}</span>, is pending your verification (<a class="profile-email-pending-resend" href="javascript:" ng-click="resendVerificationEmail()">Resend verification</a>, <a class="profile-email-pending-cancel" href="javascript:" ng-click="cancelPendingPrimary()">Cancel</a>).</div><div kf-profile-email-addresses="" input-state="addEmailInput" email-list="me.emails" validate-email-action="validateEmail(value)" add-email-action="addEmail(value)" resend-verification-email-action="resendVerificationEmail(value)"></div><div kf-modal="" show="showResendVerificationEmailDialog.value"><div kf-basic-modal-content="" title="{{emailForVerificationModalTitle}}"><p>You will shortly receive a verification email from us at the following address: <span class="email-address">{{emailForVerification}}</span>.</p><p>To verify, please click on a verification link on the email.</p></div></div><div kf-profile-change-password=""></div></div><div class="profile-section"><h3>Connect your social networks to Kifi</h3><h5>Find which of your friends are using Kifi</h5><ul class="profile-networks"><li kf-facebook-connect-button="" data-network="facebook" ng-class="{ \'connected\': isFacebookConnected }"><a class="profile-nw nw-facebook" href="https://www.kifi.com/link/facebook" target="_self" ng-click="connectFacebook()" ng-show="!isFacebookConnected">Facebook</a> <a class="profile-nw nw-facebook" ng-href="{{fbProfileUrl}}" target="_blank" ng-show="isFacebookConnected">Facebook</a> <span class="profile-nw-connected"><span class="profile-placeholder">&nbsp;</span> <span class="profile-connected">Connected</span> <a class="profile-disconnect" href="javascript:" ng-click="disconnectFacebook()">Disconnect?</a></span></li><li kf-linkedin-connect-button="" data-network="linkedin" ng-class="{ \'connected\': isLinkedInConnected }"><a class="profile-nw nw-linkedin" href="https://www.kifi.com/link/linkedin" target="_self" ng-click="connectFacebook()" ng-show="!isLinkedInConnected">LinkedIn</a> <a class="profile-nw nw-linkedin" ng-href="{{liProfileUrl}}" target="_blank" ng-show="isLinkedInConnected">LinkedIn</a> <span class="profile-nw-connected"><span class="profile-placeholder">&nbsp;</span> <span class="profile-connected">Connected</span> <a class="profile-disconnect" href="javascript:" ng-click="disconnectLinkedIn()">Disconnect?</a></span></li></ul></div><hr class="profile-section-divider"><div class="profile-section" kf-email-import=""></div></div></div></div>')}]),angular.module("profile/profileChangePassword.tpl.html",[]).run(["$templateCache",function(a){a.put("profile/profileChangePassword.tpl.html",'<div class="profile-change-password"><a class="profile-change-password-title-wrapper" href="javascript:" ng-click="toggle()"><span class="profile-setting-arrow-right" ng-show="!isOpen"></span> <span class="profile-setting-arrow-down" ng-show="isOpen"></span> <span class="profile-change-password-title">Change your password</span></a><div class="profile-change-password-change" ng-show="isOpen"><div class="profile-input-wrapper profile-old-password"><div class="profile-input-title">Enter your current password</div><div class="profile-input-box"><input class="profile-input-input" ng-model="inputs.oldPassword" type="password" name="old-password" placeholder="Existing Password" value="" novalidate></div></div><div class="profile-input-wrapper profile-new-password"><div class="profile-input-title">New Password</div><div class="profile-input-box"><input class="profile-input-input" ng-model="inputs.newPassword1" type="password" name="new-password1" placeholder="Choose a new password" value="" novalidate></div><div class="profile-input-box"><input class="profile-input-input" ng-model="inputs.newPassword2" type="password" name="new-password2" placeholder="And enter it again" value="" novalidate></div></div><div class="profile-change-password-error">{{errorMessage}}</div><div><a class="profile-change-password-save" href="javascript:" ng-click="updatePassword()">Update password</a></div></div><div class="profile-change-password-success">{{successMessage}}</div></div>')}]),angular.module("profile/profileEmailAddresses.tpl.html",[]).run(["$templateCache",function(a){a.put("profile/profileEmailAddresses.tpl.html",'<div class="profile-email-addresses"><a class="profile-email-addresses-title-wrapper" href="javascript:" ng-click="toggle()"><span class="profile-setting-arrow-right" ng-show="!isOpen"></span> <span class="profile-setting-arrow-down" ng-show="isOpen"></span> <span class="profile-email-addresses-title">Manage your email addresses</span></a><div class="profile-email-address-manage" ng-show="isOpen"><div class="profile-email-address-manage-description" ng-if="emailList.length > 0">These are the email addresses associated with your Kifi account. You may log in with them and Kifi members can find you using these email addresses via search.</div><ul class="profile-email-address-list"><li ng-repeat="email in emailList" class="profile-email-address-item"><span class="profile-email-address-item-email" ng-class="{\'profile-email-address-item-email-important\': email.isPrimary || email.isPendingPrimary || email.isPlaceholderPrimary}">{{email.address}}</span> <span class="profile-email-address-item-primary" ng-if="email.isPrimary || email.isPlaceholderPrimary">(primary)</span> <span class="profile-email-address-item-pending-primary" ng-if="email.isPendingPrimary && !email.isPrimary && !email.isPlaceholderPrimary">(pending primary)</span> <span class="profile-email-address-item-unverified" ng-if="!email.isVerified">(<a class="profile-email-pending-resend" href="javascript:" ng-click="resendVerificationEmail(email.address)">unverified</a>)</span><div class="profile-email-address-item-arrow" href="javascript:" ng-if="!(email.isPrimary || email.isPendingPrimary || email.isPlaceholderPrimary)" ng-click="openDropdownForEmail($event, email.address)"><ul class="profile-email-address-item-dropdown" ng-show="emailWithActiveDropdown === email.address"><li><a class="profile-email-address-item-make-primary" href="javascript:" ng-if="email.isVerified" ng-click="makePrimary(email.address)">Make primary</a></li><li><a class="profile-email-address-item-delete" href="javascript:" ng-click="deleteEmail(email.address)">Delete</a></li></ul></div></li></ul><a class="profile-email-address-add" href="javascript:" ng-click="enableAddEmail()" ng-show="!(state.editing || state.invalid)">+ add a new email address</a><div class="profile-email-address-add-box" ng-show="state.editing || state.invalid"><div kf-profile-input="" input-state="state" input-validate-action="validateEmail(value)" input-save-action="addEmail(value)" action-label="Add"><input class="profile-email-address-add-input" kf-focus-if="" focus-cond="state.editing" ng-model="state.value" type="text" name="new_email" placeholder="Type a new email address"></div></div><div kf-modal="" show="showEmailDeleteDialog.value"><div kf-basic-modal-content="" with-cancel="" with-warning="" title="Delete {{emailToBeDeleted}}?" action-text="Delete" action="confirmDeleteEmail()"><p>Are you sure you want to delete this email address?</p><ul><li>You will not be able to login with this email address</li><li>Your friends will not be able to find you by this email address</li></ul></div></div></div></div>')}]),angular.module("profile/profileImage.tpl.html",[]).run(["$templateCache",function(a){a.put("profile/profileImage.tpl.html",'<div class="profile-image-wrapper"><div class="profile-image" ng-click="selectFile()" ng-style="{\'background-image\': \'url(\' + picUrl + \')\'}"></div><label class="profile-image-label"><a class="profile-image-change" href="javascript:" ng-click="selectFile()">Change photo</a><input class="profile-image-file" type="file" name="photo" accept="image/*" onchange="angular.element(this).scope().fileChosen(this.files)"></label><div kf-modal="" show="showImageEditDialog.value"><div kf-basic-modal-content="" with-cancel="" title="Position and size of your photo" action-text="Submit" action="uploadImage()" cancel="resetChooseImage()"><div class="kf-profile-image-dialog-image"><div class="kf-profile-image-dialog-mask"></div></div><div class="kf-profile-image-dialog-slider" ui-slider="zoomSlider" ng-model="zoomSlider.value"></div></div></div><div kf-modal="" no-user-hide="" show="showImageUploadingModal.value"><div class="dialog-body-wrap"><div class="dialog-header">Uploading image...</div></div></div><div kf-modal="" show="showImageUploadFailedDialog.value"><div kf-basic-modal-content="" with-warning=""><div class="dialog-header dialog-warning">Sorry, we could not upload your image. Please try again later.</div></div></div></div>')}]),angular.module("profile/profileInput.tpl.html",[]).run(["$templateCache",function(a){a.put("profile/profileInput.tpl.html",'<div class="profile-input-box"><div ng-class="{ error: state.invalid }"><div ng-transclude=""></div><div class="input-error" ng-show="state.invalid"><div class="error-header" ng-bind-html="errorHeader"></div><div class="error-body" ng-bind-html="errorBody"></div></div></div><a class="profile-input-edit" href="javascript:" ng-hide="state.editing" ng-click="edit()" ng-if="explicitEnabling">Edit</a> <a class="profile-input-save" href="javascript:" ng-show="!explicitEnabling || state.editing" ng-click="save()">{{actionLabel || \'Save\'}}</a></div>')}]),angular.module("profileCard/profileCard.tpl.html",[]).run(["$templateCache",function(a){a.put("profileCard/profileCard.tpl.html",'<div class="kf-my-identity"><a class="kf-my-settings-wrapper" href="/profile"><span class="kf-my-pic" ng-style="{\'background-image\': \'url(\' + me.picUrl + \')\'}"></span> <span class="kf-my-settings-shade"></span> <span class="kf-my-settings"><span class="kf-my-settings-icon"></span> <span class="kf-my-settings-text">Settings</span></span></a><div class="kf-my-name">{{me.firstName}} {{me.lastName}}</div><div class="kf-my-description" ng-if="me.description">{{me.description}}</div><div class="kf-help-rank" ng-if="me.totalKeepsClicked > 0" ng-click="openHelpRankHelp()"><hr ng-if="me.description"><div><span class="kf-heart">♥</span> Your Keeps helped friends {{me.totalKeepsClicked}} times</div></div><div kf-modal="" ng-if="data.showHelpRankHelp" show="data.showHelpRankHelp"><div kf-basic-modal-content="" centered="true" single-action="false"><div class="kf-help-rank-help"><div class="kf-block-top">The vision of Kifi is about people helping people.<br>Here\'s where you come in:</div><div class="kf-block"><span class="kf-emph">{{me.uniqueKeepsClicked}}</span> of your public keeps have been clicked on <span class="kf-emph">{{me.totalKeepsClicked}}</span> times by your friends<br>when they searched on Google or Kifi.com</div><div class="kf-block-bottom">Do you like this feedback?<div class="dialog-buttons"><button ng-click="yesLikeHelpRank()">Yes</button> <button ng-click="noLikeHelpRank()">No</button></div></div></div></div></div></div>')}]),angular.module("search/search.tpl.html",[]).run(["$templateCache",function(a){a.put("search/search.tpl.html",'<div class="kf-main-search"><div class="kf-main-head"><div class="kf-subtitle"><span class="kf-check-all" ng-class="{ enabled: isCheckEnabled(), checked: isSelectedAll(), \'multi-checked\': isMultiChecked() }" ng-click="toggleSelectAll()" ng-mouseover="onMouseoverCheckAll()" ng-mouseout="onMouseoutCheckAll()"></span> <span class="kf-subtitle-text">{{getSubtitle()}}</span> <span class="kf-search-filters"><a class="kf-search-filter" ng-class="{ selected: isFilterSelected(\'m\'), enabled: isEnabled(\'m\') }" ng-href="{{getFilterUrl(\'m\')}}">Your keeps ({{results.myTotal}})</a> <a class="kf-search-filter" ng-class="{ selected: isFilterSelected(\'f\'), enabled: isEnabled(\'f\') }" ng-href="{{getFilterUrl(\'f\')}}">Friends keeps ({{results.friendsTotal}})</a> <a class="kf-search-filter" ng-class="{ selected: isFilterSelected(\'a\'), enabled: isEnabled(\'a\') }" ng-href="{{getFilterUrl(\'a\')}}">All keeps</a></span></div></div><div kf-keeps="" keeps="keeps" keeps-loading="loading" keeps-has-more="hasMore()" scroll-distance="scrollDistance" scroll-disabled="scrollDisabled" scroll-next="getNextKeeps()" keep-click="analyticsTrack"></div></div>')}]),angular.module("social/addNetworksModal.tpl.html",[]).run(["$templateCache",function(a){a.put("social/addNetworksModal.tpl.html",'<div kf-modal="" ng-if="data.showAddNetworks" show="data.showAddNetworks" kf-width="750px"><div kf-basic-modal-content="" centered="true" action-text="Done!"><div kf-social-connect-networks=""></div></div></div>')}]),angular.module("social/connectNetworks.tpl.html",[]).run(["$templateCache",function(a){a.put("social/connectNetworks.tpl.html",'<div class="social-connect" ng-show="data.show"><div class="social-connect-title">Connect your social networks to Kifi</div><p class="social-connect-desc">Connect your networks to quickly find people you may know already using Kifi.</p><div class="social-connect-buttons"><div class="social-connect-row"><div ng-if="facebook.profileUrl"><div class="social-connected-button facebook">Facebook Connected</div><span class="social-notice-badge" ng-if="facebookStatus() === \'good\'"><span class="notice-button good"></span></span> <span class="social-notice-badge" ng-if="facebookStatus() === \'refreshing\'"><span class="notice-message import"><div class="bouncy-ball"><div class="pace pace-active"><div class="pace-progress"></div><div class="pace-activity"></div></div></div>Importing your contacts</span></span> <span class="social-notice-badge" ng-if="facebookStatus() === \'expired\'" ng-click="connectFacebook()"><span class="notice-button warn">!</span> <span class="notice-message refresh">Refresh connection</span></span></div><div ng-if="!facebook.profileUrl"><div class="social-connect-button facebook" ng-click="connectFacebook()">Connect Facebook</div></div></div><div class="social-connect-row"><div ng-if="linkedin.profileUrl"><div class="social-connected-button linkedin">LinkedIn Connected</div><span class="social-notice-badge" ng-if="linkedinStatus() === \'good\'"><span class="notice-button good"></span></span> <span class="social-notice-badge" ng-if="linkedinStatus() === \'refreshing\'"><span class="notice-message import"><div class="bouncy-ball"><div class="pace pace-active"><div class="pace-progress"></div><div class="pace-activity"></div></div></div>Importing your contacts</span></span> <span class="social-notice-badge" ng-if="linkedinStatus() === \'expired\'" ng-click="connectLinkedIn()"><span class="notice-button warn">!</span> <span class="notice-message refresh">Refresh connection</span></span></div><div ng-if="!linkedin.profileUrl"><div class="social-connect-button linkedin" ng-click="connectLinkedIn()">Connect LinkedIn</div></div></div><div class="social-connect-row" ng-if="gmail.length === 0"><div class="social-connect-button gmail" ng-click="importGmail()">Connect Gmail</div></div><div ng-repeat="account in gmail" ng-if="gmail.length > 0"><div class="social-connect-row social-extended"><div class="social-connected-button gmail">Gmail Connected<div class="social-account-name">{{account.ownerEmail}}</div></div><span class="social-notice-badge"><span class="notice-button good"></span></span></div></div><div class="social-more-accounts" ng-if="gmail.length > 0" ng-click="importGmail()">Refresh/Add more Gmail accounts</div></div></div>')}]),angular.module("social/networksNeedAttention.tpl.html",[]).run(["$templateCache",function(a){a.put("social/networksNeedAttention.tpl.html",'<div class="kf-networks-need-attention" ng-if="networksNeedAttention()"><div kf-alert-banner="" action-text="Fix it" action="doShow">One or more of your connected social networks needs your attention</div></div>')}]),angular.module("tagKeeps/tagKeeps.tpl.html",[]).run(["$templateCache",function(a){a.put("tagKeeps/tagKeeps.tpl.html",'<div class="kf-main-tag-keeps"><div class="kf-main-head"><h1 class="kf-main-title">Tags / {{tag.name}}</h1><div class="kf-subtitle"><span class="kf-check-all" ng-class="{ enabled: isCheckEnabled(), checked: isSelectedAll(), \'multi-checked\': isMultiChecked() }" ng-click="toggleSelectAll()" ng-mouseover="onMouseoverCheckAll()" ng-mouseout="onMouseoutCheckAll()"></span> <span class="kf-subtitle-text">{{getSubtitle()}}</span></div></div><div kf-keeps="" keeps="keeps" keeps-loading="loading" keeps-has-more="hasMore()" scroll-distance="scrollDistance" scroll-disabled="scrollDisabled" scroll-next="getNextKeeps()"></div></div>')}]),angular.module("tags/tagItem.tpl.html",[]).run(["$templateCache",function(a){a.put("tags/tagItem.tpl.html",'<li class="kf-nav-item kf-tag clickable" ng-mouseenter="enableHover()" ng-mouseleave="disableHover()"><div class="kf-nav-link" ng-class="{ renaming: isRenaming, \'kf-dragged\': isDragging, \'kf-drag-target\': isDragTarget, hover: isHovering }" ng-click="navigateToTag($event)" ui-draggable="true" drag="tag" drag-channel="tagDragChannel" ui-on-drop="onKeepDrop($data)" drop-channel="keepDragChannel" drag-enter-class="kf-candidate-drag-target"><div class="kf-tag-drag-container" ui-on-drop="onTagDrop($data)" drop-channel="tagDragChannel" drag-enter-class="kf-candidate-tag-drag-target"><div class="kf-tag-info"><span class="kf-tag-icon"></span> <span ng-show="!isRenaming"><span class="kf-tag-name">{{tag.name}}</span> <span class="kf-tag-count" ng-show="!isWaiting">{{tag.keeps}}</span><div class="kf-tag-waiting" ng-show="isWaiting"></div></span></div><div class="kf-tag-tools" ng-show="!isRenaming" ng-class="{ open: isDropdownOpen }" ng-click="$event.stopPropagation()"><div class="kf-tag-dropdown-toggle" ng-show="!isDragging" ng-click="toggleDropdown()"><div class="kf-tag-tool-icon"></div></div><div class="kf-tag-handle"><div class="kf-tag-tool-icon"></div></div><ul class="kf-dropdown-menu" ng-show="isDropdownOpen"><li><a href="javascript:" ng-click="setRenaming()">Rename</a></li><li><a href="javascript:" ng-click="remove()">Remove</a></li></ul></div><input class="kf-tag-rename" type="text" placeholder="Type new tag name" ng-model="renameTag.value" ng-keydown="onRenameKeydown($event)" ng-show="isRenaming"><div class="kf-drag-mask"></div><div class="kf-tag-drag-mask"></div><div class="kf-tag-new-location-mask hidden"></div></div></div></li>')}]),angular.module("tags/tags.tpl.html",[]).run(["$templateCache",function(a){a.put("tags/tags.tpl.html",'<div class="kf-tags"><div class="kf-nav-group-name">Tags</div><label class="kf-nav-item kf-tag-input-box"><input kf-no-drag-input="" name="filterName" placeholder="Find or add a tag..." ng-model="filter.name" focus-when="focusFilter" ng-change="onFilterChange()" ng-keydown="onKeydown($event)" ng-blur="dehighlight()"><a class="kf-tag-input-clear" href="javascript:" ng-click="clearFilter(true)" ng-show="filter.name">&times;</a></label><div class="kf-tag-list-hidden"></div><ul class="kf-tag-list" antiscroll="{ autoHide: false }"><li kf-tag-item="" tag="tag" take-focus="unfocus()" release-focus="refocus()" has-new-location="newLocationTagId === tag.id" watch-tag-reorder="watchTagReorder()" reorder-tag="reorderTag(isTop,srcTag,dstTag)" received-tag-drag="receivedTagDrag()" view-tag="viewTag(tagId)" remove-tag="removeTag(tag)" ng-class="{ active: isActiveTag(tag), highlight: isHighlight(tag), new: tag.isNew }" ng-repeat="tag in tags"></li><li class="kf-nav-item kf-tag kf-tag-new" ng-class="{ highlight: isHighlightNew() }" ng-show="showAddTag()"><a href="javascript:" ng-click="create(filter.name)"><span class="kf-tag-icon kf-tag-icon-create"></span> <span class="kf-tag-caption">Add a new tag:</span> <span class="kf-tag-name">{{filter.name}}</span></a></li></ul></div>')}]);