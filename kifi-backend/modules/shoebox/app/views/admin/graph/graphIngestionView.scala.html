@(allInstances: Seq[com.keepit.common.amazon.AmazonInstanceId],
  statistics: Map[com.keepit.common.amazon.AmazonInstanceId, com.keepit.graph.manager.PrettyGraphStatistics],
  states: Map[com.keepit.common.amazon.AmazonInstanceId, com.keepit.graph.manager.GraphUpdaterState]
)
@import com.keepit.graph.manager.GraphUpdateKind

@views.html.admin.admin("Ingestion") {

  <h3>Vertex Statistics</h3>
    <table class = "table table-bordered">
      <tr> <th>Vertex</th> @allInstances.map { instanceId => <th>@instanceId</th> } </tr>
      @statistics.values.flatMap(_.vertexStatistics.keySet).toSet.map { vertexType: String =>
        <tr> <td>@vertexType</td> @allInstances.map { instanceId => <td>@statistics.get(instanceId).flatMap(_.vertexStatistics.get(vertexType))</td> } </tr>
      }
    </table>

  <h3>Edge Statistics</h3>
    <table class = "table table-bordered">
      <tr> <th>Edge</th> @allInstances.map { instanceId => <th>@instanceId</th> } </tr>
      @statistics.values.flatMap(_.edgeStatistics.keySet).toSet.map { edgeType: (String, String, String) => @edgeType match { case (sourceKind, destinationKind, edgeKind) =>
        <tr> <td>@edgeKind | @sourceKind -> @destinationKind</td> @allInstances.map { instanceId => <td>@statistics.get(instanceId).flatMap(_.edgeStatistics.get((sourceKind, destinationKind, edgeKind)))</td> } </tr>
      }}
    </table>

  <h3>Graph Updater State</h3>
    <table class = "table table-bordered">
      <tr> <th>GraphUpdate</th> @allInstances.map { instanceId => <th>@instanceId</th> } </tr>
        @com.keepit.graph.manager.GraphUpdateKind.all.map { updateKind: GraphUpdateKind[_ <: com.keepit.graph.manager.GraphUpdate] =>
        <tr> <td>@updateKind.toString</td> @allInstances.map { instanceId => <td>@states.get(instanceId).map(_.getCurrentSequenceNumber(updateKind))</td> } </tr>
      }
    </table>
}