@(pending:Seq[ScrapeInfo], count:Int, threadDetailsSeq:Seq[com.keepit.scraper.ScraperThreadDetails])(implicit flash: Flash)

@import com.keepit.controllers.admin.routes

<div>
    <span class="title-hint">
        @defining(if (count == 1) "result" else "results") { result =>
            @if(pending.length == count) {
                <span>(@count @result)</span>
            } else {
                <span>(showing @pending.length out of @count @result)</span>
            }
        }
    </span>

    <div class="request-table">
        <table class="table table-condensed table-striped">
            <tr>
                <th class="span1">Id</th>
                <th class="span1">uriId</th>
                <th class="span2">lastScrape</th>
                <th class="span2">nextScrape</th>
                <th class="span1">interval</th>
                <th class="span1">failures</th>
                <th class="span1">state</th>
                <th class="span1">signature</th>
                <th class="span2">destUrl</th>
            </tr>
            @for(info <- pending) {
            <tr>
                <td>@info.id</td>
                <td><a href="@com.keepit.controllers.admin.routes.AdminBookmarksController.editFirstBookmarkForUri(info.uriId)">@info.uriId</a></td>
                <td>@adminHelper.dateTimeDisplay(info.lastScrape)</td>
                <td>@adminHelper.dateTimeDisplay(info.nextScrape)</td>
                <td>@info.interval</td>
                <td>@info.failures</td>
                <td>@info.state</td>
                <td>@info.signature.take(20)</td>
                <td><a href="@info.destinationUrl">@info.destinationUrl</a></td>
            </tr>
            }
        </table>
    </div>

    <span class="thread-details-hint">(@threadDetailsSeq.length @if(threadDetailsSeq.length == 1) {instance} else {instances})</span>

    <div class="thread-details">
        <table class="table table-bordered">
            @for(threadDetails <- threadDetailsSeq) {
                <tr><td>
                    @adminHelper.instanceInfoModal(threadDetails.info.instanceId.toString, threadDetails.info)
                    <h5>Instance ID: <a href="#" onClick="$('#@threadDetails.info.instanceId.toString').modal('show'); return false;">@threadDetails.info.instanceId.toString</a></h5>
                    <table class="table table-condensed table-bordered table-striped">
                        @for(details <- threadDetails.forkJoinThreadDetails) {
                            <tr><td>@details</td></tr>
                        }
                    </table>
                </td></tr>
            }
        </table>
    </div>
</div>