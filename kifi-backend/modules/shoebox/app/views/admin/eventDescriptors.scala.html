@(descriptorsByRepo: (com.keepit.serializer.TypeCode[com.keepit.heimdal.HeimdalEvent], Seq[com.keepit.heimdal.EventDescriptor])*)

@admin("Heimdal Events", stylesheets = List("admin_analytics")) {

<form class="descriptors" action="@com.keepit.controllers.admin.routes.AdminAnalyticsController.updateEventDescriptors" method="POST">
    @for((code, descriptors) <- descriptorsByRepo) {
        <h3>@code.code.capitalize</h3>
        <table class="table table-condensed table-striped">

    <thead>
      <tr>
        <th>Type
        <th>Event Name
        <th>Description
        <th>Send to Mixpanel
        <th>Latest Events
    </thead>
      @for(descriptor <- descriptors) {
        <tr>
          <td> @code.code
          <td> @descriptor.name.name
          <td><input type="text" name="@code.code:@descriptor.name.name:description" placeholder="Add a description for this event" value="@descriptor.description.getOrElse("")">
          <td><input type="checkbox" class="checkbox" name="@code.code:@descriptor.name.name:mixpanel" @if(descriptor.mixpanel) {checked}>
          <td><a href="@com.keepit.controllers.admin.routes.AdminAnalyticsController.getEvents(code.code, Some(descriptor.name.name))">See Events</a>
      }
  </table>
    }
    <button type="submit" class="btn btn-primary" data-loading-text="Saving...">Save</button>
  <button type="reset" class="btn">Clear unsaved changes</button>
</form>
}

<script>
$(function() {
  $(".descriptors").submit(function() { $(this).find("button[type=submit]").button("loading");})
});
</script>
