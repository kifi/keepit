@(userId: Id[User],
libFollows: com.keepit.model.CountData[Library],
libViews: com.keepit.model.CountData[Library],
keepViews: com.keepit.model.CountData[Keep],
rekeeps: com.keepit.model.CountData[Keep]
)
@import com.keepit.common.mail.template.helpers._
@import com.keepit.model.GratificationData._
@singularOrPlural(word: String, quantity: Int) = @{ quantity match { case 1 => word; case _ => word + "s" } }
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<p>Hey @firstName(userId),</p>

@if(libFollows.totalCount >= MIN_FOLLOWS) {
<p>You had <b>@{libFollows.totalCount} @singularOrPlural("follow", libFollows.totalCount)</b> across all of your libraries:</p>
<ul>
    @for((libId, followCount) <- libFollows.sortedCountById.take(LIST_LIMIT)) {
    <li>@{followCount} @singularOrPlural("follow", followCount) on <a href=@libraryUrl(libId, "gratLibUrl")>@libraryName(libId)</a></li>
    }
</ul>
}

@if(libViews.totalCount >= MIN_LIB_VIEWS) {
<p>You had <b>@{libViews.totalCount} @singularOrPlural("view", libViews.totalCount)</b> across all of your libraries:</p>
<ul>
    @for((libId, viewCount) <- libViews.sortedCountById.take(LIST_LIMIT)) {
    <li>@{viewCount} @singularOrPlural("view", viewCount) on <a href=@libraryUrl(libId, "gratLibUrl")>@libraryName(libId)</a></li>
    }
</ul>
}

@if(keepViews.totalCount >= MIN_KEEP_VIEWS) {
<p>You had <b>@{keepViews.totalCount} @singularOrPlural("view", keepViews.totalCount)</b> across all of your keeps:</p>
<ul>
    @for((keepId, viewCount) <- keepViews.sortedCountById.take(LIST_LIMIT)) {
    <li>@{viewCount} @singularOrPlural("view", viewCount) on <a href=@keepUrl(keepId, "gratKeepUrl")>@keepName(keepId)</a></li>
    }
</ul>
}

@if(rekeeps.totalCount >= MIN_REKEEPS) {
<p>You had <b>@{rekeeps.totalCount} total @singularOrPlural("rekeep", rekeeps.totalCount)</b>:</p>
<ul>
    @for((keepId, count) <- rekeeps.sortedCountById.take(LIST_LIMIT)) {
    <li>@{count} @singularOrPlural("rekeep", count) on <a href=@keepUrl(keepId, "gratRekeepUrl")>@keepName(keepId)</a></li>
    }
</ul>
}

@if(libViews.totalCount >= MIN_LIB_VIEWS || keepViews.totalCount >= MIN_KEEP_VIEWS || rekeeps.totalCount >= MIN_REKEEPS || libFollows.totalCount >= MIN_FOLLOWS){
<p>What other stats would you like to see? Please let us know if you have any questions, suggestions, or comments about Kifi!</p>
} else {
We at Kifi hope you're having a great week.
}

<p>Cheers,<br>
The Kifi Team<br>

<p>P.S. We send these emails to inform you of new library views, followers, and keep views. If you don't want to see these stats, <a href="@unsubscribeUrl">unsubscribe</a>.</p>
</body>
</html>
