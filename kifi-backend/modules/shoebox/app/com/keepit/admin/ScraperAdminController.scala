package com.keepit.controllers.admin

import com.google.inject.Inject
import com.keepit.common.controller.{ UserActionsHelper, AdminUserActions }
import com.keepit.common.db.Id
import com.keepit.common.db.slick.Database
import com.keepit.model._
import com.keepit.search.ArticleStore
import views.html
import com.keepit.common.db.slick.Database.Replica
import play.api.libs.concurrent.Execution.Implicits._
import com.keepit.scraper.ScrapeScheduler
import play.api.mvc.Action
import com.keepit.scraper.ScraperServiceClient
import scala.concurrent.Future
import play.api.libs.json.Json
import com.keepit.common.akka.SafeFuture
import play.api.libs.iteratee.{ Concurrent, Enumerator }

class ScraperAdminController @Inject() (
  val userActionsHelper: UserActionsHelper,
  db: Database,
  uriRepo: NormalizedURIRepo,
  scrapeInfoRepo: ScrapeInfoRepo,
  scrapeScheduler: ScrapeScheduler,
  normalizedURIRepo: NormalizedURIRepo,
  articleStore: ArticleStore,
  httpProxyRepo: HttpProxyRepo,
  scraperServiceClient: ScraperServiceClient)
    extends AdminUserActions {

  val MAX_COUNT_DISPLAY = 25

  def status = AdminUserAction.async { implicit request =>
    Future.sequence(scraperServiceClient.status()).map { res =>
      Ok(Json.toJson(res.map { case (_, jobs) => jobs }.flatten))
    }
  }

  def searchScraper = AdminUserPage { implicit request => Ok(html.admin.searchScraper()) }

  def scraperRequests(stateFilter: Option[String] = None) = AdminUserPage.async { implicit request =>
    val resultsFuture = db.readOnlyReplicaAsync { implicit ro =>
      (
        scrapeInfoRepo.getAssignedList(MAX_COUNT_DISPLAY),
        scrapeInfoRepo.getOverdueList(MAX_COUNT_DISPLAY),
        scrapeInfoRepo.getAssignedCount(),
        scrapeInfoRepo.getOverdueCount()
      )
    }
    val threadDetailsFuture = Future.sequence(scraperServiceClient.getThreadDetails(stateFilter))
    for {
      (assigned, overdue, assignedCount, overdueCount) <- resultsFuture
      threadDetails <- threadDetailsFuture
    } yield Ok(html.admin.scraperRequests(assigned, overdue, assignedCount, overdueCount, threadDetails))
  }

  def scrapeArticle(url: String) = AdminUserPage.async { implicit request =>
    scrapeScheduler.scrapeBasicArticle(url, None) map { articleOpt =>
      articleOpt match {
        case None => Ok(s"Failed to scrape $url")
        case Some(article) => Ok(s"For $url, article:${article.toString}")
      }
    }
  }

  def rescrapeByRegex() = AdminUserPage { implicit request =>
    val body = request.body.asFormUrlEncoded.get.mapValues(_(0))
    val urlRegex = body.getOrElse("urlRegex", "")
    val withinMinutes = body.getOrElse("withinMinutes", "8").toInt
    val updateCount = db.readWrite { implicit session =>
      scrapeInfoRepo.setForRescrapeByRegex(urlRegex, withinMinutes)
    }
    Redirect(com.keepit.controllers.admin.routes.ScraperAdminController.searchScraper).flashing(
      "success" -> "%s page(s) matching %s to be rescraped within %s minutes(s). ".format(updateCount, urlRegex, withinMinutes)
    )
  }

  def getScraped(id: Id[NormalizedURI]) = AdminUserPage { implicit request =>
    val articleOption = articleStore.get(id)
    val (uri, scrapeInfoOption) = db.readOnlyReplica { implicit s => (normalizedURIRepo.get(id), scrapeInfoRepo.getByUriId(id)) }
    Ok(html.admin.article(articleOption, uri, scrapeInfoOption))
  }

  def getProxies = AdminUserPage { implicit request =>
    val proxies = db.readOnlyReplica { implicit session => httpProxyRepo.all() }
    Ok(html.admin.proxies(proxies))
  }

  def saveProxies = AdminUserPage { implicit request =>
    val body = request.body.asFormUrlEncoded.get.mapValues(_(0))
    db.readWrite { implicit session =>
      for (key <- body.keys.filter(_.startsWith("alias_")).map(_.substring(6))) {
        val id = Id[HttpProxy](key.toLong)
        val oldProxy = httpProxyRepo.get(id)
        val newProxy = oldProxy.copy(
          state = if (body.contains("active_" + key)) HttpProxyStates.ACTIVE else HttpProxyStates.INACTIVE,
          alias = body("alias_" + key),
          hostname = body("hostname_" + key),
          port = body("port_" + key).toInt,
          scheme = body("scheme_" + key),
          username = Some(body("username_" + key)).filter(!_.isEmpty),
          password = Some(body("password_" + key)).filter(!_.isEmpty)
        )

        if (newProxy != oldProxy) {
          httpProxyRepo.save(newProxy)
        }
      }
      val newProxy = body("new_alias")
      if (newProxy.nonEmpty) {
        httpProxyRepo.save(HttpProxy(
          state = if (body.contains("new_active")) HttpProxyStates.ACTIVE else HttpProxyStates.INACTIVE,
          alias = body("new_alias"),
          hostname = body("new_hostname"),
          port = body("new_port").toInt,
          scheme = body("new_scheme"),
          username = Some(body("new_username")).filter(!_.isEmpty),
          password = Some(body("new_password")).filter(!_.isEmpty)
        ))
      }
    }
    Redirect(routes.ScraperAdminController.getProxies)
  }

  def getPornDetectorModel = AdminUserPage.async { implicit request =>
    val modelFuture = scraperServiceClient.getPornDetectorModel()
    for (model <- modelFuture) yield Ok(Json.toJson(model))
  }

  def massMarkAsAdult() = AdminUserPage { implicit request =>
    val data: Seq[Id[NormalizedURI]] = Seq(8672, 10368, 10410, 19613, 21760, 34193, 37218, 210740, 468981, 475137, 476250, 765205, 771011, 775300, 776596, 777486, 777490, 933860, 933992, 943346, 943348, 959063, 960072, 960854, 960856, 960858, 960859, 960862, 960864, 960866, 960868, 960870, 960872, 960874, 960876, 960878, 960880, 960882, 960884, 960885, 961674, 961682, 961738, 961755, 961984, 961991, 961994, 961999, 962002, 962007, 962188, 962190, 962465, 962466, 962470, 962699, 962700, 962701, 962702, 962704, 962705, 962794, 962797, 962811, 962812, 962814, 963179, 963180, 963186, 963187, 963188, 963191, 963200, 963202, 963205, 963207, 963209, 963210, 963211, 963212, 963213, 963214, 963215, 963216, 963547, 966264, 970084, 972599, 977816, 977921, 977951, 978587, 978915, 978918, 978930, 978932, 979700, 979701, 979702, 979703, 979704, 979705, 979706, 979707, 979708, 979709, 979710, 979711, 979712, 979713, 979714, 979715, 979716, 979717, 979718, 979719, 979720, 979721, 979722, 979723, 979724, 979725, 979726, 979727, 979728, 979729, 979730, 979731, 979732, 979733, 979734, 979735, 979736, 979737, 979738, 979739, 979740, 979741, 979745, 979747, 979748, 979749, 979750, 979752, 979753, 979754, 979755, 979756, 979757, 979759, 979761, 979762, 979763, 979764, 979766, 979767, 979769, 979771, 979772, 979773, 979774, 979775, 979776, 979777, 979778, 979780, 979781, 979782, 979783, 979785, 979787, 979788, 979789, 979790, 979791, 979792, 979793, 979794, 979797, 979799, 979800, 979801, 979803, 979804, 979805, 979806, 979807, 979808, 979810, 979811, 979812, 979813, 979814, 979815, 979816, 979818, 979819, 979820, 979821, 979822, 979823, 979828, 979830, 979831, 979833, 979835, 979837, 979838, 979839, 979840, 979841, 979842, 979843, 979844, 979845, 979847, 979848, 979849, 979854, 979855, 979856, 979857, 979858, 979859, 979860, 979861, 979866, 979868, 979869, 979870, 979872, 979875, 979876, 979879, 979880, 979881, 979882, 979883, 979884, 979885, 979886, 979887, 979894, 979895, 979896, 979897, 979898, 979899, 979900, 979901, 979902, 979903, 979904, 979905, 979906, 979907, 979908, 979909, 979910, 979911, 979912, 979916, 979917, 979918, 979922, 979924, 979925, 979926, 979927, 979928, 979929, 979930, 979931, 979932, 979933, 979935, 979937, 979938, 979939, 979940, 979941, 979942, 979943, 979944, 979945, 979946, 979947, 979948, 979949, 979950, 979951, 979952, 979954, 979958, 979959, 979960, 979962, 979963, 979964, 979965, 979966, 979968, 979969, 979970, 979971, 979972, 979973, 979974, 979976, 979977, 979980, 979981, 979982, 979983, 979984, 979985, 979986, 979987, 979988, 979989, 979991, 979992, 979993, 979994, 979995, 979996, 979997, 979998, 979999, 980000, 980001, 980002, 980003, 980005, 980006, 980008, 980009, 980010, 980011, 980012, 980013, 980015, 980016, 980017, 980018, 980019, 980020, 980022, 980023, 980024, 980025, 980027, 980028, 980029, 980030, 980031, 980032, 980033, 980034, 980035, 980036, 980037, 980038, 980040, 980044, 980047, 980048, 980049, 980050, 980051, 980053, 980054, 980055, 980056, 980057, 980062, 980063, 980064, 980065, 980066, 980067, 980068, 980071, 980072, 980073, 980074, 980075, 980076, 980077, 980079, 980081, 980082, 980083, 980084, 980085, 980086, 980087, 980088, 980089, 980092, 980093, 980094, 980095, 980096, 980097, 980098, 980100, 980101, 980102, 980104, 980105, 980106, 980107, 980108, 980110, 980111, 980112, 980113, 980114, 980115, 980116, 980117, 980119, 980120, 980121, 980122, 980123, 980124, 980125, 980130, 980131, 980132, 980133, 980134, 980135, 980136, 980137, 980138, 980139, 980140, 980141, 980142, 980143, 980144, 980145, 980147, 980148, 980149, 980150, 980152, 980153, 980154, 980155, 980156, 980157, 980158, 980159, 980160, 980161, 980162, 980163, 980164, 980166, 980167, 980168, 980169, 980171, 980172, 980174, 980175, 980176, 980177, 980178, 980179, 980180, 980181, 980182, 980183, 980184, 980185, 980186, 980187, 980189, 980190, 980192, 980193, 980194, 980196, 980197, 980198, 980199, 980200, 980201, 980202, 980203, 980204, 980205, 980206, 980207, 980208, 980209, 980210, 980211, 980212, 980214, 980215, 980216, 980217, 980219, 980220, 980221, 980222, 980223, 980224, 980226, 980227, 980229, 980230, 980231, 980232, 980233, 980235, 980236, 980237, 980238, 980239, 980240, 980241, 980243, 980244, 980245, 980248, 980249, 980250, 980251, 980252, 980253, 980254, 980255, 980256, 980257, 980258, 980259, 980260, 980261, 980262, 980263, 980264, 980265, 980267, 980268, 980269, 980270, 980271, 980272, 980273, 980274, 980275, 980276, 980277, 980278, 980279, 980280, 980281, 980282, 980284, 980285, 980286, 980287, 980288, 980290, 980291, 980292, 980293, 980294, 980295, 980296, 980297, 980298, 980300, 980301, 980302, 980303, 980304, 980305, 980306, 980307, 980308, 980309, 980310, 980311, 980312, 980313, 980314, 980317, 980318, 980321, 980322, 980323, 980324, 980327, 980330, 980332, 980333, 980335, 980336, 980338, 980339, 980340, 980341, 980342, 980343, 980345, 980346, 980348, 980349, 980350, 980353, 980354, 980355, 980357, 980359, 980360, 980362, 980363, 980364, 980365, 980368, 980369, 980370, 980371, 980372, 980373, 980374, 980375, 980376, 980378, 980379, 980381, 980382, 980384, 980385, 980386, 980388, 980389, 980391, 980392, 980393, 980396, 980398, 980399, 980403, 980407, 980409, 980410, 980411, 980412, 980416, 980423, 980424, 980425, 980426, 980427, 980435, 980436, 980440, 980441, 980442, 980444, 980445, 980449, 980451, 980453, 980454, 980455, 980459, 980460, 980463, 980464, 980465, 980466, 980467, 980468, 980470, 980471, 980472, 980473, 980474, 980477, 980478, 980483, 980484, 980485, 980487, 980490, 980493, 980500, 980501, 980502, 980504, 980508, 980510, 980511, 980512, 980513, 980514, 980516, 980517, 980522, 980524, 980525, 980526, 980528, 980529, 980531, 980533, 980534, 980536, 980537, 980538, 980539, 980541, 980545, 980546, 980547, 980548, 980549, 980550, 980551, 980553, 980554, 980555, 980556, 980558, 980560, 980562, 980564, 980567, 980568, 980569, 980570, 980571, 980572, 980574, 980577, 980578, 980579, 980581, 980582, 980583, 980585, 980586, 980588, 980593, 980594, 980595, 980597, 980598, 980600, 980601, 980602, 980603, 980604, 980606, 980607, 980608, 980609, 980610, 980611, 980612, 980613, 980614, 980615, 980616, 980617, 980618, 980620, 980624, 980625, 980627, 980629, 980631, 980633, 980635, 980636, 980639, 980642, 980645, 980647, 980648, 980654, 980656, 980658, 980664, 980666, 980667, 980668, 980671, 980672, 980673, 980675, 980677, 980679, 980680, 980681, 980682, 980683, 980684, 980685, 980686, 980687, 980688, 980689, 980690, 980691, 980692, 980693, 980694, 980696, 980697, 980698, 980699, 980700, 980701, 980702, 980705, 980707, 980708, 980709, 980710, 980711, 980712, 980713, 980714, 980716, 980717, 980718, 980719, 980720, 980721, 980722, 980723, 980724, 980727, 980728, 980729, 980730, 980731, 980733, 980734, 980735, 980736, 980737, 980738, 980740, 980741, 980742, 980748, 980750, 980751, 980752, 980754, 980757, 980758, 980760, 980761, 980763, 980765, 980766, 980768, 980769, 980770, 980771, 980773, 980776, 980778, 980779, 980783, 980784, 980785, 980786, 980787, 980788, 980789, 980790, 980791, 980792, 980793, 980794, 980795, 980796, 980798, 980799, 980801, 980803, 980804, 980805, 980806, 980807, 980808, 980809, 980810, 980811, 980812, 980814, 980815, 980817, 980819, 980820, 980821, 980822, 980823, 980825, 980828, 980829, 980830, 980832, 980834, 980839, 980840, 980844, 980845, 980848, 980849, 980851, 980852, 980853, 980854, 980855, 980856, 980863, 980866, 980867, 980873, 980875, 980877, 980878, 980879, 980880, 980881, 980882, 980883, 980884, 980886, 980887, 980890, 980892, 980893, 980895, 980896, 980901, 980902, 980903, 980906, 980909, 980910, 980911, 980912, 980915, 980916, 980918, 980920, 980922, 980924, 980925, 980926, 980929, 980931, 980932, 980933, 980935, 980936, 980937, 980938, 980946, 980949, 980950, 980951, 980952, 980955, 980958, 980959, 980961, 980962, 980964, 980966, 980968, 980969, 980970, 980971, 980972, 980973, 980976, 980978, 980979, 980980, 980981, 980982, 980983, 980984, 980985, 980986, 980987, 980988, 980989, 980991, 980992, 980994, 980997, 980998, 980999, 981001, 981002, 981004, 981005, 981006, 981007, 981008, 981009, 981010, 981011, 981012, 981014, 981015, 981016, 981017, 981018, 981019, 981021, 981023, 981025, 981026, 981027, 981028, 981029, 981030, 981032, 981036, 981039, 981041, 981042, 981043, 981044, 981045, 981046, 981047, 981048, 981050, 981052, 981053, 981054, 981056, 981057, 981058, 981059, 981060, 981061, 981062, 981064, 981066, 981068, 981074, 981076, 981078, 981080, 981082, 981084, 981086, 981090, 981092, 981094, 981096, 981098, 981100, 981102, 981104, 981106, 981116, 981118, 981120, 981124, 981132, 981134, 981140, 981143, 981145, 981151, 981153, 981155, 981157, 981159, 981161, 981163, 981165, 981167, 981169, 981171, 981174, 981176, 981178, 981180, 981184, 981186, 981188, 981192, 981194, 981200, 981202, 981204, 981206, 981208, 981210, 981214, 981216, 981220, 981222, 981224, 981226, 981228, 981230, 981236, 981238, 981240, 981242, 981244, 981246, 981248, 981250, 981254, 981256, 981258, 981260, 981262, 981264, 981266, 981270, 981274, 981276, 981278, 981284, 981286, 981290, 981292, 981294, 981296, 981300, 981304, 981308, 981310, 981312, 981314, 981316, 981318, 981320, 981322, 981328, 981331, 981333, 981335, 981339, 981348, 981349, 981350, 981352, 981354, 981356, 981358, 981360, 981362, 981366, 981370, 981371, 981372, 981376, 981377, 981379, 981382, 981383, 981384, 981385, 981386, 981387, 981388, 981389, 981392, 981393, 981394, 981397, 981399, 981400, 981401, 981402, 981403, 981404, 981406, 981407, 981408, 981409, 981410, 981412, 981413, 981414, 981417, 981418, 981419, 981420, 981421, 981422, 981423, 981424, 981425, 981426, 981427, 981428, 981429, 981430, 981431, 981432, 981433, 981434, 981435, 981439, 981440, 981442, 981445, 981446, 981447, 981448, 981449, 981450, 981451, 981452, 981453, 981454, 981455, 981456, 981460, 981461, 981462, 981463, 981464, 981465, 981466, 981467, 981469, 981470, 981471, 981472, 981473, 981474, 981475, 981476, 981477, 981478, 981479, 981480, 981481, 981482, 981483, 981484, 981485, 981486, 981487, 981488, 981489, 981490, 981491, 981492, 981493, 981494, 981497, 981498, 981499, 981500, 981501, 981502, 981505, 981506, 981507, 981509, 981510, 981511, 981512, 981513, 981515, 981519, 981520, 981521, 981523, 981527, 981528, 981529, 981531, 981532, 981533, 981534, 981536, 981537, 981538, 981539, 981541, 981542, 981543, 981544, 981545, 981546, 981547, 981549, 981551, 981552, 981553, 981555, 981556, 981557, 981558, 981560, 981563, 981565, 981566, 981568, 981569, 981570, 981571, 981572, 981573, 981576, 981577, 981583, 981587, 981590, 981592, 981594, 981595, 981596, 981597, 981602, 981603, 981606, 981607, 981608, 981613, 981614, 981615, 981616, 981617, 981618, 981620, 981622, 981623, 981624, 981626, 981628, 981631, 981632, 981633, 981634, 981638, 981639, 981640, 981645, 981649, 981653, 981655, 981662, 981663, 981665, 981668, 981670, 981671, 981672, 981673, 981674, 981675, 981677, 981679, 981680, 981681, 981682, 981684, 981685, 981686, 981687, 981689, 981690, 981692, 981694, 981695, 981696, 981697, 981698, 981699, 981700, 981701, 981702, 981703, 981704, 981705, 981706, 981707, 981710, 981711, 981712, 981717, 981718, 981720, 981721, 981722, 981723, 981724, 981728, 981729, 981730, 981731, 981735, 981736, 981737, 981738, 981739, 981740, 981743, 981745, 981746, 981749, 981750, 981751, 981752, 981753, 981757, 981758, 981760, 981763, 981765, 981767, 981768, 981769, 981770, 981771, 982037, 982038, 995762, 999776, 1001895, 1003131, 1003133, 1003135, 1004146, 1006790, 1006791, 1006971, 1018373, 1018379, 1019024, 1019069, 1019996, 1020016, 1020479, 1020492, 1020498, 1020529, 1021180, 1021510, 1021580, 1026465, 1028456, 1029108, 1029149, 1029190, 1029194, 1029200, 1029223, 1029224, 1029769, 1030580, 1030903, 1031361, 1031376, 1031445, 1032620, 1032673, 1033823, 1033844, 1034578, 1036296, 1036515, 1036614, 1041640, 1045217, 1045259, 1045287, 1045315, 1045428, 1045439, 1045476, 1045500, 1045573, 1045592, 1045618, 1045696, 1045707, 1045714, 1045794, 1045888, 1045926, 1045929, 1045934, 1045965, 1046005, 1046023, 1046101, 1046134, 1046138, 1046186, 1046272, 1046297, 1046356, 1046357, 1046362, 1046451, 1046500, 1046510, 1046528, 1046560, 1046591, 1046641, 1046689, 1046735, 1046799, 1046889, 1050585, 1054856, 1054859, 1054861, 1054867, 1054868, 1054880, 1054887, 1054891, 1054896, 1054898, 1054903, 1054917, 1054918, 1054924, 1054927, 1054931, 1054995, 1055010, 1055024, 1055025, 1055030, 1055040, 1055052, 1055060, 1055080, 1055086, 1055102, 1055111, 1055120, 1055131, 1055139, 1055155, 1055170, 1055171, 1055174, 1055195, 1055198, 1055201, 1055205, 1055213, 1055214, 1086028, 1086038, 1086066, 1086390, 1086521, 1086637, 1086800, 1086820, 1086937, 1087202, 1087303, 1087479, 1087539, 1087681, 1087745, 1102608, 1102637, 1102693, 1102742, 1102774, 1102891, 1102914, 1102970, 1103036, 1103056, 1103199, 1103222, 1103311, 1103312, 1103330, 1103409, 1103525, 1115663, 1120259, 1125694, 1132727, 1132815, 1132972, 1136814, 1137543, 1137545, 1137553, 1137563, 1137571, 1137576, 1137577, 1137607, 1137611, 1137617, 1137643, 1137659, 1137660, 1137667, 1137685, 1137702, 1137712, 1137718, 1137722, 1137723, 1137744, 1137759, 1137760, 1137776, 1137789, 1137796, 1137798, 1137799, 1137804, 1137813, 1137816, 1137825, 1137828, 1137836, 1137841, 1137853, 1137857, 1137859, 1137869, 1137880, 1137898, 1137908, 1137917, 1137953, 1137955, 1137971, 1137975, 1137983, 1137993, 1138015, 1138026, 1138046, 1138064, 1138068, 1138077, 1138084, 1138093, 1138097, 1139619, 1140176, 1140220, 1140292, 1142250, 1142305, 1142339, 1147896, 1151644, 1151646, 1151648, 1151654, 1151937, 1155658, 1162596, 1162612, 1162659, 1162681, 1162732, 1162777, 1162790, 1162837, 1162843, 1162853, 1162873, 1162898, 1162917, 1162921, 1162931, 1162940, 1162979, 1162982, 1162992, 1163998, 1167116, 1169134, 1169178, 1169262, 1169267, 1169291, 1169299, 1169308, 1169318, 1169326, 1169332, 1169345, 1169358, 1169376, 1169380, 1169385, 1169406, 1169407, 1169423, 1169456, 1169501, 1169560, 1169587, 1169665, 1169669, 1169680, 1169691, 1169709, 1169765, 1169789, 1169842, 1172927, 1174027, 1188984, 1193176, 1193217, 1193272, 1193330, 1193432, 1193451, 1193498, 1193503, 1203350, 1203392, 1203556, 1204718, 1204967, 1205041, 1205188, 1205308, 1205540, 1205751, 1206059, 1206238, 1206382, 1206444, 1207637, 1207769, 1210877, 1210935, 1211522, 1212253, 1212453, 1221117, 1221378, 1221981, 1222030, 1223806, 1234726, 1234754, 1235079, 1235264, 1235570, 1235678, 1238045, 1238111, 1238119, 1238135, 1245353, 1245377, 1249989, 1250130, 1252691, 1252754, 1259518, 1260937, 1266835, 1274087, 1282200, 1282258, 1282295, 1283307, 1303672, 1304062, 1310303, 1311377, 1313171, 1319171, 1322123, 1351574, 1351584, 1351600, 1353129, 1353174, 1353234, 1360509, 1365343, 1365698, 1365822, 1365897, 1365925, 1366201, 1366357, 1366462, 1366609, 1366610, 1366839, 1367001, 1367081, 1367147, 1367526, 1367549, 1367565, 1367720, 1367875, 1368013, 1368187, 1368199, 1368290, 1368312, 1368501, 1368761, 1368764, 1368831, 1369454, 1369502, 1369882, 1369915, 1375039, 1414017, 1414481, 1415122, 1415130, 1415136, 1415209, 1446858, 1453245, 1455201, 1462048, 1462226, 1462308, 1462316, 1462993, 1463192, 1463411, 1463536, 1464022, 1464081, 1464456, 1464467, 1468617, 1475363, 1478217, 1598704, 1600414, 1600528, 1600667, 1600670, 1616712, 1622839, 1624222, 1626120, 1626125, 1626354, 1626395, 1627171, 1628006, 1629311, 1629709, 1630505, 1630755, 1630797, 1630925, 1631855, 1632981, 1633592, 1633643, 1663201, 1677792, 1678046, 1678152, 1678413, 1678695, 1678785, 1678825, 1678868, 1678869, 1679001, 1679121, 1679229, 1679539, 1679692, 1679898, 1680030, 1680215, 1680673, 1680758, 1680838, 1680979, 1681026, 1681066, 1681141, 1681344, 1681538, 1681579, 1681800, 1682276, 1682394, 1682419, 1682642, 1682733, 1683010, 1683036, 1683713, 1683804, 1684296, 1689989, 1695304, 1701321, 1701328, 1701467, 1701470, 1704584, 1711827, 1715044, 1715052, 1715058, 1715076, 1715083, 1715084, 1715086, 1715124, 1715131, 1715142, 1715208, 1715220, 1715248, 1715330, 1720685, 1720762, 1720788, 1721508, 1721518, 1721527, 1721533, 1721600, 1721601, 1721607, 1721746, 1721759, 1721769, 1722368, 1724276, 1724277, 1724280, 1724285, 1724304, 1724309, 1724311, 1724320, 1724321, 1724325, 1724329, 1724336, 1724345, 1724347, 1724349, 1724354, 1724357, 1724365, 1724369, 1724371, 1724373, 1724378, 1724390, 1724394, 1724396, 1724400, 1724405, 1724408, 1724410, 1724415, 1724417, 1724427, 1724428, 1724433, 1724444, 1724446, 1724455, 1724457, 1724459, 1724463, 1724467, 1724472, 1724480, 1724488, 1724490, 1724494, 1724498, 1724501, 1724504, 1724505, 1724509, 1724511, 1724521, 1724527, 1724530, 1724532, 1724535, 1724539, 1724546, 1724547, 1724552, 1724560, 1724564, 1724565, 1724567, 1724568, 1724572, 1724579, 1724580, 1724584, 1724591, 1724595, 1724598, 1724600, 1724609, 1724611, 1724615, 1724623, 1724625, 1724630, 1724632, 1724635, 1724641, 1724644, 1724645, 1724646, 1724647, 1724654, 1724655, 1724657, 1724658, 1724666, 1724670, 1724682, 1724684, 1724687, 1724689, 1724696, 1724702, 1724703, 1724704, 1724710, 1724715, 1724721, 1724723, 1724726, 1724731, 1724747, 1724749, 1724751, 1724753, 1724762, 1724766, 1724767, 1724768, 1724772, 1724775, 1724776, 1724782, 1724784, 1724786, 1724794, 1724795, 1724796, 1724797, 1724798, 1724800, 1724814, 1724824, 1724834, 1724837, 1724840, 1724846, 1724849, 1724857, 1724863, 1724864, 1724867, 1724868, 1724876, 1724877, 1724881, 1724890, 1724898, 1724899, 1724905, 1724907, 1724912, 1724913, 1724917, 1724920, 1724925, 1724929, 1724936, 1724938, 1724941, 1724946, 1724948, 1724949, 1724951, 1724960, 1724962, 1724967, 1724969, 1724970, 1724972, 1724973, 1724975, 1724979, 1724981, 1724983, 1724986, 1724988, 1724990, 1724994, 1724998, 1725002, 1725003, 1725010, 1725015, 1725020, 1725024, 1725026, 1725028, 1725039, 1725042, 1725043, 1725046, 1725047, 1725050, 1725052, 1725054, 1725055, 1725057, 1725058, 1725062, 1725065, 1725068, 1725071, 1725074, 1725077, 1725080, 1725081, 1725082, 1725085, 1725098, 1725099, 1725118, 1725122, 1725129, 1725131, 1725140, 1725154, 1725163, 1725164, 1725165, 1725170, 1725173, 1725175, 1725176, 1725177, 1725178, 1725181, 1725185, 1725188, 1725191, 1725192, 1725193, 1725213, 1725215, 1725217, 1725219, 1725224, 1725225, 1725229, 1725231, 1725233, 1725235, 1725238, 1725254, 1725255, 1725257, 1725263, 1725274, 1725300, 1725312, 1725316, 1725317, 1725320, 1725322, 1725328, 1725330, 1725342, 1725345, 1725346, 1725348, 1725350, 1725353, 1725354, 1725357, 1725368, 1725370, 1725376, 1725378, 1725381, 1725392, 1725395, 1725396, 1725398, 1725404, 1725406, 1725407, 1725413, 1725414, 1725415, 1725417, 1725423, 1725429, 1725431, 1725433, 1725434, 1725439, 1725440, 1725441, 1725442, 1725443, 1725445, 1725453, 1725456, 1725457, 1725459, 1725460, 1725461, 1725462, 1725463, 1725472, 1725483, 1725490, 1725494, 1725512, 1725516, 1725520, 1725522, 1725523, 1725525, 1725534, 1725536, 1725540, 1725543, 1725544, 1725546, 1725555, 1725558, 1725559, 1725564, 1725565, 1725569, 1725580, 1725588, 1725589, 1725590, 1725591, 1725592, 1725595, 1725600, 1725613, 1725620, 1725621, 1725624, 1725625, 1725631, 1725637, 1725639, 1725641, 1725643, 1725646, 1725649, 1725650, 1725654, 1725657, 1725662, 1725666, 1725670, 1725678, 1725682, 1725683, 1725684, 1725691, 1725694, 1725710, 1725712, 1725713, 1725714, 1725718, 1725719, 1725723, 1725726, 1725727, 1725738, 1725742, 1725747, 1725748, 1725753, 1725754, 1725758, 1725772, 1725774, 1725775, 1725776, 1725795, 1725797, 1725798, 1725803, 1725815, 1725816, 1725817, 1725821, 1725826, 1726111, 1726209, 1726972, 1746625, 1746660, 1750271, 1750281, 1750308, 1750330, 1750368, 1750371, 1750375, 1750379, 1750405, 1750430, 1750444, 1750445, 1750446, 1750448, 1750454, 1750462, 1750478, 1750500, 1750537, 1750551, 1750552, 1750642, 1750653, 1750658, 1750681, 1750691, 1750738, 1750756, 1750791, 1750801, 1750817, 1750829, 1750890, 1750915, 1750917, 1750924, 1750930, 1750931, 1750940, 1751007, 1751012, 1751025, 1751097, 1751099, 1751120, 1751129, 1751210, 1751215, 1751247, 1751250, 1751293, 1751299, 1751312, 1751331, 1751332, 1751488, 1751521, 1751595, 1751631, 1751634, 1751655, 1751676, 1751678, 1751704, 1751740, 1751764, 1751781, 1751782, 1751793, 1751795, 1751817, 1751835, 1751850, 1751863, 1751909, 1751939, 1751951, 1752033, 1752057, 1752074, 1752075, 1752145, 1752155, 1752171, 1752195, 1752216, 1752252, 1752313, 1752331, 1752336, 1752387, 1752410, 1752423, 1752435, 1752439, 1752440, 1752532, 1752541, 1752598, 1752627, 1752691, 1752710, 1752721, 1752770, 1752868, 1752891, 1753109, 1753343, 1753397, 1753465, 1753481, 1753629, 1753685, 1753765, 1753769, 1753850, 1754091, 1754100, 1754127, 1754146, 1754220, 1755434, 1755505, 1757944, 1758414, 1760540, 1762240, 1779589, 1794628, 1795284, 1800611, 1800722, 1822897, 1826927, 1827404, 1832889, 1836162, 1850123, 1850134, 1850568, 1853141, 1854640, 1855132, 1855146, 1855697, 1858466, 1864733, 1864757, 1864851, 1865049, 1865207, 1865226, 1865282, 1868801, 1868820, 1868970, 1869094, 1875790, 1876295, 1889477, 1892917, 1893463, 1897898, 1898407, 1898445, 1906130, 1909190, 1909932, 1909956, 1915177, 1919042, 1923240, 1923254, 1925775, 1926217, 1927928, 1928879, 1944641, 1944656, 1947851, 1955152, 1958115, 1962767, 1966133, 1970373, 1972230, 1998553, 1998631, 2040698, 2056179, 2056219, 2056257, 2056343, 2056361, 2056485, 2056533, 2060913, 2064876, 2064894, 2064900, 2064901, 2064904, 2064918, 2082666, 2086169, 2086649, 2122585, 2151922, 2155620, 2155625, 2155644, 2155660, 2155668, 2155679, 2155694, 2155701, 2155709, 2155714, 2155716, 2155725, 2155733, 2155736, 2155752, 2155780, 2155805, 2155824, 2155833, 2155834, 2155840, 2155841, 2155866, 2155889, 2155901, 2155914, 2155917, 2155919, 2156030, 2156402, 2156404, 2156413, 2163025, 2180595, 2184933, 2200112, 2202420, 2207257, 2207900, 2208691, 2214333, 2221340, 2223604, 2223630, 2228285, 2230846, 2231015, 2231017, 2231020, 2231260, 2231285, 2235522, 2235526, 2238461, 2239443, 2239469, 2265991, 2272630, 2277944, 2308264, 2308795, 2309281, 2322515, 2408599, 2412945, 2413173, 2413196, 2421407, 2423839, 2428726, 2428803, 2438865, 2438935, 2439133, 2439405, 2439670, 2441248, 2441405, 2441475, 2441554, 2442198, 2442300, 2442411, 2442498, 2442737, 2442952, 2442992, 2443042, 2443073, 2443185, 2443283, 2443284, 2443296, 2444669, 2455610, 2457588, 2467624, 2480076, 2480284, 2484270, 2484282, 2484305, 2484318, 2484337, 2484345, 2484537, 2484570, 2484613, 2484659, 2484684, 2484727, 2484741, 2495467, 2608565, 2608686, 2612124, 2612131, 2612134, 2612156, 2612169, 2612202, 2612208, 2612213, 2612219, 2612223, 2612255, 2612256, 2612266, 2612332, 2612345, 2612361, 2612365, 2612377, 2612391, 2612401, 2612428, 2612483, 2612490, 2612502, 2612504, 2612516, 2612520, 2612531, 2612539, 2612563, 2612602, 2612606, 2612618, 2612622, 2612642, 2612654, 2612663, 2612664, 2612667, 2612690, 2612704, 2612705, 2612755, 2612787, 2612798, 2612815, 2612824, 2612830, 2612867, 2612884, 2612890, 2612908, 2612944, 2612953, 2612955, 2612971, 2612999, 2613006, 2613014, 2613019, 2613036, 2613104, 2613106, 2613110, 2613119, 2613127, 2613134, 2613137, 2613152, 2613177, 2613187, 2613194, 2613201, 2613204, 2613206, 2613207, 2613212, 2613217, 2613242, 2613249, 2613253, 2613256, 2613278, 2613293, 2613317, 2613325, 2613329, 2613368, 2613375, 2613410, 2613417, 2613435, 2613437, 2613449, 2613453, 2613478, 2613479, 2613526, 2613536, 2613548, 2613557, 2613592, 2613644, 2613710, 2613712, 2613715, 2613724, 2613742, 2613755, 2613803, 2613818, 2613845, 2613848, 2613857, 2613867, 2613954, 2613965, 2613969, 2614006, 2614009, 2614010, 2614015, 2614019, 2614021, 2614031, 2614049, 2614052, 2614053, 2614081, 2614093, 2614099, 2614100, 2614108, 2614142, 2614146, 2614204, 2614221, 2614238, 2614277, 2614314, 2614329, 2614332, 2614411, 2614414, 2614433, 2614444, 2614455, 2614466, 2614471, 2614477, 2614489, 2614501, 2614515, 2614524, 2614555, 2614562, 2614570, 2614572, 2614583, 2614591, 2614601, 2614607, 2614632, 2614638, 2614672, 2614675, 2614690, 2614718, 2614742, 2614759, 2614773, 2614783, 2614784, 2614790, 2614792, 2614796, 2614835, 2614936, 2614945, 2614967, 2615024, 2615055, 2615065, 2615086, 2615100, 2615143, 2615144, 2615175, 2615196, 2615232, 2615270, 2615273, 2615274, 2615306, 2615350, 2615394, 2615397, 2615414, 2615448, 2615454, 2615456, 2615486, 2615498, 2615504, 2615517, 2615536, 2615573, 2615586, 2615738, 2615777, 2615813, 2615833, 2615837, 2615846, 2615873, 2615880, 2615881, 2615884, 2615892, 2615930, 2615953, 2616017, 2616040, 2616044, 2616049, 2616050, 2616056, 2616063, 2616070, 2616084, 2616088, 2616096, 2616125, 2616141, 2616154, 2616166, 2616169, 2616174, 2616175, 2616183, 2616212, 2616264, 2616273, 2616277, 2616334, 2616365, 2616385, 2616403, 2616412, 2616437, 2616442, 2616447, 2616490, 2616498, 2616504, 2616541, 2616563, 2616567, 2616582, 2616584, 2616619, 2616624, 2616646, 2616727, 2616732, 2616762, 2616782, 2616790, 2616806, 2616823, 2616895, 2616905, 2616915, 2617032, 2617073, 2617077, 2617140, 2617146, 2617148, 2617150, 2617228, 2617234, 2617240, 2617266, 2617307, 2617364, 2617375, 2617427, 2617439, 2617445, 2617471, 2617472, 2617510, 2617518, 2617523, 2617569, 2617596, 2617731, 2617755, 2617763, 2617773, 2617778, 2617781, 2617792, 2617807, 2617832, 2617870, 2617909, 2617910, 2617953, 2617956, 2617977, 2618019, 2618064, 2618082, 2618087, 2618100, 2618105, 2618119, 2618162, 2618170, 2618175, 2618178, 2618209, 2618213, 2618227, 2618230, 2618246, 2618268, 2618296, 2618319, 2618342, 2618344, 2618350, 2618359, 2618456, 2618460, 2618466, 2618468, 2618488, 2618495, 2618536, 2618544, 2618575, 2618594, 2618620, 2618632, 2618653, 2618664, 2618705, 2618710, 2618720, 2618743, 2618790, 2618801, 2618845, 2618847, 2618852, 2618890, 2618891, 2618904, 2618945, 2618947, 2618949, 2618951, 2618954, 2619000, 2619010, 2619016, 2619034, 2619036, 2619045, 2619099, 2619135, 2619143, 2619175, 2619215, 2619266, 2619279, 2619301, 2619308, 2619323, 2619335, 2619344, 2619345, 2619351, 2619365, 2619389, 2619393, 2619398, 2619424, 2619427, 2619435, 2619447, 2619448, 2619466, 2619485, 2619508, 2619579, 2619629, 2619632, 2619639, 2619653, 2619674, 2619680, 2619684, 2619696, 2619742, 2619751, 2619754, 2619763, 2619786, 2619844, 2619852, 2619862, 2619864, 2619897, 2619900, 2619960, 2619968, 2620028, 2620029, 2620047, 2620052, 2620086, 2620128, 2620131, 2620134, 2620161, 2620163, 2620164, 2620177, 2620185, 2620203, 2620215, 2620218, 2620226, 2620257, 2620260, 2620286, 2620673, 2620824, 2621023, 2621213, 2621219, 2621355, 2621524, 2621862, 2622193, 2622387, 2622695, 2622929, 2636531, 2636535, 2636717, 2636736, 2652176, 2652376, 2653605, 2658463, 2658607, 2666800, 2667475, 2669237, 2680335, 2686404, 2687329, 2687330, 2687335, 2687339, 2687349, 2687352, 2687353, 2687356, 2687363, 2687365, 2687366, 2687369, 2687371, 2687374, 2687375, 2687380, 2687381, 2687387, 2687388, 2687390, 2687397, 2687398, 2687400, 2687401, 2687405, 2687411, 2687415, 2687426, 2687427, 2687429, 2687433, 2687438, 2687440, 2687444, 2687447, 2687449, 2687451, 2687459, 2687462, 2687463, 2687464, 2687465, 2687472, 2687473, 2687478, 2687480, 2687481, 2687483, 2687484, 2687493, 2687495, 2687496, 2687497, 2687500, 2687501, 2687505, 2687509, 2687511, 2687512, 2687515, 2687516, 2687521, 2687527, 2687530, 2687532, 2687533, 2687539, 2687541, 2687543, 2687545, 2687547, 2687549, 2687550, 2687553, 2687566, 2687571, 2687578, 2687581, 2687583, 2687585, 2687586, 2687587, 2687595, 2687603, 2687604, 2687605, 2687606, 2687609, 2687610, 2687611, 2687612, 2687613, 2687614, 2687617, 2687624, 2687625, 2687631, 2687633, 2687638, 2687643, 2687651, 2687656, 2687669, 2687673, 2687682, 2687683, 2687688, 2687689, 2687691, 2687694, 2687697, 2687714, 2687720, 2687722, 2687724, 2687726, 2687728, 2687731, 2687732, 2687733, 2687734, 2687756, 2687761, 2687763, 2687765, 2687767, 2687773, 2687774, 2687779, 2687781, 2687784, 2687786, 2687792, 2687793, 2687796, 2687798, 2687805, 2687810, 2687812, 2687813, 2687815, 2687817, 2687820, 2687823, 2687824, 2687829, 2687830, 2687842, 2687847, 2687850, 2687856, 2687860, 2687864, 2687866, 2687869, 2687870, 2687872, 2687873, 2687875, 2687880, 2687884, 2687885, 2687886, 2687889, 2687892, 2687899, 2687901, 2687903, 2687911, 2687913, 2687917, 2687919, 2687921, 2687923, 2687924, 2687933, 2687934, 2687938, 2687941, 2687945, 2687946, 2687951, 2687953, 2687954, 2687959, 2687962, 2687972, 2687973, 2751776, 2752623, 2753078, 2756059, 2763780, 2764056, 2764069, 2767273, 2767280, 2770421, 2770515, 2770516, 2770586, 2770592, 2770725, 2770748, 2770776, 2770838, 2770887, 2770918, 2770972, 2770979, 2770988, 2771040, 2771065, 2771075, 2771145, 2771172, 2771221, 2771222, 2771226, 2771241, 2771246, 2771301, 2771336, 2771350, 2771396, 2771404, 2771441, 2771462, 2771611, 2771650, 2771680, 2771688, 2771748, 2771766, 2771782, 2771803, 2771831, 2771876, 2771902, 2771921, 2771925, 2771942, 2771972, 2772014, 2772037, 2772040, 2772051, 2772057, 2772284, 2772292, 2772334, 2772335, 2772344, 2772350, 2772377, 2772382, 2772404, 2775957, 2785603, 2785617, 2785624, 2785630, 2785638, 2785642, 2785664, 2785693, 2785699, 2785710, 2785711, 2785741, 2785748, 2785751, 2785761, 2785765, 2785770, 2785781, 2785797, 2785804, 2785810, 2785815, 2785823, 2785829, 2785830, 2785833, 2785841, 2785843, 2785850, 2785862, 2785870, 2785880, 2785882, 2785893, 2785897, 2785900, 2785994, 2786176, 2786187, 2786207, 2796949, 2797024, 2799480, 2801557, 2811689, 2812688, 2816504, 2818792, 2818916, 2822196, 2826352, 2842582, 2842590, 2842784, 2842800, 2842859, 2842864, 2842949, 2842976, 2843067, 2843076, 2843077, 2843292, 2843311, 2843443, 2843459, 2843460, 2843466, 2843510, 2843643, 2843660, 2843685, 2843721, 2843783, 2843901, 2843962, 2845949, 2848988, 2881472, 2881474, 2881519, 2881541, 2881551, 2881560, 2881570, 2881593, 2881596, 2881614, 2881629, 2881669, 2885400, 2889328, 2892735, 2892740, 2906975, 2914414, 2915832, 2916286, 2916470, 2916538, 2916680, 2929586, 2930144, 2930150, 2930157, 2930316, 2930555, 2930592, 2949109, 2949130, 2949138, 2949176, 2950763, 2964614, 3017564, 3017580, 3038198, 3040557, 3063512, 3094541, 3105797, 3119599, 3190573, 3198911, 3214020, 3214057, 3214072, 3214092, 3214102, 3214103, 3214112, 3214118, 3214163, 3214178, 3214192, 3214195, 3214238, 3214309, 3214310, 3214357, 3214388, 3214398, 3214428, 3214433, 3214442, 3214518, 3214532, 3214558, 3214574, 3214581, 3214589, 3214595, 3214609, 3214719, 3214745, 3214772, 3214782, 3214797, 3214844, 3214876, 3214919, 3214932, 3214949, 3214975, 3214982, 3215072, 3215093, 3215157, 3215188, 3215196, 3215203, 3215226, 3215235, 3215242, 3215245, 3215249, 3215273, 3215336, 3215356, 3215360, 3215380, 3215384, 3215424, 3215431, 3215438, 3215544, 3215549, 3215554, 3215638, 3215665, 3215671, 3215679, 3215695, 3215713, 3215716, 3215722, 3215738, 3215779, 3215789, 3215846, 3215848, 3215908, 3215926, 3215936, 3216036, 3216039, 3216041, 3216043, 3216045, 3216047, 3216071, 3216086, 3216094, 3216112, 3216120, 3216127, 3216202, 3216204, 3216207, 3216222, 3216252, 3216260, 3216266, 3216300, 3216349, 3216383, 3216386, 3216389, 3216408, 3216447, 3216448, 3216449, 3216483, 3216548, 3216554, 3216597, 3216606, 3216632, 3216700, 3216718, 3216776, 3216787, 3216794, 3216875, 3216878, 3216887, 3216904, 3216917, 3216919, 3216924, 3216972, 3216988, 3217012, 3217015, 3217047, 3217069, 3217078, 3217117, 3217133, 3217144, 3217147, 3217170, 3217177, 3217268, 3217292, 3217322, 3217328, 3217389, 3217435, 3217517, 3217530, 3217531, 3217540, 3217565, 3217576, 3217599, 3217644, 3217653, 3217662, 3217687, 3217716, 3217721, 3217722, 3217758, 3217793, 3217797, 3217818, 3217837, 3217853, 3217856, 3217915, 3217917, 3217925, 3218064, 3218076, 3218105, 3218124, 3218163, 3218174, 3218219, 3218253, 3218258, 3218268, 3218273, 3218337, 3218348, 3218357, 3218361, 3218415, 3218421, 3218425, 3218449, 3218483, 3218563, 3218565, 3218633, 3218651, 3218659, 3218686, 3218724, 3218732, 3218747, 3218761, 3218773, 3218783, 3218785, 3218921, 3218930, 3219036, 3219039, 3219126, 3219175, 3223514, 3238313, 3271297, 3271533, 3272726, 3276649, 3276652, 3276656, 3276714, 3276752, 3276810, 3277042, 3286875, 3297585, 3305007, 3313728, 3327717, 3328188, 3329432, 3330159, 3333602, 3335104, 3336674, 3337696, 3340211, 3341504, 3346389, 3348059, 3348253, 3350111, 3350702, 3351172, 3351449, 3351458, 3351498, 3351565, 3351588, 3352876, 3352900, 3353002, 3353038, 3353069, 3353087, 3353129, 3353156, 3353170, 3353194, 3353217, 3353218, 3353256, 3353259, 3353268, 3353283, 3353292, 3353300, 3353306, 3353339, 3353354, 3353357, 3353361, 3353365, 3353381, 3353386, 3353388, 3353391, 3353412, 3353417, 3353420, 3353423, 3353440, 3353445, 3353473, 3353510, 3353514, 3353523, 3353532, 3353552, 3353567, 3353573, 3353575, 3353581, 3353587, 3353673, 3353680, 3353682, 3353702, 3353706, 3353747, 3353749, 3353758, 3353832, 3354005, 3354125, 3354241, 3354314, 3354501, 3354694, 3360462, 3360487, 3360911, 3361004, 3364317, 3365913, 3366159, 3367277, 3367681, 3368160, 3368274, 3368378, 3368438, 3369330, 3369419, 3369590, 3370371, 3371043, 3372654, 3373427, 3373894, 3377516, 3378954, 3379299, 3380165, 3384873, 3385344, 3385538, 3385627, 3386095, 3387207, 3387310, 3388153, 3389154, 3389406, 3389423, 3389456, 3389475, 3389476, 3390006, 3392131, 3392260, 3392317, 3392321, 3392323, 3392342, 3392530, 3392979, 3394262, 3394264, 3394276, 3394277, 3394289, 3394301, 3394316, 3394332, 3394370, 3394379, 3400286, 3415017, 3415755, 3415815, 3417624, 3433750, 3433858, 3434243, 3434311, 3437572, 3437584, 3438346, 3438354, 3438396, 3438398, 3438401, 3438413, 3438582, 3438653, 3453111, 3458256, 3462752, 3462773, 3466554, 3466582, 3468038, 3468403, 3470376, 3470580, 3472899, 3473930, 3474644, 3475201, 3475268, 3475340, 3476234, 3476958, 3479113, 3479557, 3479639, 3480213, 3480387, 3480440, 3480479, 3481256, 3481313, 3481319, 3481357, 3481419, 3481539, 3481552, 3481610, 3481647, 3481681, 3482305, 3482446, 3482546, 3482591, 3482843, 3482866, 3483066, 3483073, 3483078, 3483204, 3483516, 3483571, 3484454, 3484461, 3484483, 3484495, 3484507, 3484514, 3484523, 3484532, 3484557, 3484581, 3484586, 3484598, 3484601, 3484605, 3484624, 3484875, 3486395, 3488851, 3488895, 3489163, 3490401, 3490586, 3490908, 3499930, 3508613, 3510709, 3523787, 3530860, 3539402, 3539437, 3539445, 3539456, 3539485, 3539507, 3539527, 3539530, 3539532, 3539552, 3539569, 3539577, 3539580, 3539585, 3539588, 3539597, 3539611, 3539635, 3539656, 3539657, 3539677, 3539683, 3539693, 3539702, 3539708, 3539722, 3539749, 3539810, 3539816, 3539829, 3539854, 3539864, 3539895, 3539900, 3539901, 3539926, 3539956, 3540084, 3540132, 3540149, 3545547, 3545904, 3551685, 3552236, 3552321, 3552674, 3559980, 3562549, 3565169, 3565307, 3565335, 3565613, 3579584, 3579753, 3585224, 3591969, 3597729, 3600823, 3604047, 3604748, 3605818, 3605975, 3606408, 3609166, 3609186, 3610157, 3610233, 3610355, 3610484, 3610544, 3611108, 3611670, 3612054, 3612678, 3612735, 3623996, 3626556, 3632860, 3632895, 3633672, 3633848, 3634039, 3634338, 3637098, 3637384, 3637440, 3644737, 3649547, 3650172, 3650454, 3650716, 3651147, 3655545, 3663132, 3663188, 3663204, 3663288, 3715734, 3716242, 3717165, 3717189, 3717223, 3717349, 3717379, 3717384, 3717472, 3717501, 3717613, 3718523, 3718605, 3718652, 3719008, 3719204, 3719379, 3720011, 3720037, 3720167, 3720195, 3721428, 3721509, 3721579, 3721713, 3722663, 3722736, 3722963, 3723467, 3723625, 3723753, 3723909, 3724261, 3725479, 3725641, 3726595, 3742610, 3745694, 3746845, 3748228, 3748230, 3748232, 3748298, 3748324, 3748326, 3748576, 3748591, 3748615, 3756870, 3758220, 3762825, 3798819, 3799084, 3799238, 3800211, 3800542, 3800918, 3801054, 3801181, 3803907, 3811827, 3811829, 3815655, 3820618, 3821016, 3852402, 3856347, 3857500, 3857975, 3951721, 3951956, 3952282, 3952740, 3952756, 3952787, 3952831, 3952839, 3952840, 3953120, 3953311, 3953316, 3953586, 3953595, 3953671, 3954053, 3954387, 3954786, 3954867, 3955220, 3955377, 3955475, 3955500, 3955529, 3955583, 3955634, 3955664, 3955818, 3955819, 3955926, 3956013, 3956071, 3956116, 3956711, 3956730, 3956734, 3957117, 3957556, 3959369, 3961862, 3961981, 3963071, 3966122, 3966179, 3966820, 3966836, 3980782, 3980976, 3981165, 3981261, 3981405, 3981462, 3981599, 3981677, 3981687, 3981901, 3981966, 3982112, 3982215, 3982269, 3982295, 3982511, 3982523, 3982538, 3982539, 3982629, 3982637, 3982716, 3982752, 3982758, 3982823, 3982848, 3982930, 3982994, 3983074, 3983149, 3983170, 3983171, 3983325, 3983386, 3983528, 3983544, 3983670, 3983773, 3984135, 3985147, 3985279, 3985366, 3985484, 3985512, 3985562, 3985781, 3985890, 3985974, 3985976, 3986435, 3986520, 3986639, 3986671, 3986682, 3986762, 3986780, 3986824, 3986825, 3986867, 3990302, 3990368, 3990412, 3990420, 3990490, 3990567, 3990594, 3990652, 3991246, 3991343, 3991439, 3991452, 3991972, 3992196, 3992197, 3992387, 3992546, 3992560, 3993075, 3993527, 3993688, 3993818, 3993902, 3993903, 3993914, 3994233, 3994255, 3994335, 3994340, 3994354, 3994729, 3995493, 3996196, 3996331, 3996530, 3996605, 3996696, 3996722, 3996806, 3997243, 3997246, 3997264, 3997440, 3997494, 3997624, 3997711, 3997746, 3998175, 3998189, 3998197, 3998460, 3998464, 3998645, 3998792, 3998968, 3999252, 3999899, 3999980, 4000023, 4000134, 4000364, 4000389, 4000675, 4000834, 4000902, 4001320, 4001334, 4001365, 4001440, 4001455, 4001799, 4002186, 4003030, 4003039, 4003405, 4003594, 4003609, 4003638, 4003940, 4004027, 4004074, 4006240, 4011315, 4012273, 4013193, 4013292, 4013524, 4013647, 4013732, 4015144, 4015172, 4015288, 4015357, 4016011, 4016124, 4016757, 4016790, 4016830, 4017078, 4017144, 4017222, 4017226, 4017322, 4017351, 4017946, 4017969, 4018065, 4018484, 4018731, 4018898, 4019036, 4023282, 4023695, 4024250, 4024615, 4024859, 4024898, 4025134, 4025429, 4025441, 4025502, 4025708, 4025717, 4025727, 4025734, 4025735, 4025797, 4025997, 4026309, 4027279, 4028626, 4028658, 4028748, 4028879, 4028939, 4028967, 4028982, 4030572, 4030711, 4030713, 4030788, 4031053, 4031058, 4031084, 4031188, 4031203, 4031213, 4031452, 4031458, 4031470, 4031480, 4031567, 4031630, 4031689, 4031775, 4031988, 4032012, 4032050, 4032092, 4032159, 4032164, 4032243, 4032256, 4032376, 4032377, 4032384, 4032425, 4036421, 4036538, 4036540, 4036564, 4036592, 4037186, 4037236, 4037334, 4037350, 4037352, 4037444, 4038085, 4038091, 4038141, 4038354, 4038374, 4038386, 4038859, 4038909, 4038997, 4039010, 4039078, 4039144, 4039165, 4044790, 4044983, 4045082, 4045229, 4045316, 4045322, 4045335, 4047510, 4047513, 4047515, 4047525, 4050336, 4050345, 4050448, 4053160, 4053179, 4053312, 4053802, 4053869, 4060394, 4063229, 4063322, 4063424, 4063983, 4063989, 4064105, 4064625, 4064627, 4069578, 4070183, 4070224, 4070225, 4070629, 4070713, 4071098, 4071312, 4071447, 4071561, 4071604, 4071751, 4072161, 4072814, 4072836, 4072837, 4072838, 4072841, 4072849, 4072856, 4073097, 4073145, 4073186, 4073203, 4073222, 4073328, 4073462, 4073816, 4074397, 4074399, 4074474, 4074489, 4074503, 4074716, 4075126, 4075267, 4077563, 4077609, 4077626, 4077924, 4077986, 4078008, 4078060, 4078204, 4078437, 4079763, 4079797, 4080056, 4080096, 4080120, 4080232, 4080342, 4080347, 4081114, 4081225, 4081315, 4081334, 4081341, 4081370, 4081389, 4081941, 4081954, 4082344, 4082501, 4082528, 4082580, 4082665, 4082668, 4082690, 4082736, 4083787, 4084197, 4084242, 4084263, 4084318, 4086943, 4086947, 4086963, 4087672, 4087688, 4087806, 4087820, 4087935, 4088265, 4088344, 4088762, 4088966, 4089250, 4089264, 4089517, 4089616, 4089841, 4090386, 4090404, 4091494, 4091542, 4091545, 4093073, 4093248, 4093296, 4093486, 4094118, 4095448, 4098038, 4098116, 4098135, 4098172, 4101290, 4101374, 4101518, 4101602, 4102231, 4102757, 4103520, 4103669, 4104319, 4104443, 4105553, 4106361, 4107076, 4108434, 4111134, 4111528, 4111572, 4111597, 4111754, 4111775, 4112031, 4112389, 4112394, 4112558, 4112744, 4113001, 4113097, 4116124, 4116301, 4116308, 4116592, 4116601, 4116798, 4117114, 4117342, 4117891, 4120470, 4120724, 4120867, 4120949, 4120967, 4121067, 4121166, 4121219, 4121406, 4121739, 4121952, 4121984, 4122075, 4122436, 4122463, 4123074, 4123167, 4123289, 4123430, 4123624, 4123746, 4123846, 4124160, 4124195, 4124432, 4124727, 4126171, 4126307, 4127416, 4127483, 4127511, 4127831, 4127992, 4127997, 4128195, 4133040, 4133709, 4136780, 4138631, 4138759, 4139152, 4142055, 4143059, 4145301, 4145387, 4146630, 4148512, 4148645, 4148736, 4148750, 4149002, 4149101, 4149187, 4149192, 4149289, 4149378, 4149563, 4149679, 4149783, 4149976, 4150218, 4150326, 4150338, 4150583, 4150600, 4150628, 4150631, 4151043, 4151125, 4151466, 4151490, 4151603, 4151783, 4153127, 4153581, 4153801, 4153821, 4153841, 4153926, 4153977, 4154686, 4154869, 4154887, 4154986, 4155822, 4156764, 4158719, 4175496, 4178169, 4180743, 4181354, 4181605, 4182090, 4183792, 4183805, 4186386, 4191989, 4192256, 4194010, 4194445, 4194941, 4195681, 4195804, 4195816, 4195926, 4196361, 4196619, 4196746, 4197654, 4197743, 4198343, 4198365, 4198620, 4198969, 4199246, 4199351, 4199408, 4199598, 4199605, 4199624, 4200410, 4200563, 4200593, 4200620, 4200855, 4200925, 4208742, 4209722, 4209728, 4209730, 4209758, 4210002, 4210535, 4210630, 4211138, 4211152, 4213924, 4214963, 4214983, 4215242, 4215535, 4216097, 4216107, 4218725, 4218820, 4218829, 4219088, 4219373, 4219426, 4219559, 4220671, 4221322, 4222801, 4226230, 4226657, 4242633, 4249504, 4250715, 4252010, 4256531, 4257106, 4258611, 4258955, 4260587, 4260824, 4264751, 4264864, 4267188, 4271521, 4276822, 4280692, 4280696, 4280967, 4281016, 4281041, 4281090, 4281130, 4281144, 4281260, 4281467, 4283449, 4283531, 4283587, 4283590, 4283665, 4283814, 4283936, 4284392, 4284615, 4284757, 4284758, 4285064, 4285118, 4285277, 4285347, 4285357, 4285410, 4285553, 4285596, 4285620, 4285630, 4285649, 4285654, 4285742, 4286222, 4290643, 4291017, 4295351, 4295731, 4296125, 4296310, 4296779, 4298683, 4300514, 4301208, 4321685, 4323543, 4335135, 4337604, 4345120, 4348479, 4348487, 4348488, 4348490, 4348501, 4348518, 4348523, 4348536, 4348538, 4348579, 4348582, 4348602, 4348603, 4348604, 4348610, 4348611, 4348621, 4348647, 4348656, 4348688, 4348697, 4348700, 4348702, 4348718, 4349183, 4349221, 4349315, 4354676, 4368435, 4370877, 4378783, 4378881, 4383758, 4383771, 4383932, 4396521, 4397079, 4397282, 4411688, 4413521, 4413536, 4417894, 4418240, 4421529, 4425670, 4425722, 4430473, 4432942, 4432962, 4434191, 4434304, 4510774, 4510796, 4523804, 4526840, 4526937, 4526955, 4526962, 4527043, 4527319, 4527340, 4527364, 4527796, 4528612, 4528615, 4528616, 4528618, 4528624, 4528628, 4528630, 4528637, 4528644, 4528645, 4528650, 4528652, 4528658, 4528661, 4528674, 4528702, 4528715, 4528719, 4528724, 4528746, 4528747, 4528755, 4528760, 4528785, 4528803, 4528809, 4528825, 4528832, 4528833, 4528849, 4528852, 4528854, 4528862, 4528871, 4528914, 4528934, 4528962, 4528967, 4528970, 4528982, 4528998, 4529003, 4529006, 4529013, 4529029, 4529038, 4529052, 4529054, 4529061, 4529068, 4529070, 4529101, 4529125, 4529128, 4529155, 4529162, 4529172, 4529177, 4529179, 4529183, 4529204, 4529225, 4529228, 4529241, 4529242, 4529251, 4529268, 4529279, 4529298, 4529304, 4529306, 4529307, 4529323, 4529327, 4529333, 4529338, 4529347, 4529351, 4529353, 4529358, 4529366, 4529382, 4529388, 4529393, 4529405, 4529407, 4529409, 4529431, 4529442, 4529445, 4529446, 4529450, 4529457, 4529460, 4529461, 4529463, 4529494, 4529495, 4529521, 4529522, 4529534, 4529535, 4529536, 4529539, 4529551, 4529586, 4529590, 4529607, 4529608, 4529618, 4529626, 4529629, 4529630, 4529634, 4529639, 4529647, 4529654, 4529660, 4529664, 4529669, 4529672, 4529674, 4529688, 4529694, 4529704, 4529707, 4529710, 4529711, 4529721, 4529723, 4529735, 4529737, 4529746, 4529747, 4529752, 4529758, 4529781, 4529792, 4529793, 4529802, 4529812, 4529815, 4529825, 4529836, 4529841, 4529847, 4529848, 4529855, 4529865, 4529877, 4529899, 4529903, 4529905, 4529912, 4529930, 4529950, 4529954, 4529955, 4529961, 4529975, 4529980, 4529991, 4530000, 4530007, 4530015, 4530028, 4530030, 4530061, 4530062, 4530097, 4530099, 4530129, 4530135, 4530143, 4530145, 4530152, 4530153, 4530164, 4530169, 4530178, 4530191, 4530199, 4530206, 4530224, 4530225, 4530227, 4530236, 4530237, 4530241, 4530246, 4530247, 4530253, 4530267, 4530275, 4530290, 4530296, 4530304, 4530305, 4530307, 4530308, 4530318, 4530321, 4530322, 4530334, 4530336, 4530342, 4530373, 4530376, 4530451, 4530472, 4530477, 4530480, 4530486, 4530493, 4530498, 4530532, 4530542, 4530543, 4530548, 4530552, 4530562, 4530574, 4530579, 4530586, 4530613, 4530621, 4530638, 4530664, 4530665, 4530666, 4530676, 4530681, 4530686, 4530688, 4530690, 4530693, 4530694, 4530698, 4530714, 4530716, 4530725, 4530726, 4530739, 4530746, 4530786, 4530792, 4530797, 4530799, 4530810, 4530821, 4530823, 4530841, 4530842, 4530851, 4530853, 4530857, 4530860, 4530906, 4530923, 4530937, 4530949, 4530968, 4530969, 4530978, 4530995, 4531002, 4531029, 4531033, 4531034, 4531042, 4531052, 4531063, 4531098, 4531104, 4531123, 4531126, 4531135, 4531172, 4531200, 4531201, 4531210, 4531215, 4531248, 4531270, 4531275, 4531279, 4531280, 4531281, 4531304, 4531324, 4531334, 4531354, 4531360, 4531361, 4531363, 4531378, 4531381, 4531392, 4531444, 4531450, 4531457, 4531459, 4531467, 4531482, 4531490, 4531492, 4531500, 4531507, 4531521, 4531522, 4531523, 4531535, 4531536, 4531539, 4531550, 4531559, 4531567, 4531573, 4531575, 4531577, 4531597, 4531599, 4531604, 4531611, 4531634, 4531635, 4531649, 4531655, 4531680, 4531685, 4531691, 4531694, 4531710, 4531714, 4531734, 4531737, 4531755, 4531790, 4531791, 4531796, 4531819, 4531828, 4531832, 4531834, 4531918, 4531941, 4531946, 4531955, 4531971, 4531977, 4531985, 4531988, 4532004, 4532035, 4532064, 4532066, 4532069, 4532082, 4532091, 4532099, 4532120, 4532123, 4532139, 4532189, 4532310, 4532370, 4532399, 4532446, 4532482, 4532514, 4532516, 4532545, 4532796, 4532849, 4532893, 4532979, 4532989, 4533070, 4533129, 4533228, 4533464, 4533553, 4533606, 4533628, 4533635, 4533657, 4533683, 4533747, 4533850, 4533885, 4533971, 4534018, 4534055, 4534087, 4534143, 4534245, 4534298, 4534314, 4534428, 4534476, 4534600, 4544188, 4544831, 4546520, 4546611, 4548327, 4548656, 4549072, 4550245, 4550273, 4550600, 4550898, 4555464, 4555835, 4561488, 4561940, 4568411, 4578443, 4578979, 4578981, 4578992, 4579009, 4579083, 4586699, 4590575, 4592491, 4599618, 4603949, 4605642, 4605731, 4606212, 4606336, 4606420, 4606733, 4620389, 4620554, 4620675, 4620718, 4620976, 4621130, 4625767, 4625776, 4625778, 4625823, 4625826, 4625845, 4625886, 4625897, 4625928, 4625936, 4625937, 4625975, 4625977, 4625998, 4626014, 4626027, 4626033, 4626046, 4626063, 4626079, 4626083, 4626107, 4626131, 4626140, 4626156, 4626190, 4626193, 4626204, 4626210, 4626223, 4626225, 4626240, 4626249, 4626255, 4626296, 4626352, 4626399, 4626402, 4626438, 4626460, 4626515, 4626522, 4626531, 4626547, 4626560, 4626685, 4626692, 4626702, 4626983, 4626993, 4627529, 4643067, 4645789, 4652051, 4652368, 4653478, 4655099, 4655208, 4656107, 4667456, 4667878, 4668196, 4671686, 4674001, 4676193, 4676350, 4676594, 4676602, 4676611, 4677153, 4677290, 4677416, 4677449, 4677454, 4677459, 4677534, 4677613, 4687310, 4695293, 4700758, 4700803, 4700984, 4701305, 4701939, 4702516, 4703209, 4710469, 4718271, 4771693, 4771791, 4780986, 4786896, 4803090, 4806350, 4820913, 4822504, 4826794, 4826939, 4841311, 4841433, 4841561, 4841566, 4841575, 4842082, 4844751, 4845734, 4846875, 4846877, 4846882, 4846885, 4846886, 4846888, 4846892, 4846893, 4846894, 4846898, 4846899, 4846908, 4846911, 4846919, 4846921, 4846923, 4846924, 4846926, 4846932, 4846936, 4846941, 4846943, 4846947, 4846951, 4846960, 4846965, 4846966, 4846968, 4846969, 4846971, 4846972, 4846973, 4846974, 4846977, 4846978, 4846980, 4846987, 4846990, 4846992, 4846993, 4846996, 4846998, 4847002, 4847009, 4847012, 4847022, 4847029, 4847030, 4847032, 4847038, 4847040, 4847042, 4847047, 4847054, 4847056, 4847065, 4847068, 4847073, 4847084, 4847086, 4847088, 4847089, 4847113, 4847120, 4857688, 4861876, 4877380, 4880663, 4885125, 4885223, 4886526, 4886548, 4886843, 4887246, 4893608, 4896791, 4900828, 4903750, 4906762, 4907052, 4908179, 4918540, 4923514, 4924172, 4969037, 4970020, 4970378, 4970479, 4970892, 4971781, 4993510, 4993511, 4996242, 5001931, 5002167, 5002295, 5002314, 5002624, 5003248, 5003820, 5003872, 5003914, 5003980, 5004145, 5004464, 5004531, 5004554, 5005203, 5005410, 5005896, 5006089, 5007272, 5007595, 5008308, 5009221, 5009227, 5009272, 5009355, 5009418, 5009751, 5011290, 5011771, 5011990, 5030310, 5032531, 5034418, 5034449, 5034534, 5034625, 5034644, 5039645, 5052635, 5052645, 5052648, 5052679, 5052699, 5052744, 5052858, 5052869, 5052889, 5052893, 5053002, 5064095, 5069061, 5076947, 5089787, 5093473, 5096077, 5096207, 5096228, 5096269, 5096319, 5096502, 5096559, 5100118, 5101961, 5102958, 5104497, 5112574, 5116285, 5116540, 5116582, 5116719, 5116771, 5116792, 5138340, 5138347, 5138349, 5138356, 5138362, 5138363, 5138370, 5138372, 5138378, 5138391, 5138400, 5138402, 5138405, 5138412, 5138416, 5138442, 5138444, 5138449, 5138455, 5138456, 5138457, 5138473, 5138494, 5138510, 5138511, 5138515, 5138524, 5138525, 5138540, 5138547, 5138553, 5138557, 5138567, 5138571, 5138582, 5138586, 5138600, 5138606, 5138608, 5138620, 5138621, 5138628, 5138636, 5138641, 5138649, 5138652, 5138665, 5138671, 5138679, 5138681, 5138682, 5138691, 5138696, 5138702, 5138708, 5138713, 5138716, 5138722, 5138729, 5138746, 5138750, 5138755, 5138765, 5138788, 5138795, 5138799, 5138804, 5138816, 5152790, 5152862, 5153404, 5153405, 5153895, 5153896, 5163254, 5163394, 5163449, 5163644, 5164270, 5168324, 5168344, 5170085, 5170097, 5170170, 5170174, 5170178, 5170201, 5170313, 5170322, 5170338, 5170350, 5170376, 5170444, 5170461, 5170496, 5170533, 5170582, 5170671, 5170750, 5170794, 5170881, 5170915, 5170942, 5170988, 5171048, 5171055, 5171218, 5171246, 5171249, 5171264, 5171387, 5171501, 5171527, 5171545, 5171549, 5171563, 5171587, 5171645, 5171699, 5171718, 5171728, 5171771, 5171773, 5172043, 5172075, 5172089, 5172132, 5172146, 5172210, 5172297, 5172371, 5172400, 5172415, 5172418, 5172510, 5172518, 5172536, 5172558, 5172643, 5172652, 5172680, 5172715, 5172828, 5172832, 5172869, 5172879, 5172880, 5172893, 5172969, 5173014, 5173035, 5173045, 5173052, 5173087, 5173102, 5173120, 5173232, 5173240, 5173283, 5173395, 5173398, 5173505, 5173540, 5173543, 5173564, 5173565, 5173574, 5173583, 5173588, 5173603, 5173865, 5175308, 5175524, 5175553, 5175557, 5175601, 5175657, 5175688, 5175727, 5175759, 5175763, 5175771, 5175793, 5175854, 5175948, 5175974, 5176014, 5176050, 5179810, 5180319, 5182165, 5191066, 5195326, 5196826, 5197854, 5197954, 5204930, 5205275, 5226741, 5232960, 5235228, 5239114, 5246419, 5250983, 5255118).map(x => Id[NormalizedURI](x.toLong))
    val enum: Enumerator[String] = Concurrent.unicast(onStart = (channel: Concurrent.Channel[String]) =>
      SafeFuture("Uri Adultification") {
        data.foreach { id =>
          db.readWrite { implicit session =>
            uriRepo.updateURIRestriction(id, Some(Restriction.ADULT))
          }
          channel.push(id.id.toString + ",")
          Thread.sleep(100)
        }
        channel.eofAndEnd()
      }
    )
    Ok.chunked(enum)
  }

}

