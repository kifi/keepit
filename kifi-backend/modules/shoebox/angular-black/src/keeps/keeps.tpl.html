<div class="kf-main-keeps">
  <div class="kf-keep-selection-tools" ng-if="editMode.enabled">
    <div class="kf-keep-checkbox-icon sprite" ng-class="{ 'sprite-checkbox-icon': isUnchecked(), 'sprite-checkbox-icon-partial': isMultiChecked(), 'sprite-checkbox-icon-active': isSelectedAll() }" ng-click="toggleSelectAll()"></div>
    <div class="kf-keep-selection-tools-body">
      <div class="kf-keep-selected-count">
        <span class="kf-keep-selected-count-number">{{getSelected().length}}</span>
        <span class="kf-keep-selected-count-text" ng-pluralize count="getSelected().length" when="{'1': 'keep selected', 'other': 'keeps selected'}"></span>
      </div>
      <div class="kf-keep-selection-options" ng-class='{disabled: editingTags}' ng-if="getSelected().length">
        <div class="kf-keep-selection-option"><span ng-click="togglePrivate()">Make {{selectionPrivacyState()}}</span></div>
        <div class="kf-keep-selection-option"><span ng-click="unkeep()">Unkeep</span></div>
        <div class="kf-keep-selection-option" ng-click="enableEditTags()"><span>Edit Tags</span></div>
        <div class="kf-keep-selection-options-mask"></div>
      </div>
      <div class="kf-keep-selection-tags" ng-if="editingTags">
        <div class="kf-keep-selection-tags-done" ng-click="disableEditTags()">Done tagging</div>
        <div kf-tag-list class="kf-keep-selection-tags-list" adding-tag="addingTag" get-selected-keeps="getSelected()"></div>
      </div>
    </div>
  </div>
  <ol class="kf-my-keeps" smart-scroll scroll-distance="scrollDistance" scroll-disabled="isScrollDisabled()" scroll-next="scrollNext()">
    <div ng-repeat="keep in keeps track by keep.id" kf-keep is-selected="!!isSelected(keep)"
      keep="keep" me="me" toggle-select="toggleSelect(keep)" click-action="keepClickAction(event, keep)" drag-keeps="dragKeeps(keep, event, mouseX, mouseY)" stop-dragging-keeps="stopDraggingKeeps()" edit-mode="editMode"></div>
    <div class="kf-shadow-dragged-keeps" ng-class="{ two: draggedTwo(), three: draggedThree(), more: draggedMore() }">
      <span class="kf-shadow-keep-first" ng-show="data.draggedKeeps.length >= 1">
        <div kf-keep is-selected="!!isSelected(data.draggedKeeps[0])" keep="data.draggedKeeps[0]" me="me" edit-mode="editMode"></div>
      </span>
      <span class="kf-shadow-keep-second" ng-show="data.draggedKeeps.length === 3">
        <div kf-keep is-selected="!!isSelected(data.draggedKeeps[1])" keep="data.draggedKeeps[1]" me="me" edit-mode="editMode"></div>
      </span>
      <span class="kf-shadow-keep-ellipsis" ng-class="{'active': data.draggedKeeps.length >= 4}">
        <div class="kf-shadow-keep-ellipsis-line"></div>
        <div class="kf-shadow-keep-ellipsis-counter">{{data.draggedKeeps.length - 2}} other keeps selected</div>
      </span>
      <div class="kf-shadow-keep-ellipsis-counter-hidden">{{data.draggedKeeps.length - 2}} other keeps selected</div>
      <span class="kf-shadow-keep-last" ng-show="data.draggedKeeps.length >= 2">
        <div kf-keep is-selected="!!isSelected(data.draggedKeeps[data.draggedKeeps.length-1])" keep="data.draggedKeeps[data.draggedKeeps.length-1]" me="me" edit-mode="editMode"></div>
      </span>
    </div>
  </ol>
  <div class="kf-keep-group-title-fixed"></div>
  <img class="kf-keeps-loading" ng-show="keepsLoading" src="/img/load.gif">
  <a class="kf-keeps-load-more" ng-show="isShowMore()" href="javascript:" ng-click="scrollNext()">Show more</a>
  <div class="kf-keep-description-sizer kf-keep-description"></div>
</div>
