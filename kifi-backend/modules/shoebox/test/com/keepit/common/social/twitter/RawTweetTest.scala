package com.keepit.common.social.twitter

import com.keepit.model.TwitterId
import org.specs2.mutable.Specification
import play.api.libs.json.Json

class RawTweetTest extends Specification {

  val rawString = """{ "created_at": "Fri Apr 10 06:07:56 +0000 2015", "id": 586410263194157000, "id_str": "586410263194157056", "text": "Kifi Debuts A “Deep” Search Engine For Twitter Based On Your Own Tweets http://t.co/w10ifpAujX via @techcrunch", "source": "<a href=\"http://twitter.com\" rel=\"nofollow\">Twitter Web Client</a>", "truncated": false, "in_reply_to_status_id": null, "in_reply_to_status_id_str": null, "in_reply_to_user_id": null, "in_reply_to_user_id_str": null, "in_reply_to_screen_name": null, "user": { "id": 6795782, "id_str": "6795782", "name": "John Wang (王鉴)", "screen_name": "javasoze", "location": "Mountain View, CA", "profile_location": null, "description": "Search Engineer at Twitter.\r\nAvid open source contributor.\r\nComputer geek living and working in the Silicon Valley, the greatest place to be!", "url": "http://t.co/rgqaX0HLkN", "entities": { "url": { "urls": [ { "url": "http://t.co/rgqaX0HLkN", "expanded_url": "http://www.linkedin.com/in/javasoze", "display_url": "linkedin.com/in/javasoze", "indices": [ 0, 22 ] } ] }, "description": { "urls": [] } }, "protected": false, "followers_count": 2256, "friends_count": 341, "listed_count": 48, "created_at": "Wed Jun 13 19:32:17 +0000 2007", "favourites_count": 115, "utc_offset": -25200, "time_zone": "Pacific Time (US & Canada)", "geo_enabled": true, "verified": false, "statuses_count": 1929, "lang": "en", "contributors_enabled": false, "is_translator": false, "is_translation_enabled": false, "profile_background_color": "9AE4E8", "profile_background_image_url": "http://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_image_url_https": "https://abs.twimg.com/images/themes/theme1/bg.png", "profile_background_tile": false, "profile_image_url": "http://pbs.twimg.com/profile_images/1210294985/Photo_on_2011-01-07_at_23.32__2_normal.jpg", "profile_image_url_https": "https://pbs.twimg.com/profile_images/1210294985/Photo_on_2011-01-07_at_23.32__2_normal.jpg", "profile_banner_url": "https://pbs.twimg.com/profile_banners/6795782/1402341991", "profile_link_color": "00BBFF", "profile_sidebar_border_color": "87BC44", "profile_sidebar_fill_color": "E0FF92", "profile_text_color": "000000", "profile_use_background_image": true, "default_profile": false, "default_profile_image": false, "following": false, "follow_request_sent": false, "notifications": false }, "geo": null, "coordinates": null, "place": null, "contributors": null, "retweet_count": 2, "favorite_count": 6, "entities": { "hashtags": [], "symbols": [], "user_mentions": [ { "screen_name": "TechCrunch", "name": "TechCrunch", "id": 816653, "id_str": "816653", "indices": [ 99, 110 ] } ], "urls": [ { "url": "http://t.co/w10ifpAujX", "expanded_url": "http://tcrn.ch/1IDEiGA", "display_url": "tcrn.ch/1IDEiGA", "indices": [ 72, 94 ] } ] }, "favorited": false, "retweeted": false, "possibly_sensitive": false, "lang": "en" }"""

  val rawString2 = """{"created_at":"Fri Jul 26 17:25:54 +0000 2013","id":360813238411214850,"id_str":"360813238411214850","text":"RT @gkossakowski: After working for a month with #scala cake pattern in #scalac I came to conclusion that cake is an anti-pattern. Don't us…","source":"<a href=\"http://twitter.com\" rel=\"nofollow\">Twitter Web Client</a>","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":610392096,"id_str":"610392096","name":"Andrew Conner","screen_name":"connerdelights","location":"Mountain View, CA","profile_location":null,"description":"Software Engineer at @kifi_eng, building @Kifi. Loves Scala, Play Framework, AngularJS, and rock climbing","url":"https://t.co/MJkaz9VdtM","entities":{"url":{"urls":[{"url":"https://t.co/MJkaz9VdtM","expanded_url":"https://www.kifi.com/andrew","display_url":"kifi.com/andrew","indices":[0,23]}]},"description":{"urls":[]}},"protected":false,"followers_count":630,"friends_count":308,"listed_count":15,"created_at":"Sat Jun 16 22:07:52 +0000 2012","favourites_count":380,"utc_offset":-25200,"time_zone":"Pacific Time (US & Canada)","geo_enabled":false,"verified":false,"statuses_count":566,"lang":"en","contributors_enabled":false,"is_translator":false,"is_translation_enabled":false,"profile_background_color":"EDECE9","profile_background_image_url":"http://abs.twimg.com/images/themes/theme3/bg.gif","profile_background_image_url_https":"https://abs.twimg.com/images/themes/theme3/bg.gif","profile_background_tile":false,"profile_image_url":"http://pbs.twimg.com/profile_images/496729766779580416/ePxivSZA_normal.png","profile_image_url_https":"https://pbs.twimg.com/profile_images/496729766779580416/ePxivSZA_normal.png","profile_banner_url":"https://pbs.twimg.com/profile_banners/610392096/1375460032","profile_link_color":"088253","profile_sidebar_border_color":"D3D2CF","profile_sidebar_fill_color":"E3E2DE","profile_text_color":"634047","profile_use_background_image":true,"default_profile":false,"default_profile_image":false,"following":false,"follow_request_sent":false,"notifications":false},"geo":null,"coordinates":null,"place":null,"contributors":null,"retweeted_status":{"created_at":"Fri Jul 26 17:16:10 +0000 2013","id":360810787738107905,"id_str":"360810787738107905","text":"After working for a month with #scala cake pattern in #scalac I came to conclusion that cake is an anti-pattern. Don't use it.","source":"<a href=\"http://itunes.apple.com/us/app/twitter/id409789998?mt=12\" rel=\"nofollow\">Twitter for Mac</a>","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":26209148,"id_str":"26209148","name":"Grzegorz Kossakowski","screen_name":"gkossakowski","location":"Warsaw","profile_location":null,"description":"Programmer, thinker, doer, food and coffee enthusiast. Hacking #scala @typesafe.","url":"http://t.co/7rkWRKsnXy","entities":{"url":{"urls":[{"url":"http://t.co/7rkWRKsnXy","expanded_url":"http://github.com/gkossakowski","display_url":"github.com/gkossakowski","indices":[0,22]}]},"description":{"urls":[]}},"protected":false,"followers_count":1557,"friends_count":273,"listed_count":74,"created_at":"Tue Mar 24 10:03:50 +0000 2009","favourites_count":134,"utc_offset":7200,"time_zone":"Warsaw","geo_enabled":true,"verified":false,"statuses_count":1705,"lang":"en","contributors_enabled":false,"is_translator":false,"is_translation_enabled":false,"profile_background_color":"C0DEED","profile_background_image_url":"http://abs.twimg.com/images/themes/theme1/bg.png","profile_background_image_url_https":"https://abs.twimg.com/images/themes/theme1/bg.png","profile_background_tile":false,"profile_image_url":"http://pbs.twimg.com/profile_images/443401638812725249/froE9-YT_normal.jpeg","profile_image_url_https":"https://pbs.twimg.com/profile_images/443401638812725249/froE9-YT_normal.jpeg","profile_banner_url":"https://pbs.twimg.com/profile_banners/26209148/1428837184","profile_link_color":"0084B4","profile_sidebar_border_color":"C0DEED","profile_sidebar_fill_color":"DDEEF6","profile_text_color":"333333","profile_use_background_image":true,"default_profile":true,"default_profile_image":false,"following":true,"follow_request_sent":false,"notifications":false},"geo":null,"coordinates":null,"place":null,"contributors":null,"retweet_count":33,"favorite_count":17,"entities":{"hashtags":[{"text":"scala","indices":[31,37]},{"text":"scalac","indices":[54,61]}],"symbols":[],"user_mentions":[],"urls":[]},"favorited":true,"retweeted":true,"lang":"en"},"retweet_count":33,"favorite_count":0,"entities":{"hashtags":[{"text":"scala","indices":[49,55]},{"text":"scalac","indices":[72,79]}],"symbols":[],"user_mentions":[{"screen_name":"gkossakowski","name":"Grzegorz Kossakowski","id":26209148,"id_str":"26209148","indices":[3,16]}],"urls":[]},"favorited":true,"retweeted":true,"lang":"en"}"""

  "abook controller" should {
    "support mobile (ios) upload" in {
      val maybeTweet1 = RawTweet.format.reads(Json.parse(rawString))
      maybeTweet1.get.id === TwitterId(586410263194157000L)

      val maybeTweet2 = RawTweet.format.reads(Json.parse(rawString2))
      maybeTweet2.get.id === TwitterId(360813238411214850L)
    }
  }
}