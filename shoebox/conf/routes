# Routes
# This file defines all application routes (Higher priority routes first)
# ~~~~

# Home page
GET     /                           com.keepit.controllers.HomeController.home
GET     /upgrade                    com.keepit.controllers.HomeController.upgrade

POST    /bookmarks/add              com.keepit.controllers.BookmarksController.addBookmarks
POST    /bookmarks/update           com.keepit.controllers.BookmarksController.updateBookmarks
GET     /bookmarks/all              com.keepit.controllers.BookmarksController.all
GET     /bookmarks/edit             com.keepit.controllers.BookmarksController.edit(id: Id[Bookmark])
POST    /bookmarks/rescrape         com.keepit.controllers.BookmarksController.rescrape
POST    /bookmarks/delete           com.keepit.controllers.BookmarksController.delete(id: Id[Bookmark])
GET     /bookmarks/check            com.keepit.controllers.BookmarksController.checkIfExists(uri: String, ver: Option[String] ?= None)
POST    /bookmarks/remove           com.keepit.controllers.BookmarksController.remove()
POST    /bookmarks/private          com.keepit.controllers.BookmarksController.updatePrivacy()

POST    /comments/add               com.keepit.controllers.CommentController.createComment()
GET     /comments/public            com.keepit.controllers.CommentController.getComments(url: String)
POST    /comments/follow            com.keepit.controllers.CommentController.startFollowing()
POST    /comments/unfollow          com.keepit.controllers.CommentController.stopFollowing()
DELETE  /comments/follow            com.keepit.controllers.CommentController.stopFollowing()
# TODO: remove DELETE route above (Firefox Addon SDK does not support DELETE requests) after all KiFi installations >= 2.1.45

GET     /messages/threads/:id       com.keepit.controllers.CommentController.getMessageThread(id: ExternalId[Comment])
GET     /messages/threads           com.keepit.controllers.CommentController.getMessageThreadList(url: String)
POST    /messages                   com.keepit.controllers.CommentController.createComment()

GET     /r/:id                      com.keepit.controllers.DeepLinkController.handle(id: String)

GET     /users/slider               com.keepit.controllers.UserController.getSliderInfo(url: String)
POST    /users/slider/suppress      com.keepit.controllers.UserController.suppressSliderForSite
GET     /users/slider/updates       com.keepit.controllers.CommentController.getUpdates(url: String)
GET     /users/friends              com.keepit.controllers.UserController.getSocialConnections()
POST    /users/events               com.keepit.controllers.EventController.logUserEvents

GET     /search                     com.keepit.controllers.SearchController.search(q: Option[String] ?= None, term: Option[String] ?= None, maxHits:Int, lastUUID: Option[String], filter: Option[String] ?= None, context: Option[String], kifiVersion: Option[KifiVersion] ?= None)
# TODO: remove term parameter above and require q after all KiFi installations >= 2.1.46

POST    /kifi/start                 com.keepit.controllers.AuthController.start
GET     /welcome                    com.keepit.controllers.AuthController.welcome
GET     /whois                      com.keepit.controllers.AuthController.whois
GET     /session/end                com.keepit.controllers.AuthController.logOut

POST    /chat/:recipientId          com.keepit.controllers.ChatController.chat(recipientId: ExternalId[User])

# Map static resources from the /public folder to the /assets URL path
GET     /assets/*file               controllers.Assets.at(path="/public", file)

##########################################
# Admin
##########################################

GET     /admin                      com.keepit.controllers.admin.AdminDashboardController.index
GET     /admin/graphs/users.json    com.keepit.controllers.admin.AdminDashboardController.usersByDate
GET     /admin/graphs/bookmarks.json    com.keepit.controllers.admin.AdminDashboardController.bookmarksByDate

GET     /admin/events               com.keepit.controllers.admin.AdminEventController.reportList
POST    /admin/events/buildReport   com.keepit.controllers.admin.AdminEventController.buildReport
GET     /admin/events/report        com.keepit.controllers.admin.AdminEventController.getReport(reportName: String)
GET     /admin/realtime             com.keepit.controllers.admin.AdminEventController.realTimeViewer
GET     /admin/realtime/stream      com.keepit.controllers.admin.AdminEventController.eventStream

GET     /admin/bookmarks/page/:page com.keepit.controllers.BookmarksController.bookmarksView(page: Int)

GET     /admin/scrape               com.keepit.controllers.admin.ScraperController.scrape
GET     /admin/scrape/:state        com.keepit.controllers.admin.ScraperController.scrapeByState(state: State[NormalizedURI])
GET     /admin/scraped/:uriId       com.keepit.controllers.admin.ScraperController.getScraped(uriId: Id[NormalizedURI])

GET     /admin/data/integrity       com.keepit.controllers.admin.ScraperController.documentIntegrity(page: Int ?= 0, size: Int ?= 50)
GET     /admin/data/dupe            com.keepit.controllers.admin.ScraperController.duplicateDocumentDetection
GET     /admin/data/orphan          com.keepit.controllers.admin.ScraperController.orphanCleanup
GET     /admin/data/unscrapable     com.keepit.controllers.admin.ScraperController.getUnscrapable()
POST    /admin/data/previewUnscrapable     com.keepit.controllers.admin.ScraperController.previewUnscrapable()
POST    /admin/data/unscrapable     com.keepit.controllers.admin.ScraperController.createUnscrapable()
GET     /admin/data/renormalize     com.keepit.controllers.admin.UrlController.renormalize(readOnly: Boolean ?= true, domain: Option[String] ?= None)
POST    /admin/data/handleDuplicate com.keepit.controllers.admin.ScraperController.handleDuplicate
POST    /admin/data/handleDuplicates com.keepit.controllers.admin.ScraperController.handleDuplicates

GET     /admin/article/index        com.keepit.controllers.admin.ArticleIndexerController.index
GET     /admin/article/index/:state com.keepit.controllers.admin.ArticleIndexerController.indexByState(state: State[NormalizedURI])
GET     /admin/article/indexInfo    com.keepit.controllers.admin.ArticleIndexerController.indexInfo
GET     /admin/article/refreshSearcher com.keepit.controllers.admin.ArticleIndexerController.refreshSearcher
GET     /admin/article/dumpDoc/:uriId  com.keepit.controllers.admin.ArticleIndexerController.dumpLuceneDocument(uriId: Id[NormalizedURI])

GET     /admin/uriGraph/load        com.keepit.controllers.admin.URIGraphController.load
GET     /admin/uriGraph/update/:userId com.keepit.controllers.admin.URIGraphController.update(userId: Id[User])
GET     /admin/uriGraph/dumpDoc/:userId  com.keepit.controllers.admin.URIGraphController.dumpLuceneDocument(userId: Id[User])

GET     /admin/users                com.keepit.controllers.UserController.usersView
GET     /admin/user/:id             com.keepit.controllers.UserController.userView(id: Id[User])
POST    /admin/user/:id             com.keepit.controllers.UserController.userView(id: Id[User])
GET     /admin/user/:id/more-info   com.keepit.controllers.UserController.moreUserInfoView(id: Id[User])
POST    /admin/user/:id/experiment/add/:exp  com.keepit.controllers.UserController.addExperiment(id: Id[User], exp: String)
POST    /admin/user/:id/update      com.keepit.controllers.UserController.updateUser(id: Id[User])
GET     /admin/user/:id/social_users/refresh com.keepit.controllers.UserController.refreshAllSocialInfo(id: Id[User])
POST    /admin/user/:id/impersonate com.keepit.controllers.AuthController.impersonate(id: Id[User])
POST    /admin/unimpersonate        com.keepit.controllers.AuthController.unimpersonate()

GET     /admin/social_users/:page   com.keepit.controllers.SocialUserController.socialUsersView(page: Int)
GET     /admin/social_user/:id      com.keepit.controllers.SocialUserController.socialUserView(id: Id[SocialUserInfo])
GET     /admin/social_user/:id/refresh com.keepit.controllers.SocialUserController.refreshSocialInfo(id: Id[SocialUserInfo])
GET     /admin/social_user/:id/reset com.keepit.controllers.SocialUserController.resetSocialUser(id: Id[SocialUserInfo])

GET     /admin/server               com.keepit.common.healthcheck.HealthController.serviceView()
GET     /admin/search/results/:id   com.keepit.controllers.SearchController.articleSearchResult(id: ExternalId[ArticleSearchResultRef])

GET     /admin/emails/comment       com.keepit.controllers.admin.AdminEmailPreviewController.newComment
GET     /admin/emails/message       com.keepit.controllers.admin.AdminEmailPreviewController.newMessage
GET     /admin/emails/message-reply com.keepit.controllers.admin.AdminEmailPreviewController.newMessageReply

GET     /admin/electronicMails       com.keepit.controllers.admin.ElectronicMailController.electronicMailsViewFirstPage
GET     /admin/electronicMails/:page com.keepit.controllers.admin.ElectronicMailController.electronicMailsView(page: Int)

GET     /admin/follows              com.keepit.controllers.CommentController.followsView
GET     /admin/comments             com.keepit.controllers.CommentController.commentsViewFirstPage
GET     /admin/comments/:page       com.keepit.controllers.CommentController.commentsView(page: Int)
GET     /admin/messages             com.keepit.controllers.CommentController.messagesViewFirstPage
GET     /admin/messages/:page       com.keepit.controllers.CommentController.messagesView(page: Int)

GET     /admin/searchConfig/:id     com.keepit.controllers.SearchConfigController.showUserConfig(id: Id[User])
POST    /admin/searchConfig/:id/set   com.keepit.controllers.SearchConfigController.setUserConfig(id: Id[User])
GET     /admin/searchConfig/:id/reset com.keepit.controllers.SearchConfigController.resetUserConfig(id: Id[User])
GET     /admin/searchExperiments    com.keepit.controllers.SearchConfigController.getExperiments
POST    /admin/searchExperiments    com.keepit.controllers.SearchConfigController.addNewExperiment
POST    /admin/searchExperiments/delete    com.keepit.controllers.SearchConfigController.deleteExperiment
POST    /admin/searchExperiments/update    com.keepit.controllers.SearchConfigController.updateExperiment

GET     /admin/explainResult        com.keepit.controllers.SearchController.explain(query: String, uriId: Id[NormalizedURI])

GET     /admin/slider/rules         com.keepit.controllers.admin.SliderAdminController.getRules
POST    /admin/slider/rules         com.keepit.controllers.admin.SliderAdminController.saveRules
GET     /admin/slider/patterns      com.keepit.controllers.admin.SliderAdminController.getPatterns
POST    /admin/slider/patterns      com.keepit.controllers.admin.SliderAdminController.savePatterns
GET     /admin/slider/domainTags    com.keepit.controllers.admin.SliderAdminController.getDomainTags
POST    /admin/slider/domainTags    com.keepit.controllers.admin.SliderAdminController.saveDomainTags
GET     /admin/slider/domains       com.keepit.controllers.admin.SliderAdminController.getDomainOverrides
POST    /admin/slider/domains       com.keepit.controllers.admin.SliderAdminController.saveDomainOverrides
POST    /admin/slider/domains/fetch com.keepit.controllers.admin.SliderAdminController.refetchClassifications
GET     /admin/slider/importEvents  com.keepit.controllers.admin.SliderAdminController.getImportEvents

GET     /admin/healthcheck/ping     com.keepit.common.healthcheck.HealthController.ping()
GET     /admin/healthcheck/error    com.keepit.common.healthcheck.HealthController.causeError()
GET     /admin/healthcheck/errors   com.keepit.common.healthcheck.HealthController.getErrors()
GET     /admin/healthcheck/isHealthy    com.keepit.common.healthcheck.HealthController.isHealthy()
GET     /admin/healthcheck/resetErrorCount    com.keepit.common.healthcheck.HealthController.resetErrorCount()

POST    /admin/logging/emails       com.keepit.controllers.admin.ElectronicMailLoggingController.doLog()

GET     /admin/url/renormalize      com.keepit.controllers.admin.UrlController.renormalize(readOnly: Boolean ?= true, domain: Option[String] ?= None)

GET     /admin/labs/rankVsScore     com.keepit.controllers.SearchLabsController.rankVsScore(q: Option[String] ?= None)
GET     /admin/labs/rankVsScore.json com.keepit.controllers.SearchLabsController.rankVsScoreJson(q: Option[String] ?= None)
GET     /admin/labs/friendMap       com.keepit.controllers.SearchLabsController.friendMap(q: Option[String] ?= None)
GET     /admin/labs/friendMap.json  com.keepit.controllers.SearchLabsController.friendMapJson(q: Option[String] ?= None)

##########################################
# Secure social routes
##########################################

# Login page
GET     /login                      securesocial.controllers.LoginPage.login
GET     /logout                     securesocial.controllers.LoginPage.logout

# User Registration
GET     /signup                     securesocial.controllers.Registration.signUp
POST    /signup                     securesocial.controllers.Registration.handleSignUp

# Providers entry points
GET     /authenticate/:provider     securesocial.controllers.LoginPage.authenticate(provider)
POST    /authenticate/:provider     securesocial.controllers.LoginPage.authenticateByPost(provider)

